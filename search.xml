<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Vue学习笔记4-项目开发规范及插件</title>
      <link href="/2023/08/18/6f8a2d7c06a5/"/>
      <url>/2023/08/18/6f8a2d7c06a5/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue-学习笔记-4-项目开发规范及插件"><a href="#Vue-学习笔记-4-项目开发规范及插件" class="headerlink" title="Vue 学习笔记 4-项目开发规范及插件"></a>Vue 学习笔记 4-项目开发规范及插件</h1><h2 id="一、安装插件"><a href="#一、安装插件" class="headerlink" title="一、安装插件"></a>一、安装插件</h2><p>开发必备：</p><ul><li>vscode-icons：编辑器图标插件；</li><li>Vue Language Features (Volar)：在功能上 <code>volar</code> 和 <code>vetur</code> 是一致的，都是针对 <code>vue</code> 的插件（可以这样说， <code>volar</code> 是 <code>vue3</code> 的配套，<code>vetur</code> 是 <code>vue2</code> 的配套）；</li><li>DotENV：.env 文件语法高亮；</li><li>ESLint：件化的 javascript 代码检测工具；</li><li>Stylelint：一个强大、先进的 CSS 代码检查器，可以帮助你规避 CSS 代码中的错误并保持一致的编码风格</li><li>Prettier：代码格式化工具；</li><li>EditorConfig for VS Code：项目约束；</li><li>project-tree：生成项目树结构；</li></ul><p>其他推荐：</p><ul><li>Chinese (Simplified)：简体翻译插件；</li><li>any-rule：正则表达式插件；</li><li>会了吧：点击源码文件，会自动分析所有包含的单词，不在 <strong>已掌握单词列表</strong> 中的单词会自动添加到 <strong>陌生单词</strong> 列表；</li><li>GitLens：多人协作开发时，可快速查找 git 提交记录。点击任意一行代码，代码会有个小尾巴，显示本行代码的提交记录。</li><li>Git History：提交记录（Alt + H 查看，安装了 GitLens 可以不用安装）；</li><li>Doxygen Documentation：生成代码文件头和注释；</li></ul><h2 id="二、基本配置"><a href="#二、基本配置" class="headerlink" title="二、基本配置"></a>二、基本配置</h2><h3 id="2-1-Yarn"><a href="#2-1-Yarn" class="headerlink" title="2.1 Yarn"></a>2.1 Yarn</h3><blockquote><p>Yarn 自动清除功能,实现每一次<code>install</code>之后、<code>add</code>之后、<code>yarn autoclean --force</code>之后。从程序包依赖项中清除并删除不必要的文件。</p></blockquote><h4 id="2-1-1-配置"><a href="#2-1-1-配置" class="headerlink" title="2.1.1 配置"></a>2.1.1 配置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn autoclean --init</span><br></pre></td></tr></table></figure><p>执行玩命令之后，Yarn 就会自动在根目录下创建一个<code>.yarnclean</code>文件。这样就可以了。</p><h3 id="2-2-Editor"><a href="#2-2-Editor" class="headerlink" title="2.2 Editor"></a>2.2 Editor</h3><ul><li><a href="https://editorconfig.org/">EditorConfig 官网</a></li><li><a href="https://github.com/editorconfig/editorconfig/wiki/EditorConfig-Properties">EditorConfig 完整配置属性说明表</a></li></ul><p>在项目根路径新建文件 <code>.editorconfig</code></p><blockquote><p>在项目中我们最好是使用统一行尾符（建议不管还是 mac 还是 windows 都使用 lf ），但是按上面的配置，我们发现保存的时候无法将 crlf 行尾符转换成 lf 行尾符，当然我们可以直接点击 vscode 的右下角切换行尾符，但终究是有点麻烦，这时使用 .editorconfig 就很有必要了。</p></blockquote><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 告诉EditorConfig插件，这是根文件，不用继续往上查找。</span></span><br><span class="line"><span class="attr">root</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 匹配全部文件。</span></span><br><span class="line"><span class="section">[*]</span></span><br><span class="line"><span class="comment"># 使用`utf-8`字符集。</span></span><br><span class="line"><span class="attr">charset</span>=utf-<span class="number">8</span></span><br><span class="line"><span class="comment"># 结尾换行符，可选`lf`、`cr`、`crlf`。</span></span><br><span class="line"><span class="attr">end_of_line</span>=lf</span><br><span class="line"><span class="comment"># 在文件结尾插入新行</span></span><br><span class="line"><span class="attr">insert_final_newline</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 缩进的样式为空格。</span></span><br><span class="line"><span class="attr">indent_style</span>=space</span><br><span class="line"><span class="comment"># 缩进为2</span></span><br><span class="line"><span class="attr">indent_size</span>=<span class="number">2</span></span><br><span class="line"><span class="comment"># 行最大长度为100</span></span><br><span class="line"><span class="attr">max_line_length</span> = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 匹配以`.yml`、`.yaml`、`.json`结尾的文件</span></span><br><span class="line"><span class="section">[*.&#123;yml,yaml,json&#125;]</span></span><br><span class="line"><span class="attr">indent_style</span> = space</span><br><span class="line"><span class="attr">indent_size</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 匹配以`.md`结尾的文件</span></span><br><span class="line"><span class="section">[*.md]</span></span><br><span class="line"><span class="comment"># 修剪尾随空格</span></span><br><span class="line"><span class="attr">trim_trailing_whitespace</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Makefile]</span></span><br><span class="line"><span class="attr">indent_style</span> = tab</span><br></pre></td></tr></table></figure><p>在项目根目录看有没有 <code>.vscode</code> 文件夹，若没有，就新建。新建 <code>settings.json</code> 文件：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;editor.codeActionsOnSave&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;source.fixAll.eslint&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>一键安装项目推荐的 vscode 插件，新建 <code>extensions.json</code> 文件：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;recommendations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;vue.volar&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;ms-ceintl.vscode-language-pack-zh-hans&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;mikestead.dotenv&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;donjayamanne.githistory&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;lokalise.i18n-ally&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;dbaeumer.vscode-eslint&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;zhucy.project-tree&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;eamodio.gitlens&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;ms-vscode.powershell&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;vscode-icons-team.vscode-icons&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>团队其他成员拉代码后, 打开 vscode, 依次点击 1,2,3, 会自动输入@recommended, 工作区推荐的插件就是 <code>.vscode/extensions.json</code> 文件推荐的。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202209160000048.png" alt="image-20220818103040910.png"></p><h3 id="2-3-Git"><a href="#2-3-Git" class="headerlink" title="2.3 Git"></a>2.3 Git</h3><p>提交以上文件到 git 代码仓库，在 <code>.gitignore</code> 文件中配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">node_modules</span><br><span class="line">.DS_Store</span><br><span class="line">dist</span><br><span class="line">.cache</span><br><span class="line">.turbo</span><br><span class="line">.local</span><br><span class="line"># local env files</span><br><span class="line">.env.local</span><br><span class="line">.env.*.local</span><br><span class="line">.eslintcache</span><br><span class="line"></span><br><span class="line"># Log files</span><br><span class="line">npm-debug.log*</span><br><span class="line">yarn-debug.log*</span><br><span class="line">yarn-error.log*</span><br><span class="line">pnpm-debug.log*</span><br><span class="line"></span><br><span class="line"># Editor directories and files</span><br><span class="line">.idea</span><br><span class="line"># .vscode</span><br><span class="line">*.suo</span><br><span class="line">*.ntvs*</span><br><span class="line">*.njsproj</span><br><span class="line">*.sln</span><br><span class="line">*.sw?</span><br><span class="line"></span><br><span class="line">package-lock.json</span><br><span class="line">pnpm-lock.yaml</span><br><span class="line"></span><br><span class="line">.history</span><br></pre></td></tr></table></figure><h2 id="三、插件配置"><a href="#三、插件配置" class="headerlink" title="三、插件配置"></a>三、插件配置</h2><h3 id="3-1-TypeScript"><a href="#3-1-TypeScript" class="headerlink" title="3.1 TypeScript"></a>3.1 TypeScript</h3><h4 id="3-1-1-安装"><a href="#3-1-1-安装" class="headerlink" title="3.1.1 安装"></a>3.1.1 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D typescript</span><br></pre></td></tr></table></figure><ul><li>typescript</li></ul><h4 id="3-1-2-配置"><a href="#3-1-2-配置" class="headerlink" title="3.1.2 配置"></a>3.1.2 配置</h4><p>根目录下新建 TypeScript 的配置文件：<code>tsconfig.json</code>文件</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 指定ECMAScript目标版本，esnext为最新版本</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 指定生成哪个模块系统代码，esnext为最新版本</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 决定如何处理模块</span></span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 启用所有严格类型检查选项</span></span><br><span class="line">    <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 禁止对同一个文件的不一致的引用</span></span><br><span class="line">    <span class="attr">&quot;forceConsistentCasingInFileNames&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 允许从没有设置默认导出的模块中默认导入这并不影响代码的输出，仅为了类型检查</span></span><br><span class="line">    <span class="attr">&quot;allowSyntheticDefaultImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 禁用函数参数双向协变检查</span></span><br><span class="line">    <span class="attr">&quot;strictFunctionTypes&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 在 .tsx文件里支持JSX</span></span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;preserve&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 解析非相对模块名的基准目录查看 模块解析文档了解详情</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 允许编译javascript文件</span></span><br><span class="line">    <span class="attr">&quot;allowJs&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 生成相应的 .map文件</span></span><br><span class="line">    <span class="attr">&quot;sourceMap&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;resolveJsonModule&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 若有未使用的局部变量则抛错</span></span><br><span class="line">    <span class="attr">&quot;noUnusedLocals&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 若有未使用的参数则抛错</span></span><br><span class="line">    <span class="attr">&quot;noUnusedParameters&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 启用实验性的ES装饰器</span></span><br><span class="line">    <span class="attr">&quot;experimentalDecorators&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 编译过程中需要引入的库文件的列表</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;dom&quot;</span><span class="punctuation">,</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 要包含的类型声明文件名列表</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;vite/client&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 要包含的类型声明文件路径列表</span></span><br><span class="line">    <span class="attr">&quot;typeRoots&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./node_modules/@types/&quot;</span><span class="punctuation">,</span> <span class="string">&quot;./types&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;incremental&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 在表达式和声明上有隐含的 any类型时报错</span></span><br><span class="line">    <span class="attr">&quot;noImplicitAny&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 忽略所有的声明文件（ *.d.ts）的类型检查</span></span><br><span class="line">    <span class="attr">&quot;skipLibCheck&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 模块名到基于 baseUrl的路径映射的列表查看 模块解析文档了解详情</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;/@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;/#/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;types/*&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 指定一个匹配列表(属于自动指定该路径下的所有ts相关文件)</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;src/**/*.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.d.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.tsx&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;types/**/*.d.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;types/**/*.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;mock/**/*.ts&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 指定一个排除列表(include的反向操作)</span></span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;node_modules&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dist&quot;</span><span class="punctuation">,</span> <span class="string">&quot;**/*.js&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-ESLint"><a href="#3-2-ESLint" class="headerlink" title="3.2 ESLint"></a>3.2 ESLint</h3><blockquote><p><code>ESLint</code>简单的来说就是去判断你的<code>JS</code>代码写的格式对不对的一个依赖。没有它你的代码也能运行，有了它你的代码可以写的更漂亮。<code>ESLint</code>还支持插件，第三方框架会基于<code>ESLint</code>写出自己的代码检查插件。比如<code>Vue3</code>对应<code>eslint-plugin-vue</code>。</p></blockquote><ul><li><a href="https://eslint.org/">ESLint 官网</a></li><li><a href="https://eslint.org/docs/user-guide/getting-started">ESLint-快速入门</a></li><li><a href="https://eslint.org/docs/user-guide/configuring/">ESLint 配置</a></li><li><a href="https://eslint.org/docs/rules/">ESLint 的配置规则</a></li></ul><h4 id="3-2-1-安装"><a href="#3-2-1-安装" class="headerlink" title="3.2.1 安装"></a>3.2.1 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D eslint eslint-define-config eslint-plugin-vue vue-eslint-parser @typescript-eslint/eslint-plugin @typescript-eslint/parser</span><br></pre></td></tr></table></figure><ul><li>eslint：判断代码是否符合规则；</li><li>eslint-define-config：大部分开发者使用的默认规则；</li><li>eslint-plugin-vue：<code>vue</code>官方开发的<code>ESLint</code>插件；</li><li>vue-eslint-parser：允许对.vue 文件的<template>进行检查，和 eslint-plugin-vue 搭配使用；</li><li>@typescript-eslint&#x2F;eslint-plugin：与 eslint-plugin-vue 同理；</li><li>@typescript-eslint&#x2F;parser：与 vue-eslint-parser 同理；</li></ul><h4 id="3-2-2-配置"><a href="#3-2-2-配置" class="headerlink" title="3.2.2 配置"></a>3.2.2 配置</h4><p>在项目根目录新建 ESLint 风格检查配置文件：<code>.eslintrc.cjs</code></p><blockquote><p>这里可以使用<code>eslint</code>的<code>init</code>,eslint –init<code>或者</code>npx eslint –init</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;eslint-define-config&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">root</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">/* 指定如何解析语法。*/</span></span><br><span class="line">  <span class="attr">parser</span>: <span class="string">&quot;vue-eslint-parser&quot;</span>,</span><br><span class="line">  <span class="comment">/* 优先级低于parse的语法解析配置 */</span></span><br><span class="line">  <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">    <span class="attr">parser</span>: <span class="string">&quot;@typescript-eslint/parser&quot;</span>,</span><br><span class="line">    <span class="comment">//模块化方案</span></span><br><span class="line">    <span class="attr">sourceType</span>: <span class="string">&quot;module&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">env</span>: &#123;</span><br><span class="line">    <span class="attr">browser</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">es6</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">node</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 解决 defineProps and defineEmits generate no-undef warnings</span></span><br><span class="line">    <span class="string">&quot;vue/setup-compiler-macros&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// https://eslint.bootcss.com/docs/user-guide/configuring#specifying-globals</span></span><br><span class="line">  <span class="attr">globals</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">extends</span>: [</span><br><span class="line">    <span class="string">&quot;prettier&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint:recommended&quot;</span>,</span><br><span class="line">    <span class="string">&quot;plugin:vue/vue3-recommended&quot;</span>,</span><br><span class="line">    <span class="string">&quot;plugin:@typescript-eslint/recommended&quot;</span>, <span class="comment">// typescript-eslint推荐规则,</span></span><br><span class="line">    <span class="string">&quot;plugin:prettier/recommended&quot;</span>,</span><br><span class="line">    <span class="string">&quot;./.eslintrc-auto-import.json&quot;</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 自定义ESLint检查规则</span></span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="comment">// 禁止使用 var</span></span><br><span class="line">    <span class="string">&quot;no-var&quot;</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    <span class="attr">semi</span>: <span class="string">&quot;off&quot;</span>,</span><br><span class="line">    <span class="comment">// 优先使用 interface 而不是 type</span></span><br><span class="line">    <span class="string">&quot;@typescript-eslint/consistent-type-definitions&quot;</span>: [<span class="string">&quot;error&quot;</span>, <span class="string">&quot;interface&quot;</span>],</span><br><span class="line">    <span class="string">&quot;@typescript-eslint/no-explicit-any&quot;</span>: <span class="string">&quot;off&quot;</span>, <span class="comment">// 可以使用 any 类型</span></span><br><span class="line">    <span class="string">&quot;@typescript-eslint/explicit-module-boundary-types&quot;</span>: <span class="string">&quot;off&quot;</span>,</span><br><span class="line">    <span class="comment">// 解决使用 require() Require statement not part of import statement. 的问题</span></span><br><span class="line">    <span class="string">&quot;@typescript-eslint/no-var-requires&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="comment">// https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/ban-types.md</span></span><br><span class="line">    <span class="string">&quot;@typescript-eslint/ban-types&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;error&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">types</span>: &#123;</span><br><span class="line">          <span class="comment">// add a custom message to help explain why not to use it</span></span><br><span class="line">          <span class="title class_">Foo</span>: <span class="string">&quot;Don&#x27;t use Foo because it is unsafe&quot;</span>,</span><br><span class="line"></span><br><span class="line">          <span class="comment">// add a custom message, AND tell the plugin how to fix it</span></span><br><span class="line">          <span class="title class_">String</span>: &#123;</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;Use string instead&quot;</span>,</span><br><span class="line">            <span class="attr">fixWith</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line"></span><br><span class="line">          <span class="string">&quot;&#123;&#125;&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;Use object instead&quot;</span>,</span><br><span class="line">            <span class="attr">fixWith</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 禁止出现未使用的变量</span></span><br><span class="line">    <span class="string">&quot;@typescript-eslint/no-unused-vars&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;error&quot;</span>,</span><br><span class="line">      &#123; <span class="attr">vars</span>: <span class="string">&quot;all&quot;</span>, <span class="attr">args</span>: <span class="string">&quot;after-used&quot;</span>, <span class="attr">ignoreRestSiblings</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;prettier/prettier&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;error&quot;</span>,</span><br><span class="line">      &#123; <span class="attr">singleQuote</span>: <span class="literal">true</span>, <span class="attr">parser</span>: <span class="string">&quot;flow&quot;</span>, <span class="attr">semi</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;vue/html-indent&quot;</span>: <span class="string">&quot;off&quot;</span>,</span><br><span class="line">    <span class="comment">// 关闭此规则 使用 prettier 的格式化规则，</span></span><br><span class="line">    <span class="string">&quot;vue/max-attributes-per-line&quot;</span>: [<span class="string">&quot;off&quot;</span>],</span><br><span class="line">    <span class="comment">// 优先使用驼峰，element 组件除外</span></span><br><span class="line">    <span class="string">&quot;vue/component-name-in-template-casing&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;error&quot;</span>,</span><br><span class="line">      <span class="string">&quot;PascalCase&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">ignores</span>: [<span class="string">&quot;/^el-/&quot;</span>, <span class="string">&quot;/^router-/&quot;</span>],</span><br><span class="line">        <span class="attr">registeredComponentsOnly</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 强制使用驼峰</span></span><br><span class="line">    <span class="attr">camelcase</span>: [<span class="string">&quot;error&quot;</span>, &#123; <span class="attr">properties</span>: <span class="string">&quot;always&quot;</span> &#125;],</span><br><span class="line">    <span class="comment">// 优先使用 const</span></span><br><span class="line">    <span class="string">&quot;prefer-const&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;error&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">destructuring</span>: <span class="string">&quot;any&quot;</span>,</span><br><span class="line">        <span class="attr">ignoreReadBeforeAssign</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>在项目根目录新建 ESLint 的代码检测忽略的文件的配置文件：<code>.eslintignore</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">*.sh</span><br><span class="line">node_modules</span><br><span class="line">*.md</span><br><span class="line">*.woff</span><br><span class="line">*.ttf</span><br><span class="line">.vscode</span><br><span class="line">.idea</span><br><span class="line">dist</span><br><span class="line">/public</span><br><span class="line">/docs</span><br><span class="line">.husky</span><br><span class="line">.local</span><br><span class="line">/bin</span><br><span class="line">Dockerfile</span><br></pre></td></tr></table></figure><h3 id="3-3-Prettier"><a href="#3-3-Prettier" class="headerlink" title="3.3 Prettier"></a>3.3 Prettier</h3><h4 id="3-3-1-安装"><a href="#3-3-1-安装" class="headerlink" title="3.3.1 安装"></a>3.3.1 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D prettier eslint-plugin-prettier eslint-config-prettier</span><br></pre></td></tr></table></figure><ul><li>prettier：代码格式化，一般 IDE 都有 prettier 的插件，在保存的时候格式化代码。</li><li>eslint-plugin-prettier：不同的程序员有不同的 IDE，不同的 IDE 有不同的<code>prettier</code>插件。但对于项目来说只有一个<code>eslint-plugin-prettier</code>，即统一格式；</li><li>eslint-config-prettier：<code>prettier</code>和<code>ESLint</code>之间有些规则不一样，为解决冲突，<code>eslint-config-prettier</code>将<code>prettier</code>一些规则默认关闭了。</li></ul><h4 id="3-3-2-配置"><a href="#3-3-2-配置" class="headerlink" title="3.3.2 配置"></a>3.3.2 配置</h4><p>在项目根目录新建 Prettier 的代码格式化配置文件：<code>.prettierrc.cjs</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// 超过最大值换行</span></span><br><span class="line">  <span class="attr">printWidth</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="comment">// 缩进字节数</span></span><br><span class="line">  <span class="attr">tabWidth</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="comment">// 缩进不使用tab，使用空格</span></span><br><span class="line">  <span class="attr">useTabs</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// 句尾添加分号</span></span><br><span class="line">  <span class="attr">semi</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">vueIndentScriptAndStyle</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 使用单引号代替双引号</span></span><br><span class="line">  <span class="attr">singleQuote</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">quoteProps</span>: <span class="string">&quot;as-needed&quot;</span>,</span><br><span class="line">  <span class="comment">// 在对象，数组括号与文字之间加空格 &quot;&#123; foo: bar &#125;&quot;</span></span><br><span class="line">  <span class="attr">bracketSpacing</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 在对象或数组最后一个元素后面是否加逗号(在ES5中加尾逗号)</span></span><br><span class="line">  <span class="attr">trailingComma</span>: <span class="string">&quot;es5&quot;</span>,</span><br><span class="line">  <span class="attr">jsxSingleQuote</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">//  (x) =&gt; &#123;&#125; 箭头函数参数只有一个时是否要有小括号。avoid：省略括号</span></span><br><span class="line">  <span class="attr">arrowParens</span>: <span class="string">&quot;avoid&quot;</span>,</span><br><span class="line">  <span class="attr">insertPragma</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">requirePragma</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// 默认值。因为使用了一些折行敏感型的渲染器(如GitHub comment)而按照markdown文本样式进行折行</span></span><br><span class="line">  <span class="attr">proseWrap</span>: <span class="string">&quot;preserve&quot;</span>,</span><br><span class="line">  <span class="attr">htmlWhitespaceSensitivity</span>: <span class="string">&quot;strict&quot;</span>,</span><br><span class="line">  <span class="comment">// 结尾</span></span><br><span class="line">  <span class="attr">endOfLine</span>: <span class="string">&quot;lf&quot;</span>,</span><br><span class="line">  <span class="attr">rangeStart</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在项目根目录新建 Prettier 的代码检测忽略的文件的配置文件：<code>.prettierignore</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/dist/*</span><br><span class="line">.local</span><br><span class="line">.output.js</span><br><span class="line">/node_modules/**</span><br><span class="line"></span><br><span class="line">**/*.svg</span><br><span class="line">**/*.sh</span><br><span class="line"></span><br><span class="line">/public/*</span><br></pre></td></tr></table></figure><h3 id="3-4-StyleLint"><a href="#3-4-StyleLint" class="headerlink" title="3.4 StyleLint"></a>3.4 StyleLint</h3><h4 id="3-4-1-安装"><a href="#3-4-1-安装" class="headerlink" title="3.4.1 安装"></a>3.4.1 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D stylelint stylelint-config-standard stylelint-config-prettier stylelint-order</span><br></pre></td></tr></table></figure><ul><li>stylelint：是对我们编写的样式进行检查的插件；</li><li>stylelint-config-standard：是<code>stylelint</code>扩展的检查标准库；</li><li>stylelint-config-prettier：是用来解决冲突的（参考之前的<code>prettier</code>的 eslint-config-prettier）；</li><li>stylelint-order：是检查我们样式编写顺序的；</li></ul><h4 id="3-4-2-配置"><a href="#3-4-2-配置" class="headerlink" title="3.4.2 配置"></a>3.4.2 配置</h4><p>在项目根目录新建 StyleLint 的代码格式化配置文件：<code>.stylelintrc.cjs</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">root</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 插件</span></span><br><span class="line">  <span class="attr">plugins</span>: [<span class="string">&quot;stylelint-order&quot;</span>],</span><br><span class="line">  <span class="comment">// 扩展</span></span><br><span class="line">  <span class="attr">extends</span>: [</span><br><span class="line">    <span class="string">&quot;stylelint-config-standard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stylelint-config-prettier&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stylelint-config-standard-scss&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stylelint-config-recommended-vue&quot;</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// Unknown word (CssSyntaxError) 错误,这个问题主要是因为 stylelint 升级到 14 大版本造成的,解决办法是安装 stylelint-config-recommended-scss 插件</span></span><br><span class="line">  <span class="attr">customSyntax</span>: <span class="string">&quot;postcss-html&quot;</span>,</span><br><span class="line">  <span class="attr">overrides</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">files</span>: [<span class="string">&quot;**/*.&#123;scss,css,sass&#125;&quot;</span>], <span class="comment">// css 相关文件由 postcss-scss 处理</span></span><br><span class="line">      <span class="attr">customSyntax</span>: <span class="string">&quot;postcss-scss&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 自定义规则</span></span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="comment">// 禁止使用未知的伪类选择器</span></span><br><span class="line">    <span class="string">&quot;selector-pseudo-class-no-unknown&quot;</span>: [</span><br><span class="line">      <span class="literal">true</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">ignorePseudoClasses</span>: [<span class="string">&quot;global&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 禁止使用未知规则</span></span><br><span class="line">    <span class="string">&quot;at-rule-no-unknown&quot;</span>: [</span><br><span class="line">      <span class="literal">true</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">ignoreAtRules</span>: [<span class="string">&quot;function&quot;</span>, <span class="string">&quot;if&quot;</span>, <span class="string">&quot;each&quot;</span>, <span class="string">&quot;include&quot;</span>, <span class="string">&quot;mixin&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 禁止空来源</span></span><br><span class="line">    <span class="string">&quot;no-empty-source&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="comment">// 禁止使用无效的命名网格区域</span></span><br><span class="line">    <span class="string">&quot;named-grid-areas-no-invalid&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="comment">// 要求或不允许使用Unicode字节顺序标记</span></span><br><span class="line">    <span class="string">&quot;unicode-bom&quot;</span>: <span class="string">&quot;never&quot;</span>,</span><br><span class="line">    <span class="comment">// 禁止较低特异性的选择器在覆盖较高特异性的选择器之后出现</span></span><br><span class="line">    <span class="string">&quot;no-descending-specificity&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="comment">// 禁止在字体系列名称列表中缺少通用系列</span></span><br><span class="line">    <span class="string">&quot;font-family-no-missing-generic-family-keyword&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="comment">// 在声明的冒号后面需要一个空格或禁止空格</span></span><br><span class="line">    <span class="string">&quot;declaration-colon-space-after&quot;</span>: <span class="string">&quot;always-single-line&quot;</span>,</span><br><span class="line">    <span class="comment">// 在声明的冒号之前需要一个空格或禁止使用空格</span></span><br><span class="line">    <span class="string">&quot;declaration-colon-space-before&quot;</span>: <span class="string">&quot;never&quot;</span>,</span><br><span class="line">    <span class="comment">// 在声明块内要求或不允许尾随分号</span></span><br><span class="line">    <span class="string">&quot;declaration-block-trailing-semicolon&quot;</span>: <span class="string">&quot;always&quot;</span>,</span><br><span class="line">    <span class="comment">// 在规则之前要求或禁止使用空行</span></span><br><span class="line">    <span class="string">&quot;rule-empty-line-before&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;always&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">ignore</span>: [<span class="string">&quot;after-comment&quot;</span>, <span class="string">&quot;first-nested&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 禁止使用未知单位</span></span><br><span class="line">    <span class="string">&quot;unit-no-unknown&quot;</span>: [<span class="literal">true</span>, &#123; <span class="attr">ignoreUnits</span>: [<span class="string">&quot;rpx&quot;</span>] &#125;],</span><br><span class="line">    <span class="comment">// Specify the alphabetical order of the attributes in the declaration block</span></span><br><span class="line">    <span class="comment">// 样式顺序</span></span><br><span class="line">    <span class="string">&quot;order/properties-order&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;position&quot;</span>,</span><br><span class="line">      <span class="string">&quot;top&quot;</span>,</span><br><span class="line">      <span class="string">&quot;right&quot;</span>,</span><br><span class="line">      <span class="string">&quot;bottom&quot;</span>,</span><br><span class="line">      <span class="string">&quot;left&quot;</span>,</span><br><span class="line">      <span class="string">&quot;z-index&quot;</span>,</span><br><span class="line">      <span class="string">&quot;display&quot;</span>,</span><br><span class="line">      <span class="string">&quot;float&quot;</span>,</span><br><span class="line">      <span class="string">&quot;width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;height&quot;</span>,</span><br><span class="line">      <span class="string">&quot;max-width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;max-height&quot;</span>,</span><br><span class="line">      <span class="string">&quot;min-width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;min-height&quot;</span>,</span><br><span class="line">      <span class="string">&quot;padding&quot;</span>,</span><br><span class="line">      <span class="string">&quot;padding-top&quot;</span>,</span><br><span class="line">      <span class="string">&quot;padding-right&quot;</span>,</span><br><span class="line">      <span class="string">&quot;padding-bottom&quot;</span>,</span><br><span class="line">      <span class="string">&quot;padding-left&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-top&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-right&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-bottom&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-left&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-collapse&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-top-collapse&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-right-collapse&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-bottom-collapse&quot;</span>,</span><br><span class="line">      <span class="string">&quot;margin-left-collapse&quot;</span>,</span><br><span class="line">      <span class="string">&quot;overflow&quot;</span>,</span><br><span class="line">      <span class="string">&quot;overflow-x&quot;</span>,</span><br><span class="line">      <span class="string">&quot;overflow-y&quot;</span>,</span><br><span class="line">      <span class="string">&quot;clip&quot;</span>,</span><br><span class="line">      <span class="string">&quot;clear&quot;</span>,</span><br><span class="line">      <span class="string">&quot;font&quot;</span>,</span><br><span class="line">      <span class="string">&quot;font-family&quot;</span>,</span><br><span class="line">      <span class="string">&quot;font-size&quot;</span>,</span><br><span class="line">      <span class="string">&quot;font-smoothing&quot;</span>,</span><br><span class="line">      <span class="string">&quot;osx-font-smoothing&quot;</span>,</span><br><span class="line">      <span class="string">&quot;font-style&quot;</span>,</span><br><span class="line">      <span class="string">&quot;font-weight&quot;</span>,</span><br><span class="line">      <span class="string">&quot;hyphens&quot;</span>,</span><br><span class="line">      <span class="string">&quot;src&quot;</span>,</span><br><span class="line">      <span class="string">&quot;line-height&quot;</span>,</span><br><span class="line">      <span class="string">&quot;letter-spacing&quot;</span>,</span><br><span class="line">      <span class="string">&quot;word-spacing&quot;</span>,</span><br><span class="line">      <span class="string">&quot;color&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-align&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-decoration&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-indent&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-overflow&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-rendering&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-size-adjust&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-shadow&quot;</span>,</span><br><span class="line">      <span class="string">&quot;text-transform&quot;</span>,</span><br><span class="line">      <span class="string">&quot;word-break&quot;</span>,</span><br><span class="line">      <span class="string">&quot;word-wrap&quot;</span>,</span><br><span class="line">      <span class="string">&quot;white-space&quot;</span>,</span><br><span class="line">      <span class="string">&quot;vertical-align&quot;</span>,</span><br><span class="line">      <span class="string">&quot;list-style&quot;</span>,</span><br><span class="line">      <span class="string">&quot;list-style-type&quot;</span>,</span><br><span class="line">      <span class="string">&quot;list-style-position&quot;</span>,</span><br><span class="line">      <span class="string">&quot;list-style-image&quot;</span>,</span><br><span class="line">      <span class="string">&quot;pointer-events&quot;</span>,</span><br><span class="line">      <span class="string">&quot;cursor&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background-attachment&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background-color&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background-image&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background-position&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background-repeat&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background-size&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-collapse&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-top&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-right&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-bottom&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-left&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-color&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-image&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-top-color&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-right-color&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-bottom-color&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-left-color&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-spacing&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-style&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-top-style&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-right-style&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-bottom-style&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-left-style&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-top-width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-right-width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-bottom-width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-left-width&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-radius&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-top-right-radius&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-bottom-right-radius&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-bottom-left-radius&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-top-left-radius&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-radius-topright&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-radius-bottomright&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-radius-bottomleft&quot;</span>,</span><br><span class="line">      <span class="string">&quot;border-radius-topleft&quot;</span>,</span><br><span class="line">      <span class="string">&quot;content&quot;</span>,</span><br><span class="line">      <span class="string">&quot;quotes&quot;</span>,</span><br><span class="line">      <span class="string">&quot;outline&quot;</span>,</span><br><span class="line">      <span class="string">&quot;outline-offset&quot;</span>,</span><br><span class="line">      <span class="string">&quot;opacity&quot;</span>,</span><br><span class="line">      <span class="string">&quot;filter&quot;</span>,</span><br><span class="line">      <span class="string">&quot;visibility&quot;</span>,</span><br><span class="line">      <span class="string">&quot;size&quot;</span>,</span><br><span class="line">      <span class="string">&quot;zoom&quot;</span>,</span><br><span class="line">      <span class="string">&quot;transform&quot;</span>,</span><br><span class="line">      <span class="string">&quot;box-align&quot;</span>,</span><br><span class="line">      <span class="string">&quot;box-flex&quot;</span>,</span><br><span class="line">      <span class="string">&quot;box-orient&quot;</span>,</span><br><span class="line">      <span class="string">&quot;box-pack&quot;</span>,</span><br><span class="line">      <span class="string">&quot;box-shadow&quot;</span>,</span><br><span class="line">      <span class="string">&quot;box-sizing&quot;</span>,</span><br><span class="line">      <span class="string">&quot;table-layout&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation-delay&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation-duration&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation-iteration-count&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation-name&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation-play-state&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation-timing-function&quot;</span>,</span><br><span class="line">      <span class="string">&quot;animation-fill-mode&quot;</span>,</span><br><span class="line">      <span class="string">&quot;transition&quot;</span>,</span><br><span class="line">      <span class="string">&quot;transition-delay&quot;</span>,</span><br><span class="line">      <span class="string">&quot;transition-duration&quot;</span>,</span><br><span class="line">      <span class="string">&quot;transition-property&quot;</span>,</span><br><span class="line">      <span class="string">&quot;transition-timing-function&quot;</span>,</span><br><span class="line">      <span class="string">&quot;background-clip&quot;</span>,</span><br><span class="line">      <span class="string">&quot;backface-visibility&quot;</span>,</span><br><span class="line">      <span class="string">&quot;resize&quot;</span>,</span><br><span class="line">      <span class="string">&quot;appearance&quot;</span>,</span><br><span class="line">      <span class="string">&quot;user-select&quot;</span>,</span><br><span class="line">      <span class="string">&quot;interpolation-mode&quot;</span>,</span><br><span class="line">      <span class="string">&quot;direction&quot;</span>,</span><br><span class="line">      <span class="string">&quot;marks&quot;</span>,</span><br><span class="line">      <span class="string">&quot;page&quot;</span>,</span><br><span class="line">      <span class="string">&quot;set-link-source&quot;</span>,</span><br><span class="line">      <span class="string">&quot;unicode-bidi&quot;</span>,</span><br><span class="line">      <span class="string">&quot;speak&quot;</span>,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 忽略检查的文件</span></span><br><span class="line">  <span class="attr">ignoreFiles</span>: [<span class="string">&quot;**/*.js&quot;</span>, <span class="string">&quot;**/*.jsx&quot;</span>, <span class="string">&quot;**/*.tsx&quot;</span>, <span class="string">&quot;**/*.ts&quot;</span>],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在项目根目录新建 StyleLint 的代码检测忽略的文件的配置文件：<code>.stylelintignore</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/dist/*</span><br><span class="line">/public/*</span><br></pre></td></tr></table></figure><h3 id="3-5-PostCSS"><a href="#3-5-PostCSS" class="headerlink" title="3.5 PostCSS"></a>3.5 PostCSS</h3><h4 id="3-5-1-安装"><a href="#3-5-1-安装" class="headerlink" title="3.5.1 安装"></a>3.5.1 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D postcss autoprefixer</span><br></pre></td></tr></table></figure><ul><li>postcss：编写一般的样式，渲染页面的<code>dom</code>节点有面向各种浏览器厂商的样式；</li><li>autoprefixer：postcss 的一个插件；</li></ul><h4 id="3-5-2-配置"><a href="#3-5-2-配置" class="headerlink" title="3.5.2 配置"></a>3.5.2 配置</h4><p>在项目根目录新建 PostCSS 的代码格式化配置文件：<code>.postcssrc.cjs</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: &#123;</span><br><span class="line">    <span class="attr">autoprefixer</span>: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="3-6-rimraf"><a href="#3-6-rimraf" class="headerlink" title="3.6 rimraf"></a>3.6 rimraf</h3><blockquote><p>由于手动删除文件夹太慢了，需要实现脚本删除文件。</p></blockquote><h4 id="3-6-1-安装"><a href="#3-6-1-安装" class="headerlink" title="3.6.1 安装"></a>3.6.1 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D rimraf</span><br></pre></td></tr></table></figure><h3 id="3-7-npm-check-updates"><a href="#3-7-npm-check-updates" class="headerlink" title="3.7 npm-check-updates"></a>3.7 npm-check-updates</h3><p>检查当前项目中有没有哪些依赖包可更新（简写 ncu）</p><h4 id="3-7-1-安装"><a href="#3-7-1-安装" class="headerlink" title="3.7.1 安装"></a>3.7.1 安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g npm-check-updates</span><br></pre></td></tr></table></figure><p>全部更新 package.json</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ncu -u</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何在CentOS上安装.Net环境</title>
      <link href="/2023/03/06/ece9fca3a62c/"/>
      <url>/2023/03/06/ece9fca3a62c/</url>
      
        <content type="html"><![CDATA[<h1 id="如何在CentOS上安装-Net环境"><a href="#如何在CentOS上安装-Net环境" class="headerlink" title="如何在CentOS上安装.Net环境"></a>如何在CentOS上安装.Net环境</h1><h2 id="查看旧版本"><a href="#查看旧版本" class="headerlink" title="查看旧版本"></a>查看旧版本</h2><p>使用命令查看安装了哪些版本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet --list-sdks</span><br><span class="line">dotnet --list-runtimes</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202303062249472.png" alt="image-20230302103308955"></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装 .NET 之前，请运行以下命令，将 Microsoft 包签名密钥添加到受信任密钥列表，并添加 Microsoft 包存储库。 打开终端并运行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202303062249473.png" alt="image-20230302103621322"></p><h3 id="安装-SDK"><a href="#安装-SDK" class="headerlink" title="安装 SDK"></a>安装 SDK</h3><p>.NET SDK 使你可以通过 .NET 开发应用。 如果安装 .NET SDK，则无需安装相应的运行时。 若要安装 .NET SDK，请运行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install dotnet-sdk-7.0</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202303062249474.png" alt="image-20230302110929965"></p><h3 id="安装运行时"><a href="#安装运行时" class="headerlink" title="安装运行时"></a>安装运行时</h3><p>通过 ASP.NET Core 运行时，可以运行使用 .NET 开发且未提供运行时的应用。 以下命令将安装 ASP.NET Core 运行时，这是与 .NET 最兼容的运行时。 在终端中，运行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install aspnetcore-runtime-7.0</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202303062249475.png" alt="image-20230302110336938"></p><p><img src="https://cdn.zhaifanhua.com/blog/img/202303062249476.png" alt="image-20230302110353858"></p><h2 id="验证版本"><a href="#验证版本" class="headerlink" title="验证版本"></a>验证版本</h2><p>用以下命令查看版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet --info</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202303062249477.png" alt="image-20230302111055266"></p><p>或用以下命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet --list-sdks</span><br><span class="line">dotnet --list-runtimes</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202303062249478.png" alt="image-20230302111205823"></p><p>安装完成。</p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
            <tag> DotNet </tag>
            
            <tag> CentOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用acme.sh自动部署域名证书</title>
      <link href="/2022/11/30/199e220c7b2c/"/>
      <url>/2022/11/30/199e220c7b2c/</url>
      
        <content type="html"><![CDATA[<h1 id="用acme-sh自动部署域名证书"><a href="#用acme-sh自动部署域名证书" class="headerlink" title="用acme.sh自动部署域名证书"></a>用acme.sh自动部署域名证书</h1><h2 id="安装ACME"><a href="#安装ACME" class="headerlink" title="安装ACME"></a>安装ACME</h2><p>目前使用量最大的免费<code>SSL</code>证书就是<code>Let’s Encrypt</code>，自<code>2018-03</code>开始，<code>Let’s Encrypt</code>官方发布上线了免费的<code>SSL</code>泛域名证书，目前通过<code>DNS</code>方式获取比较快，国内可以通过鹅云的<code>DNSPod</code>域名<code>API</code>或者猫云域名<code>API</code>自动签发<code>Let’s Encrypt</code>泛域名证书。因为鹅云使用的就是<code>DNSPod</code>域名，并且鹅云和<a href="https://link.juejin.cn/?target=https://www.dnspod.cn">DNSPod</a>的账号是打通的，可以使用<code>wx</code>直接扫码登录。下文需要对鹅云和<code>DNSPod</code>进行操作，为了简化证书申请过程，需要提前安装<a href="https://link.juejin.cn/?target=https://github.com/acmesh-official/acme.sh">acme.sh</a>。<code>acme.sh</code>实现了<code>acme</code>协议，可以从<code>Let’s Encrypt</code>生成免费的证书，自动创建<code>cron</code>任务, 每天零点自动检测所有的证书，如果发现证书快过期了，需要更新，则<code>acme.sh</code>会自动更新证书，安装过程不会污染已有的系统任何功能和文件，所有的修改都限制在安装目录中。</p><p>先进行依赖下载和更新。如果服务器是<code>CentOS</code>系统，使用下面的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update &amp;&amp; yum install curl -y &amp;&amp; yum install cron -y &amp;&amp; yum install socat -y</span><br></pre></td></tr></table></figure><p>如果服务器是<code>Debian/Ubuntu</code>系统，则使用下面的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get install curl -y &amp;&amp; apt-get install cron -y &amp;&amp; apt-get install socat -y</span><br></pre></td></tr></table></figure><h2 id="1-安装-acme-sh"><a href="#1-安装-acme-sh" class="headerlink" title="1. 安装 acme.sh"></a>1. 安装 <strong>acme.sh</strong></h2><p>安装很简单, 一个命令:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://get.acme.sh | sh -s email=yourEmail</span><br></pre></td></tr></table></figure><p>配置自动解析</p><p>以 dnspod 为例, 你需要先登录到 dnspod 账号, 生成你的 api id 和 api key, 都是免费的。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049391.png" alt="image-20221128121438606">然后配置:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export DP_Id=&quot;apiid&quot;</span><br><span class="line">export DP_Key=&quot;apikey&quot;</span><br></pre></td></tr></table></figure><h2 id="2-生成证书"><a href="#2-生成证书" class="headerlink" title="2. 生成证书"></a>2. 生成证书</h2><h3 id="手动-dns-方式-手动在域名上添加一条-txt-解析记录-验证域名所有权。"><a href="#手动-dns-方式-手动在域名上添加一条-txt-解析记录-验证域名所有权。" class="headerlink" title="手动 dns 方式, 手动在域名上添加一条 txt 解析记录, 验证域名所有权。"></a>手动 dns 方式, 手动在域名上添加一条 txt 解析记录, 验证域名所有权。</h3><p>这种方式的好处是, 你不需要任何服务器, 不需要任何公网 ip, 只需要 dns 的解析记录即可完成验证. 坏处是，如果不同时配置 Automatic DNS API，使用这种方式 acme.sh 将无法自动更新证书，每次都需要手动再次重新解析验证域名所有权。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --issue --dns -d zhaifanhua.com -d *.zhaifanhua.com --yes-I-know-dns-manual-mode-enough-go-ahead-please</span><br></pre></td></tr></table></figure><p>然后, <strong>acme.sh</strong> 会生成相应的解析记录显示出来, 你只需要在你的域名管理面板中添加这条 txt 记录即可.</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049392.png" alt="image-20221128120542715"></p><p>验证解析生效：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049393.png" alt="image-20221128150010468"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -q=txt _acme-challenge.zhaifanhua.com</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049394.png" alt="image-20221128150252182"></p><p>等待解析完成之后, 重新生成证书:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --force --renew -d zhaifanhua.com -d *.zhaifanhua.com --yes-I-know-dns-manual-mode-enough-go-ahead-please</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049395.png" alt="image-20221128120812869"></p><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049396.png" alt="image-20221128120833039"></p><h2 id="3-copy-安装-证书"><a href="#3-copy-安装-证书" class="headerlink" title="3. copy&#x2F;安装 证书"></a>3. copy&#x2F;安装 证书</h2><p>前面证书生成以后, 接下来需要把证书 copy 到真正需要用它的地方：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049397.png" alt="image-20221128124635187"></p><p>注意, 默认生成的证书都放在安装目录下: <code>~/.acme.sh/</code>, 请不要直接使用此目录下的文件, 例如: 不要直接让 nginx&#x2F;apache 的配置文件使用这下面的文件. 这里面的文件都是内部使用, 而且目录结构可能会变化。</p><p>正确的使用方法是使用 <code>--install-cert</code> 命令,并指定目标位置, 然后证书文件会被copy到相应的位置, 例如:</p><h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx:"></a>Nginx:</h3><p>执行命令，这里指定的所有参数都会被自动记录下来, 并在将来证书自动更新以后, 被再次自动调用。</p><p>配置 Nginx 文件：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049398.png" alt="image-20221128130528181"></p><p>这里我将其配置到了 &#x2F;home&#x2F;ssl 目录下，zhaifanhua.com_key.key 和 zhaifanhua.com_cert.pem 分别是私匙和证书名称，可自定义。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --install-cert -d zhaifanhua.com -d *.zhaifanhua.com --key-file /home/ssl/zhaifanhua.com_key.key --fullchain-file /home/ssl/zhaifanhua.com_fullchain.cer --reloadcmd &quot;service nginx force-reload&quot;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049399.png" alt="image-20221128131040621"></p><blockquote><p>(一个小提醒, 这里用的是 <code>service nginx force-reload</code>, 不是 <code>service nginx reload</code>, 据测试, <code>reload</code> 并不会重新加载证书, 所以用的 <code>force-reload</code>)</p><p>Nginx 的配置 <code>ssl_certificate</code> 使用 <code>/etc/nginx/ssl/fullchain.cer</code> ，而非 <code>/etc/nginx/ssl/&lt;domain&gt;.cer</code> ，否则 <a href="https://www.ssllabs.com/ssltest/">SSL Labs</a> 的测试会报 <code>Chain issues Incomplete</code> 错误。</p><p><code>--install-cert</code>命令可以携带很多参数, 来指定目标文件. 并且可以指定 reloadcmd, 当证书更新以后, reloadcmd会被自动调用,让服务器生效。</p><p>详细参数请参考: <a href="https://github.com/Neilpang/acme.sh#3-install-the-issued-cert-to-apachenginx-etc">https://github.com/Neilpang/acme.sh#3-install-the-issued-cert-to-apachenginx-etc</a></p></blockquote><p>显示 Reload success 表示成功！</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049400.png" alt="image-20221128131134054"></p><h2 id="4-查看已安装证书信息"><a href="#4-查看已安装证书信息" class="headerlink" title="4. 查看已安装证书信息"></a>4. 查看已安装证书信息</h2><h3 id="查看-删除证书"><a href="#查看-删除证书" class="headerlink" title="查看&#x2F;删除证书"></a>查看&#x2F;删除证书</h3><p>查看证书</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --list</span><br></pre></td></tr></table></figure><p>删除证书</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh remove &lt;SAN_Domains&gt;</span><br></pre></td></tr></table></figure><p>查看信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --info -d zhaifanhua.com -d *.zhaifanhua.com</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211300049401.png" alt="image-20221128134334244"></p><h2 id="5-更新证书"><a href="#5-更新证书" class="headerlink" title="5. 更新证书"></a>5. 更新证书</h2><p>目前证书在 60 天以后会自动更新, 你无需任何操作. 今后有可能会缩短这个时间, 不过都是自动的, 你不用关心.</p><p>请确保 cronjob 正确安装, 看起来是类似这样的:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">crontab  -l</span><br><span class="line"></span><br><span class="line">*/5 * * * * flock -xn /tmp/stargate.lock -c &#x27;/usr/local/qcloud/stargate/admin/start.sh &gt; /dev/null 2&gt;&amp;1 &amp;&#x27;</span><br><span class="line">0 0 * * * &quot;/root/.acme.sh&quot;/acme.sh --cron --home &quot;/root/.acme.sh&quot; &gt; /dev/null</span><br></pre></td></tr></table></figure><h2 id="6-关于修改ReloadCmd"><a href="#6-关于修改ReloadCmd" class="headerlink" title="6. 关于修改ReloadCmd"></a>6. 关于修改ReloadCmd</h2><p>目前修改<code>ReloadCmd</code>没有专门的命令，可以通过重新安装证书来实现修改<code>reloadCmd</code>的目的。 此外，安装证书后，相关信息是保存在<code>~/.acme.sh/example.com/example.conf</code>文件下的，内容就是<code>acme.sh --info -d example.com</code>输出的信息，不过<code>ReloadCmd</code>在文件中使用了Base64编码。理论上可以通过直接修改该文件来修改<code>ReloadCmd</code>，且修改时，无需Base64编码，直接写命令原文<code>acme.sh</code>也可以识别。 不过，<code>example.conf</code>文件的位置和内容格式以后可能会改变！<code>example.conf</code>一直都是内部使用, 后面有可能会改为用 sqlite 或者mysql 格式存储. 所以一般不建议自己修改。</p><h2 id="7-更新-acme-sh"><a href="#7-更新-acme-sh" class="headerlink" title="7. 更新 acme.sh"></a>7. 更新 acme.sh</h2><p>目前由于 acme 协议和 letsencrypt CA 都在频繁的更新, 因此 acme.sh 也经常更新以保持同步.</p><p>升级 acme.sh 到最新版 :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --upgrade</span><br></pre></td></tr></table></figure><p>如果你不想手动升级, 可以开启自动升级:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --upgrade --auto-upgrade</span><br></pre></td></tr></table></figure><p>之后, acme.sh 就会自动保持更新了.</p><p>你也可以随时关闭自动更新:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --upgrade --auto-upgrade  0</span><br></pre></td></tr></table></figure><h2 id="8-出错怎么办："><a href="#8-出错怎么办：" class="headerlink" title="8. 出错怎么办："></a>8. 出错怎么办：</h2><p>如果出错, 请添加 debug log：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue  .....  --debug </span><br></pre></td></tr></table></figure><p>或者：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue  .....  --debug  2</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
            <tag> 域名 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编辑器常用正则表达式</title>
      <link href="/2022/11/30/ba087fd5c740/"/>
      <url>/2022/11/30/ba087fd5c740/</url>
      
        <content type="html"><![CDATA[<h1 id="编辑器常用正则表达式"><a href="#编辑器常用正则表达式" class="headerlink" title="编辑器常用正则表达式"></a>编辑器常用正则表达式</h1><h2 id="匹配空格"><a href="#匹配空格" class="headerlink" title="匹配空格"></a>匹配空格</h2><p>表达式：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^\s?|\s+</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290633252.png" alt="image-20221129055206165"></p><h2 id="匹配截至空格"><a href="#匹配截至空格" class="headerlink" title="匹配截至空格"></a>匹配截至空格</h2><p>表达式：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^\s?|\s+$</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290634216.png" alt="image-20221129055559806"></p><h2 id="匹配空行"><a href="#匹配空行" class="headerlink" title="匹配空行"></a>匹配空行</h2><p>根据文档格式和系统（windows, mac, linux行尾符）不同 将其中的\r\n替换成不同行尾符</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// windows:</span><br><span class="line">^(\s*)\r\<span class="attribute">n</span></span><br><span class="line">// linux: <span class="regexp"></span></span><br><span class="line"><span class="regexp">^(\s*)\n</span></span><br><span class="line">// mac: <span class="regexp"></span></span><br><span class="line"><span class="regexp">^(\s*)\n</span></span><br></pre></td></tr></table></figure><p>表达式（通用）：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(\s*)(\r?\n?)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290634217.png" alt="image-20221129054443447"></p><h2 id="匹配截至空行"><a href="#匹配截至空行" class="headerlink" title="匹配截至空行"></a>匹配截至空行</h2><p>表达式：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^\s?|\s+$</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290634218.png" alt="image-20221129055737701"></p><h2 id="匹配无空格概要注释"><a href="#匹配无空格概要注释" class="headerlink" title="匹配无空格概要注释"></a>匹配无空格概要注释</h2><p>表达式：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(.*)([/]&#123;3&#125;\s+).*(\s?\r?\n?)$</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290634219.png" alt="image-20221129060019918"></p><h2 id="匹配有空格概要注释"><a href="#匹配有空格概要注释" class="headerlink" title="匹配有空格概要注释"></a>匹配有空格概要注释</h2><p>表达式：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(\s?|\s+)([/]&#123;3&#125;\s+).*(\s?\r?\n?)$</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290634220.png" alt="image-20221129054100378"></p><h2 id="匹配单行无空格注释"><a href="#匹配单行无空格注释" class="headerlink" title="匹配单行无空格注释"></a>匹配单行无空格注释</h2><p>表达式：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^([/]&#123;2&#125;\s+).*$</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290634221.png" alt="image-20221129060239855"></p><h2 id="匹配单行有空格注释"><a href="#匹配单行有空格注释" class="headerlink" title="匹配单行有空格注释"></a>匹配单行有空格注释</h2><p>表达式：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(\s?|\s+)([/]&#123;2&#125;\s+).*$</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202211290634222.png" alt="image-20221129053225836"></p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 编辑器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何在 CentOS 9 Stream 上安装 MariaDB</title>
      <link href="/2022/07/22/31129743390b/"/>
      <url>/2022/07/22/31129743390b/</url>
      
        <content type="html"><![CDATA[<h1 id="如何在-CentOS-9-Stream-上安装-MariaDB"><a href="#如何在-CentOS-9-Stream-上安装-MariaDB" class="headerlink" title="如何在 CentOS 9 Stream 上安装 MariaDB"></a>如何在 CentOS 9 Stream 上安装 MariaDB</h1><blockquote><p>MariaDB 是一个免费的开源数据库管理系统，可以替代 Oracle MySQL 服务器。MariaDB 是 MySQL 的开发，它专注于稳定性和性能，并免费提供给用户。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212965.jpg" alt="Mariadb-CentOS"></p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>在 CentOS 9 Stream 上安装 MariaDB</p><h3 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤 1."></a>步骤 1.</h3><p>首先，让我们首先确保您的系统是最新的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf update</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212967.png" alt="image-20220722223142282"></p><p>出现Complete即更新成功，为保证顺利运行，请重启系统。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure><h3 id="步骤-2"><a href="#步骤-2" class="headerlink" title="步骤 2."></a>步骤 2.</h3><p>默认情况下，CentOS 9 Stream 基础存储库中提供了 MariaDB。现在我们运行以下命令将 MariaDB 安装到您的系统：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf install mariadb-server</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212968.png" alt="image-20220722223057213"></p><p>安装完成后检查版本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mariadb --version</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212969.png" alt="image-20220722223446830"></p><p>安装完成后，现在启用 MariaDB（系统启动时自动启动），启动 MariaDB，并使用以下命令验证状态：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start mariadb</span><br><span class="line">sudo systemctl enable mariadb</span><br><span class="line">sudo systemctl status mariadb</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212970.png" alt="image-20220722223600841"></p><h3 id="步骤-3"><a href="#步骤-3" class="headerlink" title="步骤 3."></a>步骤 3.</h3><p>安全 MariaDB 安装。</p><p>默认情况下，MariaDB 未加固。<code>mysql_secure_installation</code>您可以使用脚本保护 MariaDB 。您应该仔细阅读下面的每个步骤，这些步骤将设置 root 密码、删除匿名用户、禁止远程 root 登录、删除测试数据库和访问安全 MariaDB：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure><p>像这样配置它：</p><p>为了登录MariaDB以确保其安全，我们需要当前根用户的密码。如果您刚刚安装了MariaDB尚未设置根密码，您应该在此处按enter键。</p><blockquote><p>我们刚安装，直接回车。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212971.png" alt="image-20220722231526802"></p><p>设置根密码或使用unix_socket套接字可以确保在没有适当授权的情况下登录到MariaDB root用户。</p><blockquote><p>这里我为了方便设置了y，你可根据自身情况设置。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212972.png" alt="image-20220722235655707"></p><p>更改根密码，注意输入密码时不可见，须确认输入第二遍。</p><blockquote><p>这里更改密码，设置y。之后输入密码。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212973.png" alt="image-20220722232112955"></p><p>默认情况下，MariaDB安装有匿名用户，允许任何人登录MariaDB而不必为其创建用户帐户他们这仅用于测试和安装再平稳一点。在移动到生产环境。</p><blockquote><p>删除匿名用户，这里我删除了，设置了y。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212974.png" alt="image-20220722232340835"></p><p>通常，只允许root从“localhost”连接。这确保有人无法从网络中猜测根密码。</p><blockquote><p>是否允许根用户远程登录，我需要远程登录，所以这了选择了n。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212975.png" alt="image-20220722225846453"></p><p>默认情况下，MariaDB附带了一个名为“test”的数据库，任何人都可以使用它通道这也仅用于测试，应删除在进入生产环境之前。</p><blockquote><p>这里我不用测试，直接删除，选择了y。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212976.png" alt="image-20220722235814179"></p><p>重新加载特权表，将确保以上的所有更改将立即生效。</p><blockquote><p>现在重新加载权限表，选择y。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212977.png" alt="image-20220722230312015"></p><p>到此，安装成功！可以直接用用户【root】和密码【你的密码】登录 MariaDB 了，请使用以下命令（请注意，它与登录 MariaDB 数据库的命令相同）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212978.png" alt="image-20220722232556122"></p><h3 id="步骤-4"><a href="#步骤-4" class="headerlink" title="步骤 4."></a>步骤 4.</h3><p>用 root 账户启用到 MariaDB 数据库的远程连接：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">## 授予权限</span><br><span class="line">grant all on *.* to &quot;root&quot;@&quot;%&quot; identified by &quot;你的root账户密码&quot;;</span><br><span class="line"></span><br><span class="line">## 刷新权限</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">## 查询</span><br><span class="line">show grants for &quot;root&quot;@&quot;%&quot;;</span><br></pre></td></tr></table></figure><p>用 Navicat 测试一下</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230212979.png" alt="image-20220723020856932"></p><p>大功告成！</p>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> MariaDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《苹果》影评观后感</title>
      <link href="/2022/06/22/7898d567165f/"/>
      <url>/2022/06/22/7898d567165f/</url>
      
        <content type="html"><![CDATA[<h1 id="《苹果》影评观后感"><a href="#《苹果》影评观后感" class="headerlink" title="《苹果》影评观后感"></a>《苹果》影评观后感</h1><hr><p>注：本文摘自百度文库</p><blockquote><p>◎译　　名　Lost in Beijing&#x2F;迷失北京</p><p>◎片　　名　苹果</p><p>◎年　　代　2007</p><p>◎产　　地　中国大陆</p><p>◎类　　别　剧情&#x2F;情色</p><p>◎语　　言　汉语普通话</p><p>◎字　　幕　中字</p><p>◎上映日期　2007-02-16(柏林电影节)</p><p>◎IMDb评分 6.7&#x2F;10 from 2,204 users</p><p>◎豆瓣评分　6.7&#x2F;10 from 102,997 users</p><p>◎片　　长　112分钟&#x2F;115分钟</p><p>◎导　　演　李玉 Yu Li</p><p>◎演　　员　梁家辉 Tony Leung</p><p>　　　　　　佟大为 Dawei Tong</p><p>　　　　　　范冰冰 Bingbing Fan</p><p>　　　　　　金燕玲 Elaine Jin</p><p>　　　　　　曾美慧孜 Meihuizi Zeng</p><p>　　　　　　方励 Li Fang</p><p>　　　　　　鲍振江 Zhenjiang Bao</p><p>　　　　　　董立范 Lifan Dong</p><p>　　　　　　三宅尚子 Naoko Miyake</p><p>◎简　　介</p><p>　　刘苹果（范冰冰饰）在北京一家洗脚城里做按摩妹，丈夫安坤（佟大为饰）是负责清洗高楼落地窗的工人，二人生活贫困，却相亲相爱。</p><p>　　洗脚城老板林东（梁家辉饰）是个好色的港商，时常找不同小姐满足生理需要。老婆王梅（金燕玲饰）不能生育，经营一家美容院，两人感情冷淡。</p><p>　　一日刘苹果的好友小妹因为得罪客人而被开除，二人喝得酩酊大醉。神志混乱的苹果误打误撞走到一间足浴客房，正好是林东的休息室，二人发生关系，却被正在刷窗的安坤看到。</p><p>　　安坤欲借此敲诈林东，并前去找王梅谈判，愤怒的王梅要林东也尝尝“戴绿帽”的滋味，于是与安坤发生关系。</p><p>　　而在这时，一个更大的变故产生。苹果怀孕了，而到底谁才是这个孩子的父亲成了林东与安坤赌博的筹码，四人签订协议，如果是林东的骨肉，他将给二人十二万元的补偿费，而如果是安坤的，则双方互不相欠……</p><p>◎获奖情况</p><p>　　第57届柏林国际电影节 (2007)</p><p>　　金熊奖 最佳影片(提名) 李玉</p><p>　　第8届华语电影传媒大奖 (2008)</p><p>　　最佳男主角(提名) 梁家辉</p></blockquote><p>《苹果》是一部有着两种版本（被剪20分钟）的电影，它充满了争议性，也引发了关注度。</p><p>它是导演李玉第一次与范冰冰的合作，之后便一发不可收拾。</p><p>它原本可以改变大众对于范冰冰毫无演技的误解，却因为影片被禁被剪几乎消失于我们的视野。</p><p>它是一部神秘的电影，原名《迷失北京》，却因为大家心照不宣的原因被迫改名为《苹果》。</p><p>坦言说，《迷失北京》更贴近影片的原意，而《苹果》虽然题不对文，却给人以更多的遐想。</p><p>它究竟是怎样的一只“苹果”呢？</p><h2 id="1、一只青苹果"><a href="#1、一只青苹果" class="headerlink" title="1、一只青苹果"></a>1、一只青苹果</h2><p>有谁是冲着范冰冰与佟大为的屁股来观看本片的？实话实说，我是。</p><p>能看到他俩的屁股，这绝对是第一次，说不定也是最后一次。</p><p>2007年，范冰冰的屁股是圆润的，佟大为的屁股是紧致的；但他们的演技却是青涩而不为人知的。</p><p>2007年以前，范冰冰能让我们记得住的角色，几乎都集中在电视剧领域，唯一能让影迷有所印象的大银幕角色恐怕就只剩《手机》里的武月了。而自从与导演李玉合作，《苹果》《观音山》《二次曝光》《万物生长》等一系列电影让我们看到了范冰冰在文艺片中的另一面。李玉似乎激发出范冰冰女性性格中屈辱、懦弱、独立、坚强等各个层次的表现力，让我们看到范冰冰演技的丰富性与内在潜质。佟大为同样也是如此，一贯傻里傻气的银幕形象似乎给他套上了枷锁，而在《苹果》里的渣男人设却让他表现出一股少有的无赖与戾气，颇为难得。这便是《苹果》的可取之处，一对青春气息的屁股，以及那充满青涩却潜藏爆发力的演技雏形。</p><h2 id="2、一只毒苹果"><a href="#2、一只毒苹果" class="headerlink" title="2、一只毒苹果"></a>2、一只毒苹果</h2><p>有谁是冲着范冰冰与佟大为的屁股来观看本片的？很多观众也许都是。</p><p>影片开始不久，范冰冰饰演的刘苹果与佟大为饰演的安坤便在出租房那狭小的浴室里上演了这春光毕露的一幕。</p><p>两人都是进城打工一族，刘苹果在洗脚城上班，安坤给高楼擦外墙玻璃。一天，洗脚城老板林东（梁家辉饰）趁刘苹果酒醉强奸了她，安坤恰巧看到了这一幕。追打林东未果的安坤没本事也没精力去打官司告林东，于是向林索赔两万块，却被傲慢的林拒绝。</p><p>不久刘苹果怀孕了，却不知这孩子到底是安坤的还是林东的。安坤以此向林开价。林与其妻无法生育，求子心切，提出用10万块买下这孩子，前提是出生时血型鉴定是他亲生的。一个畸形的临时家庭关系就此形成……而这个孩子降生后血型的鉴定与归属则变成了一出真实而残忍的闹剧。</p><p>故事一波三折，却也透着一股真实劲儿。它讲述了一群人（包括穷人与富人）因为欲望与金钱迷失在北京这座超大城市的故事。故事中的每个人从事着这个城市里并不起眼的工作，真实存在于我们这个世界。</p><p>他们的遭遇如果分段来看，似乎也经常能出现在浩如烟海不停更新的社会法制新闻里。但如果完整的串联起来，还是足够狗血并吸引眼球的。这便是《苹果》作为一部电影能支撑观众继续看下去的理由，真实性与离奇性相交织。但它也像很多热点事件一样，仅仅只能激起不明真相群众一时的好奇心，却无法引发长久的讨论与思辨。</p><p>为什么？因为它无法引起我们的共鸣。</p><p>整个故事以桃色事件作为开篇噱头，以亲子鉴定作为最后卖点，对于大众来说，强奸、通奸、渣男、卖惨与苦情是这出知音体故事的关键词，作为茶余饭后的谈资勉强可以。</p><p>然而李玉并不是一个仅仅只想搏大众眼球的庸俗片导演，她想通过影像表达小人物之于命运的不可控，以及蝼蚁们生活在大城市之中的迷茫感，也包括外来务工人员对于北京这座首善之区的疏离感。他们很容易在这座城市找到工作，却很难融入它并获得它的认同与尊重，这也许正是《迷失北京》的真实含义。</p><p>这种真实性对于旁观者具有很强的冲击力，也似乎可以引发观众是否真正“旁观者清”的代入式自我拷问。我们是否也各自迷失在自己打拼的城市里呢？</p><p>很遗憾，这是导演的一厢情愿。我们并没有被这个真实与荒谬共存的故事所打动，它很社会，却离我们的真实生活很远。</p><p>我们中的大部分人也有缺钱的时候，却很少有人想到会去出卖自己的爱人与子女。即便是蝼蚁般的生活，也有着道德底线与基本的尊严。</p><p>导演想用极致的方式表达人性中的黑暗与邪恶，这是真实的，但这毕竟是少数。我们对待少数社会热点事件的惯有态度是猎奇、同情，而非情感上的共鸣，也就更谈不上对整个社会的反思与讨论了。</p><p>“全员皆恶”的故事在电影里屡见不鲜，性本恶的主题从未在银幕上缺失过，然而一味的求“恶”并不是每次都能引发我们对“善”的重拾。</p><p>《苹果》没能引发共鸣，也没能让我看到一丝丝的善良，它的“恶”让我感到一阵阵的寒意与恶心，观影极度不适。纵然有着片始那一对圆润与紧致的屁股，也无法消解整部电影看下来后我心中的郁结。</p><p>也许导演会说，这样的观感恰是她想要的结果。她就是想让观众通过放大镜窥视人性中的丑陋而产生厌恶感，在脑海里铭记它，思考它的成因，进而鞭挞社会的麻木不仁。然</p><p>而我要说的是，你失败了。</p><p>观众只记住了那一对屁股。</p><p>对于丑陋的人性，我们习以为常，如果不在故事里闪烁一星人性的光辉与善良，那就只会加速我们的麻木与厌倦。</p><p>这，对于观众或是社会，都毫无裨益。</p><p>观众并不是神，无法完全参透影片的实质与内涵。</p><p>这口锅赖不得这届观众，只能说导演还比较青涩，尚未至《观音山》的成熟；又或者只能怪片始的那一对屁股太耀眼了。</p><h2 id="3、一只金苹果"><a href="#3、一只金苹果" class="headerlink" title="3、一只金苹果"></a>3、一只金苹果</h2><p>很凑巧，古希腊神话里有关“金苹果”的故事总带着些人性的丑恶，尽管主角们是神。</p><p>三位女神为了争夺金苹果无所不用其极，将各种欲望作为诱饵摆在人类的面前。在另外一个故事里，大力神赫拉克勒斯为了取得巨龙看守下的金苹果，也曾欺骗过为他冒险的阿特拉斯。两个故事都告诉我们，即便是神，为了夺取金苹果，也会不择手段。</p><p>神亦如此，何况是人呢？</p><p>欧洲三大影展的奖项，就像金苹果一样诱惑着我们的导演。</p><p>为了夺取它，一战成名，很多人也会用上手段。影片的结尾，范冰冰饰演的刘苹果抱着孩子悄悄的离开了林家，一个典型的文艺片开放式结局，这也是冲奖影片所惯用的。</p><p>然而除了这个引人遐想的结局之外，《苹果》还用上了哪些冲奖手段呢？</p><p>我们不能恶意揣测导演最初的片名《迷失北京》是在搏西方媒体的眼球，毕竟《迷失东京》在前，这个也就是个小幽默或者擦边球。</p><p>然而，心知肚明却故意而为之，有些装傻充愣的嫌疑。</p><p>开场的几段激情戏，摆明在国内会被剪，这是常识，傻子都懂。</p><p>冒险而为之，像娄烨一样兵行险着，想学贾樟柯墙外开花墙外香。这一定会被定性为搏外媒同情、卖惨，就算真能在影展上捞个同情奖，回来也会被禁上几年，值得么？</p><p>这一只只金苹果的诱惑真的值得我们的导演去以身涉险么？</p><p>而诱导之下的投其所好与少部分畸形桥段真的是影片创作时的初心么？</p><p>金苹果很可贵，很诱人，但不能因为它而急功近利。</p><p>有着莫妮卡•贝鲁奇的大尺度演出，足够创新、足够暴力与情色的《不可撤销》在网络上号称“禁片”，拥有下载量巨大的声望。但它并未成为观众与评委心中的经典，充其量不过是一次失败的实验性电影。</p><p>单纯靠黄暴的视觉冲击去博取奖项已经是过去时了。</p><p>有谁是冲着范冰冰与佟大为的屁股来观看本片的？欧洲三大影展的评委们肯定不是。</p><p>所以《苹果》名落孙山，输给《图雅的婚事》也是必然了。</p><p>不是每个导演都会成为贾樟柯，因为贾樟柯并不是靠卖惨卖黑暗来获取评委的心。他用类纪录片的方式记录着大变革时代的中国，这是极其有价值的。</p><p>《苹果》在试图模仿，却误以为只靠那抖动镜头中的长安街或是胡同里的脏水就能称作为时代记录。无法引发观众共鸣与时代整体回忆的镜头是无效的，也非不可或缺，滥用只会造成观影不适。</p><p>又比如，贾樟柯在《小武》里塑造的小武是鲜活的，我们都可以从这个小偷身上看到自己或是他人的影子，产生共鸣，进而同情这个小人物。但我们很难从《苹果》中的人物里看到自己，充其量只是猎奇，甚至难以同情他们，只会产生“可怜之人必有可恨之处”的厌恶感。</p><p>这是一个悲剧，创作者没能预料的悲剧。</p><p>摘下金苹果有难度，不上手段也许真的很难，但即便是用尽手段也不一定能得逞。</p><p>退一步，海阔天空。</p><p>放下成名的执念，也许另一只金苹果就在眼前……</p><h2 id="4、一只烂苹果"><a href="#4、一只烂苹果" class="headerlink" title="4、一只烂苹果"></a>4、一只烂苹果</h2><p>有谁是冲着范冰冰与佟大为的屁股来观看本片的？大部分网络下载的人肯定是。</p><p>112分钟被剪成92分钟，被删掉的20分钟的镜头里都有什么？想想还是挺期待的，用脚指头都能想到肯定有“儿童不宜”的镜头。然而大部分下载客在看完开篇的几段被剪戏后，就快速拉片甚至直接关闭播放器了。</p><p>为什么会这样？</p><p>因为《苹果》名声在外，它被打上了国内情色片的罕见标签，而非现实题材影片的佳作。</p><p>无耻的发行商甚至将“放纵的肉体，迷失的心灵”这种名不副实却又异常吸睛的宣传语印上了海报。</p><p>还有很多居心不良的家伙将片中刘苹果在产房生孩子时的剧照当做了黄图来吸引观众，着实有些出乎意料。</p><p>创作理念的偏差导致了供需错位的尴尬，《苹果》的情色片定性是一种无心插柳柳成荫的滑稽，也是创作者的悲哀与教训。</p><p>反观被剪20分钟的上映版，实属烂苹果一只。</p><p>原本就乏味，相对重口的那部分还被人削掉了。观众把它当纯社会法制片来看，就更显寡淡而无趣。</p><p>《苹果》成为了一次教科书般的失败案例。没捞着名，也没赚到利，被“正义人士”千夫所指，还被网络里的“猥琐男”们当作虎头蛇尾的黄片来看待。</p><p>李玉吸取了教训，其后的电影开始蒸蒸日上。</p><p>要说《苹果》究竟为我们留下了些什么？</p><p>我都快说烦了，没错，就是那一对……</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202206220337208.png" alt="image-20220622033647831"></p><p><img src="https://cdn.zhaifanhua.com/blog/img/202206220337210.png" alt="image-20220622033450405"></p>]]></content>
      
      
      <categories>
          
          <category> 观后感 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 观后感 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue学习笔记3-使用Vite安装项目</title>
      <link href="/2022/06/12/e5227a9caa42/"/>
      <url>/2022/06/12/e5227a9caa42/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue学习笔记3-使用Vite安装项目"><a href="#Vue学习笔记3-使用Vite安装项目" class="headerlink" title="Vue学习笔记3-使用Vite安装项目"></a>Vue学习笔记3-使用Vite安装项目</h1><h2 id="一、Vite"><a href="#一、Vite" class="headerlink" title="一、Vite"></a>一、Vite</h2><p><a href="https://cn.vitejs.dev/">Vite</a> 是一个 web 开发构建工具，由于其原生 ES 模块导入方式，可以实现闪电般的冷服务器启动。</p><p>通过在终端中运行以下命令，可以使用 Vite 快速构建 Vue 项目。</p><p>使用 npm：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm 6.x</span></span><br><span class="line">$ npm init vite@latest &lt;project-name&gt; --template vue</span><br><span class="line"></span><br><span class="line"><span class="comment"># npm 7+，需要加上额外的双短横线</span></span><br><span class="line">$ npm init vite@latest &lt;project-name&gt; -- --template vue</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line">$ npm install</span><br><span class="line">$ npm run dev</span><br></pre></td></tr></table></figure><p>或者 yarn：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ yarn create vite &lt;project-name&gt; --template vue</span><br><span class="line">$ <span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line">$ yarn</span><br><span class="line">$ yarn dev</span><br></pre></td></tr></table></figure><p>或者 pnpm:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ pnpm create vite &lt;project-name&gt; -- --template vue</span><br><span class="line">$ <span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line">$ pnpm install</span><br><span class="line">$ pnpm dev</span><br></pre></td></tr></table></figure><h2 id="二、安装"><a href="#二、安装" class="headerlink" title="二、安装"></a>二、安装</h2><blockquote><p>前提，先安装nodejs,安装完成后就自动安装了npm，若运行时出现 <code>【不是内部或外部命令，也不是可运行的程序或批处理文】</code>的报错，原因是windows执行策略不允许不安全的脚本运行,可以用以下方式解决。</p></blockquote><p>脚本运行权限政策有以下几种：</p><blockquote><p>Restricted      ——默认的设置， 不允许任何脚本运行<br>AllSigned       ——只能运行经过数字证书签名的脚本<br>RemoteSigned    ——运行本地的脚本不需要数字签名，但是运行从网络上下载的script就必须要有数字签名<br>Unrestricted    ——允许所有的脚本运行</p></blockquote><p>在开始菜单里找到Windows PowerShell，并以管理员身份运行</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301396.png" alt="image-20220612020737325"></p><p>我们可以通过以下命令查看我们计算机的所有策略：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ExecutionPolicy -List</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301398.png" alt="image-20220612022322629"></p><p>可以发现本地和用户都是默认策略，此策略不允许任何脚本运行。我们可以通过以下命令查看我们计算机的用户策略：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ExecutionPolicy</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301399.png" alt="image-20220612022645061"></p><p>所以我们需要允许本地和用户运行签名脚本，用以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Set-ExecutionPolicy RemoteSigned CurrentUser</span><br><span class="line">Set-ExecutionPolicy RemoteSigned LocalMachine</span><br><span class="line">Get-ExecutionPolicy -List</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301400.png" alt="image-20220612022915812"></p><p>这时，表明策略更改成功，就可以运行脚本了。</p><h3 id="1-npm方式"><a href="#1-npm方式" class="headerlink" title="1.npm方式"></a>1.npm方式</h3><h4 id="1-1-切换镜像"><a href="#1-1-切换镜像" class="headerlink" title="1.1 切换镜像"></a>1.1 切换镜像</h4><p>当下，如果没有网速低，那又何谈幸福！使用以下命令，让下载速度快起来。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><blockquote><p>不建议使用cnpm，因为安装依赖或使用别的项目可能会出现概率性报错。</p></blockquote><h4 id="1-2-安装项目"><a href="#1-2-安装项目" class="headerlink" title="1.2 安装项目"></a>1.2 安装项目</h4><p>初始化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vite@latest demo-npm -- --template vue</span><br></pre></td></tr></table></figure><p>进入目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd .\demo-npm\</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301401.png" alt="image-20220612023636302"></p><p>运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>出现以下提示，表示运行成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vite v2.9.12 dev server running at:</span><br><span class="line"></span><br><span class="line">&gt; Local: http://localhost:3000/</span><br><span class="line">&gt; Network: use `--host` to expose</span><br><span class="line"></span><br><span class="line">ready in 226ms.</span><br></pre></td></tr></table></figure><p>在浏览器打开</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301402.png" alt="image-20220612010505096"></p><p>项目树结构</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Demo</span><br><span class="line">└─ demo-npm</span><br><span class="line">  ├─ node_modules             --项目依赖文件夹</span><br><span class="line">  │  └─ .bin</span><br><span class="line">  │  └─ vue</span><br><span class="line">  │  └─ ……</span><br><span class="line">  ├─ public                   --静态资源文件夹（如图标和不支持 JavaScript 情况时的页面等）</span><br><span class="line">  │  └─ favicon.ico</span><br><span class="line">  ├─ src                      --源代码文件夹</span><br><span class="line">  │  ├─ App.vue                  --项目根组件文件（所有页面都是在该组件下进行切换的）</span><br><span class="line">  │  ├─ assets                   --资源文件夹（存放 css，img等资源）</span><br><span class="line">  │  │  └─ logo.png</span><br><span class="line">  │  ├─ components               --公共组件文件夹</span><br><span class="line">  │  │  └─ HelloWorld.vue</span><br><span class="line">  │  └─ main.js                  --项目入口文件（作用是初始化 vue 实例，并引入所需要的插件）</span><br><span class="line">  ├─ index.html               --入口页面文件</span><br><span class="line">  ├─ package-lock.json        --依赖关系树文件</span><br><span class="line">  ├─ package.json             --项目依赖配置文件（比如 vuex，element-UI）</span><br><span class="line">  ├─ vite.config.js           --Vite配置文件</span><br><span class="line">  └─ README.md                --项目介绍文件</span><br></pre></td></tr></table></figure><h3 id="2-yarn方式"><a href="#2-yarn方式" class="headerlink" title="2.yarn方式"></a>2.yarn方式</h3><blockquote><p>Yarn是facebook发布的一款取代npm的包管理工具。</p><p>yarn的特点：<br>速度超快。<br>Yarn 缓存了每个下载过的包，所以再次使用时无需重复下载。 同时利用并行下载以最大化资源利用率，因此安装速度更快。<br>超级安全。<br>在执行代码之前，Yarn 会通过算法校验每个安装包的完整性。<br>超级可靠。<br>使用详细、简洁的锁文件格式和明确的安装算法，Yarn 能够保证在不同系统上无差异的工作。</p></blockquote><h4 id="2-1-安装yarn"><a href="#2-1-安装yarn" class="headerlink" title="2.1 安装yarn"></a>2.1 安装yarn</h4><p>安装yan，用以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install yarn --location=global</span><br></pre></td></tr></table></figure><p>查看版本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn --version</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301403.png" alt="image-20220612024630371"></p><h4 id="2-2-安装项目"><a href="#2-2-安装项目" class="headerlink" title="2.2 安装项目"></a>2.2 安装项目</h4><p>初始化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn create vite demo-yarn --template vue</span><br></pre></td></tr></table></figure><p>进入目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd .\demo-yarn\</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn</span><br></pre></td></tr></table></figure><p>运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn dev</span><br></pre></td></tr></table></figure><p>在浏览器打开</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120301402.png" alt="image-20220612010505096"></p><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><a href="https://github.com/zhaifanhua/Learning-Vue/tree/main/3.Install%20with%20Vite">查看源码</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP状态码大全</title>
      <link href="/2022/06/12/cd45c2185b83/"/>
      <url>/2022/06/12/cd45c2185b83/</url>
      
        <content type="html"><![CDATA[<h1 id="HTTP状态码大全-常见-HttpStatusCode-含义查询"><a href="#HTTP状态码大全-常见-HttpStatusCode-含义查询" class="headerlink" title="HTTP状态码大全(常见 HttpStatusCode 含义查询)"></a>HTTP状态码大全(常见 HttpStatusCode 含义查询)</h1><hr><p>HTTP状态码，即HTTP协议状态码，是我们访问网站时会遇到的，服务器端返回的Http响应码，不同的数字分别代表着不同的响应状态。我们在做SEO或做网页开发过程中需要了解5类比较重要的HTTP状态码，可以根据请求响应代码检查服务器及程序是否正常，判断网页处于什么工作状态。我们就需要了解不同的状态码分别是什么含义。</p><p><strong>下面我们列出常见五类HTTP状态码和它的详解说明：</strong></p><h3 id="1、-HTTP-Status-Code-1xx-请求信息"><a href="#1、-HTTP-Status-Code-1xx-请求信息" class="headerlink" title="1、 HTTP Status Code 1xx 请求信息"></a>1、 HTTP Status Code 1xx 请求信息</h3><p>这一组状态码表明这是一个临时性响应。此响应仅由状态行和可选的HTTP头组成，以一个空行结尾。由于HTTP／1.0未定义任何1xx状态码，所以不要向HTTP／1.0客户端发送1xx响应。</p><table><thead><tr><th align="left">Http状态码</th><th align="left">Http Status Code</th><th align="left">Http状态码含义中文说明</th></tr></thead><tbody><tr><td align="left"><strong>100</strong></td><td align="left">100 Continue100</td><td align="left">请继续请求</td></tr><tr><td align="left"><strong>101</strong></td><td align="left">101 Switching Protocols101</td><td align="left">请切换协议</td></tr><tr><td align="left"><strong>102</strong></td><td align="left">102 Processing102</td><td align="left">将继续执行请求</td></tr></tbody></table><h3 id="2、-HTTP-Status-Code-2xx-成功状态"><a href="#2、-HTTP-Status-Code-2xx-成功状态" class="headerlink" title="2、 HTTP Status Code 2xx 成功状态"></a>2、 HTTP Status Code 2xx 成功状态</h3><p>这一组状态码表明客户端的请求已经被服务器端成功接收并正确解析。</p><table><thead><tr><th align="left">Http状态码</th><th align="left">Http Status Code</th><th align="left">Http状态码含义中文说明</th></tr></thead><tbody><tr><td align="left"><strong>200</strong></td><td align="left">200 OK200</td><td align="left">请求成功</td></tr><tr><td align="left"><strong>201</strong></td><td align="left">201 Created201</td><td align="left">请求已被接受，等待资源响应</td></tr><tr><td align="left"><strong>202</strong></td><td align="left">202 Accepted202</td><td align="left">请求已被接受，但尚未处理</td></tr><tr><td align="left"><strong>203</strong></td><td align="left">203 Non-Authoritative Information203</td><td align="left">请求已成功处理，结果来自第三方拷贝</td></tr><tr><td align="left"><strong>204</strong></td><td align="left">204 No Content204</td><td align="left">请求已成功处理，但无返回内容</td></tr><tr><td align="left"><strong>205</strong></td><td align="left">205 Reset Content205</td><td align="left">请求已成功处理，但需重置内容</td></tr><tr><td align="left"><strong>206</strong></td><td align="left">206 Partial Content206</td><td align="left">请求已成功处理，但仅返回了部分内容</td></tr><tr><td align="left"><strong>207</strong></td><td align="left">207 Multi-Status207</td><td align="left">请求已成功处理，返回了多个状态的XML消息</td></tr><tr><td align="left"><strong>208</strong></td><td align="left">208 Already Reported208</td><td align="left">响应已发送</td></tr><tr><td align="left"><strong>226</strong></td><td align="left">226 IM Used226</td><td align="left">已完成响应</td></tr></tbody></table><h3 id="3、-HTTP-Status-Code-3xx-重定向状态"><a href="#3、-HTTP-Status-Code-3xx-重定向状态" class="headerlink" title="3、 HTTP Status Code 3xx 重定向状态"></a>3、 HTTP Status Code 3xx 重定向状态</h3><p>这一组状态码表示客户端需要采取更进一步的行动来完成请求。通常，这些状态码用来重定向，后续的请求地址（重定向目标）在本次响应的Location域中指明。</p><table><thead><tr><th align="left">Http状态码</th><th align="left">Http Status Code</th><th align="left">Http状态码含义中文说明</th></tr></thead><tbody><tr><td align="left"><strong>300</strong></td><td align="left">300 Multiple Choices300</td><td align="left">返回多条重定向供选择</td></tr><tr><td align="left"><strong>301</strong></td><td align="left">301 Moved Permanently301</td><td align="left">永久重定向</td></tr><tr><td align="left"><strong>302</strong></td><td align="left">302 Found302</td><td align="left">临时重定向</td></tr><tr><td align="left"><strong>303</strong></td><td align="left">303 See Other303</td><td align="left">当前请求的资源在其它地址</td></tr><tr><td align="left"><strong>304</strong></td><td align="left">304 Not Modified304</td><td align="left">请求资源与本地缓存相同，未修改</td></tr><tr><td align="left"><strong>305</strong></td><td align="left">305 Use Proxy305</td><td align="left">必须通过代理访问</td></tr><tr><td align="left"><strong>306</strong></td><td align="left">306 (已废弃Switch Proxy306</td><td align="left">(已废弃请切换代理)</td></tr><tr><td align="left"><strong>307</strong></td><td align="left">307 Temporary Redirect307</td><td align="left">临时重定向，同302</td></tr><tr><td align="left"><strong>308</strong></td><td align="left">308 Permanent Redirect308</td><td align="left">永久重定向，且禁止改变http方法</td></tr></tbody></table><h3 id="4、-HTTP-Status-Code-4xx-客户端错误"><a href="#4、-HTTP-Status-Code-4xx-客户端错误" class="headerlink" title="4、 HTTP Status Code 4xx 客户端错误"></a>4、 HTTP Status Code 4xx 客户端错误</h3><p>这一组状态码表示客户端的请求存在错误，导致服务器无法处理。除非响应的是一个HEAD请求，否则服务器就应该返回一个解释当前错误状况的实体，以及这是临时的还是永久性的状况。这些状态码适用于任何请求方法。浏览器应当向用户显示任何包含在此类错误响应中的实体内容。</p><table><thead><tr><th align="left">Http状态码</th><th align="left">Http Status Code</th><th align="left">Http状态码含义中文说明</th></tr></thead><tbody><tr><td align="left"><strong>400</strong></td><td align="left">400 Bad Request400</td><td align="left">请求错误，通常是访问的域名未绑定引起</td></tr><tr><td align="left"><strong>401</strong></td><td align="left">401 Unauthorized401</td><td align="left">需要身份认证验证</td></tr><tr><td align="left"><strong>402</strong></td><td align="left">402 Payment Required</td><td align="left">-</td></tr><tr><td align="left"><strong>403</strong></td><td align="left">403 Forbidden403</td><td align="left">禁止访问</td></tr><tr><td align="left"><strong>404</strong></td><td align="left">404 Not Found404</td><td align="left">请求的内容未找到或已删除</td></tr><tr><td align="left"><strong>405</strong></td><td align="left">405 Method Not Allowed405</td><td align="left">不允许的请求方法</td></tr><tr><td align="left"><strong>406</strong></td><td align="left">406 Not Acceptable406</td><td align="left">无法响应，因资源无法满足客户端条件</td></tr><tr><td align="left"><strong>407</strong></td><td align="left">407 Proxy Authentication Required407</td><td align="left">要求通过代理的身份认证</td></tr><tr><td align="left"><strong>408</strong></td><td align="left">408 Request Timeout408</td><td align="left">请求超时</td></tr><tr><td align="left"><strong>409</strong></td><td align="left">409 Conflict409</td><td align="left">存在冲突</td></tr><tr><td align="left"><strong>410</strong></td><td align="left">410 Gone410</td><td align="left">资源已经不存在(过去存在)</td></tr><tr><td align="left"><strong>411</strong></td><td align="left">411 Length Required411</td><td align="left">无法处理该请求</td></tr><tr><td align="left"><strong>412</strong></td><td align="left">412 Precondition Failed412</td><td align="left">请求条件错误</td></tr><tr><td align="left"><strong>413</strong></td><td align="left">413 Payload Too Large413</td><td align="left">请求的实体过大</td></tr><tr><td align="left"><strong>414</strong></td><td align="left">414 Request-URI Too Long414</td><td align="left">请求的URI过长</td></tr><tr><td align="left"><strong>415</strong></td><td align="left">415 Unsupported Media Type415</td><td align="left">无法处理的媒体格式</td></tr><tr><td align="left"><strong>416</strong></td><td align="left">416 Range Not Satisfiable416</td><td align="left">请求的范围无效</td></tr><tr><td align="left"><strong>417</strong></td><td align="left">417 Expectation Failed417</td><td align="left">无法满足的Expect</td></tr><tr><td align="left"><strong>418</strong></td><td align="left">418 I’m a teapot418</td><td align="left">愚人节笑话</td></tr><tr><td align="left"><strong>421</strong></td><td align="left">421 There are too many connections from your internet address421</td><td align="left">连接数超限</td></tr><tr><td align="left"><strong>422</strong></td><td align="left">422 Unprocessable Entity422</td><td align="left">请求的语义错误</td></tr><tr><td align="left"><strong>423</strong></td><td align="left">423 Locked423</td><td align="left">当前资源被锁定</td></tr><tr><td align="left"><strong>424</strong></td><td align="left">424 Failed Dependency424</td><td align="left">当前请求失败</td></tr><tr><td align="left"><strong>425</strong></td><td align="left">425 Unordered Collection425</td><td align="left">未知</td></tr><tr><td align="left"><strong>426</strong></td><td align="left">426 Upgrade Required426</td><td align="left">请切换到TLS&#x2F;1.0</td></tr><tr><td align="left"><strong>428</strong></td><td align="left">428 Precondition Required428</td><td align="left">请求未带条件</td></tr><tr><td align="left"><strong>429</strong></td><td align="left">429 Too Many Requests429</td><td align="left">并发请求过多</td></tr><tr><td align="left"><strong>431</strong></td><td align="left">431 Request Header Fields Too Large431</td><td align="left">请求头过大</td></tr><tr><td align="left"><strong>449</strong></td><td align="left">449 Retry With449</td><td align="left">请重试</td></tr><tr><td align="left"><strong>451</strong></td><td align="left">451 Unavailable For Legal Reasons451</td><td align="left">访问被拒绝（法律的要求）</td></tr><tr><td align="left"><strong>499</strong></td><td align="left">499 Client Closed Request499</td><td align="left">客户端主动关闭了连接</td></tr></tbody></table><h3 id="5、-HTTP-Status-Code-5xx-服务器错误状态"><a href="#5、-HTTP-Status-Code-5xx-服务器错误状态" class="headerlink" title="5、 HTTP Status Code 5xx 服务器错误状态"></a>5、 HTTP Status Code 5xx 服务器错误状态</h3><p>这一组状态码说明服务器在处理请求的过程中有错误或者异常状态发生，也有可能是服务器意识到以当前的软硬件资源无法完成对请求的处理。除非这是一个HEAD请求，否则服务器应当包含一个解释当前错误状态以及这个状况是临时的还是永久的解释信息实体。浏览器应当向用户展示任何在当前响应中被包含的实体。</p><table><thead><tr><th align="left">Http状态码</th><th align="left">Http Status Code</th><th align="left">Http状态码含义中文说明</th></tr></thead><tbody><tr><td align="left"><strong>500</strong></td><td align="left">500 Internal Server Error500</td><td align="left">服务器端程序错误</td></tr><tr><td align="left"><strong>501</strong></td><td align="left">501 Not Implemented501</td><td align="left">服务器不支持的请求方法</td></tr><tr><td align="left"><strong>502</strong></td><td align="left">502 Bad Gateway502</td><td align="left">网关无响应</td></tr><tr><td align="left"><strong>503</strong></td><td align="left">503 Service Unavailable503</td><td align="left">服务器端临时错误</td></tr><tr><td align="left"><strong>504</strong></td><td align="left">504 Gateway Timeout504</td><td align="left">网关超时</td></tr><tr><td align="left"><strong>505</strong></td><td align="left">505 HTTP Version Not Supported505</td><td align="left">服务器不支持的HTTP版本</td></tr><tr><td align="left"><strong>506</strong></td><td align="left">506 Variant Also Negotiates506</td><td align="left">服务器内部配置错误</td></tr><tr><td align="left"><strong>507</strong></td><td align="left">507 Insufficient Storage507</td><td align="left">服务器无法存储请求</td></tr><tr><td align="left"><strong>508</strong></td><td align="left">508 Loop Detected508</td><td align="left">服务器因死循环而终止操作</td></tr><tr><td align="left"><strong>509</strong></td><td align="left">509 Bandwidth Limit Exceeded509</td><td align="left">服务器带宽限制</td></tr><tr><td align="left"><strong>510</strong></td><td align="left">510 Not Extended510</td><td align="left">获取资源策略未被满足</td></tr><tr><td align="left"><strong>511</strong></td><td align="left">511 Network Authentication Required511</td><td align="left">需验证以许可连接</td></tr><tr><td align="left"><strong>599</strong></td><td align="left">599 Network Connect Timeout Error599</td><td align="left">网络连接超时</td></tr></tbody></table><p>以上即是常见HTTP状态码的分类说明。</p><hr><p>CSharp 对应的 HttpStatusCode 如下：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> HttpStatusCode</span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 100。System.Net.HttpStatusCode.Continue 指示客户端可能继续其请求。</span></span><br><span class="line">        Continue = <span class="number">100</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 101。System.Net.HttpStatusCode.SwitchingProtocols 指示正在更改协议版本或协议。</span></span><br><span class="line">        SwitchingProtocols = <span class="number">101</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 200。System.Net.HttpStatusCode.OK 指示请求成功，且请求的信息包含在响应中。这是最常接收的状态代码。</span></span><br><span class="line">        OK = <span class="number">200</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 201。System.Net.HttpStatusCode.Created 指示请求导致在响应被发送前创建新资源。</span></span><br><span class="line">        Created = <span class="number">201</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 202。System.Net.HttpStatusCode.Accepted 指示请求已被接受做进一步处理。</span></span><br><span class="line">        Accepted = <span class="number">202</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 203。System.Net.HttpStatusCode.NonAuthoritativeInformation 指示返回的元信息来自缓存副本而不是原始服务器，因此可能不正确。</span></span><br><span class="line">        NonAuthoritativeInformation = <span class="number">203</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 204。System.Net.HttpStatusCode.NoContent 指示已成功处理请求并且响应已被设定为无内容。</span></span><br><span class="line">        NoContent = <span class="number">204</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 205。System.Net.HttpStatusCode.ResetContent 指示客户端应重置（或重新加载）当前资源。</span></span><br><span class="line">        ResetContent = <span class="number">205</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 206。System.Net.HttpStatusCode.PartialContent 指示响应是包括字节范围的 GET 请求所请求的部分响应。</span></span><br><span class="line">        PartialContent = <span class="number">206</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 300。System.Net.HttpStatusCode.MultipleChoices 指示请求的信息有多种表示形式。默认操作是将此状态视为重定向，并遵循与此响应关联的</span></span><br><span class="line">        <span class="comment">//     Location 标头的内容。</span></span><br><span class="line">        MultipleChoices = <span class="number">300</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 300。System.Net.HttpStatusCode.Ambiguous 指示请求的信息有多种表示形式。默认操作是将此状态视为重定向，并遵循与此响应关联的</span></span><br><span class="line">        <span class="comment">//     Location 标头的内容。</span></span><br><span class="line">        Ambiguous = <span class="number">300</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 301。System.Net.HttpStatusCode.MovedPermanently 指示请求的信息已移到 Location</span></span><br><span class="line">        <span class="comment">//     头中指定的 URI 处。接收到此状态时的默认操作为遵循与响应关联的 Location 头。</span></span><br><span class="line">        MovedPermanently = <span class="number">301</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 301。System.Net.HttpStatusCode.Moved 指示请求的信息已移到 Location 头中指定的 URI</span></span><br><span class="line">        <span class="comment">//     处。接收到此状态时的默认操作为遵循与响应关联的 Location 头。原始请求方法为 POST 时，重定向的请求将使用 GET 方法。</span></span><br><span class="line">        Moved = <span class="number">301</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 302。System.Net.HttpStatusCode.Found 指示请求的信息位于 Location 头中指定的 URI</span></span><br><span class="line">        <span class="comment">//     处。接收到此状态时的默认操作为遵循与响应关联的 Location 头。原始请求方法为 POST 时，重定向的请求将使用 GET 方法。</span></span><br><span class="line">        Found = <span class="number">302</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 302。System.Net.HttpStatusCode.Redirect 指示请求的信息位于 Location 头中指定的 URI</span></span><br><span class="line">        <span class="comment">//     处。接收到此状态时的默认操作为遵循与响应关联的 Location 头。原始请求方法为 POST 时，重定向的请求将使用 GET 方法。</span></span><br><span class="line">        Redirect = <span class="number">302</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 303。作为 POST 的结果，System.Net.HttpStatusCode.SeeOther 将客户端自动重定向到 Location</span></span><br><span class="line">        <span class="comment">//     头中指定的 URI。用 GET 生成对 Location 标头所指定的资源的请求。</span></span><br><span class="line">        SeeOther = <span class="number">303</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 303。作为 POST 的结果，System.Net.HttpStatusCode.RedirectMethod 将客户端自动重定向到</span></span><br><span class="line">        <span class="comment">//     Location 头中指定的 URI。用 GET 生成对 Location 标头所指定的资源的请求。</span></span><br><span class="line">        RedirectMethod = <span class="number">303</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 304。System.Net.HttpStatusCode.NotModified 指示客户端的缓存副本是最新的。未传输此资源的内容。</span></span><br><span class="line">        NotModified = <span class="number">304</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 305。System.Net.HttpStatusCode.UseProxy 指示请求应使用位于 Location 头中指定的 URI</span></span><br><span class="line">        <span class="comment">//     的代理服务器。</span></span><br><span class="line">        UseProxy = <span class="number">305</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 306。System.Net.HttpStatusCode.Unused 是未完全指定的 HTTP/1.1 规范的建议扩展。</span></span><br><span class="line">        Unused = <span class="number">306</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 307。System.Net.HttpStatusCode.TemporaryRedirect 指示请求信息位于 Location</span></span><br><span class="line">        <span class="comment">//     头中指定的 URI 处。接收到此状态时的默认操作为遵循与响应关联的 Location 头。原始请求方法为 POST 时，重定向的请求还将使用 POST 方法。</span></span><br><span class="line">        TemporaryRedirect = <span class="number">307</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 307。System.Net.HttpStatusCode.RedirectKeepVerb 指示请求信息位于 Location</span></span><br><span class="line">        <span class="comment">//     头中指定的 URI 处。接收到此状态时的默认操作为遵循与响应关联的 Location 头。原始请求方法为 POST 时，重定向的请求还将使用 POST 方法。</span></span><br><span class="line">        RedirectKeepVerb = <span class="number">307</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 400。System.Net.HttpStatusCode.BadRequest 指示服务器未能识别请求。如果没有其他适用的错误，或者不知道准确的错误或错误没有自己的错误代码，则发送</span></span><br><span class="line">        <span class="comment">//     System.Net.HttpStatusCode.BadRequest。</span></span><br><span class="line">        BadRequest = <span class="number">400</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 401。System.Net.HttpStatusCode.Unauthorized 指示请求的资源要求身份验证。WWW-Authenticate</span></span><br><span class="line">        <span class="comment">//     头包含如何执行身份验证的详细信息。</span></span><br><span class="line">        Unauthorized = <span class="number">401</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 402。保留 System.Net.HttpStatusCode.PaymentRequired 以供将来使用。</span></span><br><span class="line">        PaymentRequired = <span class="number">402</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 403。System.Net.HttpStatusCode.Forbidden 指示服务器拒绝满足请求。</span></span><br><span class="line">        Forbidden = <span class="number">403</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 404。System.Net.HttpStatusCode.NotFound 指示请求的资源不在服务器上。</span></span><br><span class="line">        NotFound = <span class="number">404</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 405。System.Net.HttpStatusCode.MethodNotAllowed 指示请求的资源上不允许请求方法（POST</span></span><br><span class="line">        <span class="comment">//     或 GET）。</span></span><br><span class="line">        MethodNotAllowed = <span class="number">405</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 406。System.Net.HttpStatusCode.NotAcceptable 指示客户端已用 Accept 头指示将不接受资源的任何可用表示形式。</span></span><br><span class="line">        NotAcceptable = <span class="number">406</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 407。System.Net.HttpStatusCode.ProxyAuthenticationRequired 指示请求的代理要求身份验证。Proxy-authenticate</span></span><br><span class="line">        <span class="comment">//     头包含如何执行身份验证的详细信息。</span></span><br><span class="line">        ProxyAuthenticationRequired = <span class="number">407</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 408。System.Net.HttpStatusCode.RequestTimeout 指示客户端没有在服务器期望请求的时间内发送请求。</span></span><br><span class="line">        RequestTimeout = <span class="number">408</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 409。System.Net.HttpStatusCode.Conflict 指示由于服务器上的冲突而未能执行请求。</span></span><br><span class="line">        Conflict = <span class="number">409</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 410。System.Net.HttpStatusCode.Gone 指示请求的资源不再可用。</span></span><br><span class="line">        Gone = <span class="number">410</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 411。System.Net.HttpStatusCode.LengthRequired 指示缺少必需的 Content-length</span></span><br><span class="line">        <span class="comment">//     头。</span></span><br><span class="line">        LengthRequired = <span class="number">411</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 412。System.Net.HttpStatusCode.PreconditionFailed 指示为此请求设置的条件失败，且无法执行此请求。条件是用条件请求标头（如</span></span><br><span class="line">        <span class="comment">//     If-Match、If-None-Match 或 If-Unmodified-Since）设置的。</span></span><br><span class="line">        PreconditionFailed = <span class="number">412</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 413。System.Net.HttpStatusCode.RequestEntityTooLarge 指示请求太大，服务器无法处理。</span></span><br><span class="line">        RequestEntityTooLarge = <span class="number">413</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 414。System.Net.HttpStatusCode.RequestUriTooLong 指示 URI 太长。</span></span><br><span class="line">        RequestUriTooLong = <span class="number">414</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 415。System.Net.HttpStatusCode.UnsupportedMediaType 指示请求是不支持的类型。</span></span><br><span class="line">        UnsupportedMediaType = <span class="number">415</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 416。System.Net.HttpStatusCode.RequestedRangeNotSatisfiable 指示无法返回从资源请求的数据范围，因为范围的开头在资源的开头之前，或因为范围的结尾在资源的结尾之后。</span></span><br><span class="line">        RequestedRangeNotSatisfiable = <span class="number">416</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 417。System.Net.HttpStatusCode.ExpectationFailed 指示服务器未能符合 Expect</span></span><br><span class="line">        <span class="comment">//     头中给定的预期值。</span></span><br><span class="line">        ExpectationFailed = <span class="number">417</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 426。System.Net.HttpStatusCode.UpgradeRequired 指示客户端应切换为诸如 TLS/1.0</span></span><br><span class="line">        <span class="comment">//     之类的其他协议。</span></span><br><span class="line">        UpgradeRequired = <span class="number">426</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 500。System.Net.HttpStatusCode.InternalServerError 指示服务器上发生了一般错误。</span></span><br><span class="line">        InternalServerError = <span class="number">500</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 501。System.Net.HttpStatusCode.NotImplemented 指示服务器不支持请求的函数。</span></span><br><span class="line">        NotImplemented = <span class="number">501</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 502。System.Net.HttpStatusCode.BadGateway 指示中间代理服务器从另一代理或原始服务器接收到错误响应。</span></span><br><span class="line">        BadGateway = <span class="number">502</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 503。System.Net.HttpStatusCode.ServiceUnavailable 指示服务器暂时不可用，通常是由于过多加载或维护。</span></span><br><span class="line">        ServiceUnavailable = <span class="number">503</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 504。System.Net.HttpStatusCode.GatewayTimeout 指示中间代理服务器在等待来自另一个代理或原始服务器的响应时已超时。</span></span><br><span class="line">        GatewayTimeout = <span class="number">504</span>,</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 摘要:</span></span><br><span class="line">        <span class="comment">//     等效于 HTTP 状态 505。System.Net.HttpStatusCode.HttpVersionNotSupported 指示服务器不支持请求的</span></span><br><span class="line">        <span class="comment">//     HTTP 版本。</span></span><br><span class="line">        HttpVersionNotSupported = <span class="number">505</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue学习笔记2-安装Vue</title>
      <link href="/2022/06/10/0e04a70f7d80/"/>
      <url>/2022/06/10/0e04a70f7d80/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue学习笔记2-安装Vue"><a href="#Vue学习笔记2-安装Vue" class="headerlink" title="Vue学习笔记2-安装Vue"></a>Vue学习笔记2-安装Vue</h1><h2 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h2><p>Vue.js 设计的初衷就包括可以被渐进式地采用。这意味着它可以根据需求以多种方式集成到一个项目中。</p><p>将 Vue.js 添加到项目中主要有四种方式：</p><ol><li><p>在页面上以 <a href="https://v3.cn.vuejs.org/guide/installation.html#cdn">CDN 包</a>的形式导入。</p></li><li><p>下载 JavaScript 文件并<a href="https://v3.cn.vuejs.org/guide/installation.html#%E4%B8%8B%E8%BD%BD%E5%B9%B6%E8%87%AA%E6%89%98%E7%AE%A1">自行托管</a>。</p></li><li><p>使用 <a href="https://v3.cn.vuejs.org/guide/installation.html#npm">npm</a> 安装它。</p></li><li><p>使用官方的 <a href="https://v3.cn.vuejs.org/guide/installation.html#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7-cli">CLI</a> 来构建一个项目，它为现代前端工作流程提供了功能齐备的构建设置 (例如，热重载、保存时的提示等等)。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120339969.png" alt="image-20220612033926263"></p></li></ol><h2 id="二、四种方式"><a href="#二、四种方式" class="headerlink" title="二、四种方式"></a>二、四种方式</h2><h3 id="1-CDN包"><a href="#1-CDN包" class="headerlink" title="1.CDN包"></a>1.CDN包</h3><p>对于制作原型或学习，你可以这样使用最新版本：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/vue@next&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>对于生产环境，我们推荐链接到一个明确的版本号和构建文件，以避免新版本造成的不可预期的破坏。</p><h3 id="2-下载JavaScript并自托管"><a href="#2-下载JavaScript并自托管" class="headerlink" title="2.下载JavaScript并自托管"></a>2.下载JavaScript并自托管</h3><p>如果你想避免使用构建工具，但又无法在生产环境使用 CDN，那么你可以下载相关 <code>.js</code> 文件并自行托管在你的服务器上。然后你可以通过 <code>&lt;script&gt;</code> 标签引入，与使用 CDN 的方法类似。</p><p>这些文件可以在 <a href="https://unpkg.com/browse/vue@next/dist/">unpkg</a> 或者 <a href="https://cdn.jsdelivr.net/npm/vue@next/dist/">jsDelivr</a> 这些 CDN 上浏览和下载。各种不同文件将在<a href="https://v3.cn.vuejs.org/guide/installation.html#%E5%AF%B9%E4%B8%8D%E5%90%8C%E6%9E%84%E5%BB%BA%E7%89%88%E6%9C%AC%E7%9A%84%E8%A7%A3%E9%87%8A">以后解释</a>，但你通常需要同时下载开发环境构建版本以及生产环境构建版本。</p><h3 id="3-npm"><a href="#3-npm" class="headerlink" title="3.npm"></a>3.npm</h3><p>在用 Vue 构建大型应用时推荐使用 npm 安装[<a href="https://v3.cn.vuejs.org/guide/installation.html#footnote-1">1]</a> 。npm 能很好地和诸如 <a href="https://webpack.js.org/">webpack</a> 或 <a href="https://rollupjs.org/">Rollup</a> 模块打包器配合使用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最新稳定版</span></span><br><span class="line">$ npm install vue@next</span><br></pre></td></tr></table></figure><p>Vue 还提供了编写<a href="https://v3.cn.vuejs.org/guide/single-file-component.html">单文件组件</a>的配套工具。如果你想使用单文件组件，那么你还需要安装 <code>@vue/compiler-sfc</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -D @vue/compiler-sfc</span><br></pre></td></tr></table></figure><p>如果你是从 Vue 2 过渡而来的，请注意 <code>@vue/compiler-sfc</code> 替换掉了 <code>vue-template-compiler</code></p><p>除了 <code>@vue/compiler-sfc</code> 之外，你还需要为已选择的打包工具选择一个配套的单文件组件 loader 或 plugin。更多信息请查阅<a href="https://v3.cn.vuejs.org/guide/single-file-component.html">单文件组件文档</a>。</p><p>大多数情况下，我们更倾向于使用 Vue CLI 来创建一个配置最小化的 webpack 构建版本。</p><h3 id="4-命令行工具-CLI"><a href="#4-命令行工具-CLI" class="headerlink" title="4.命令行工具 (CLI)"></a>4.命令行工具 (CLI)</h3><p>Vue 提供了一个<a href="https://cli.vuejs.org/zh/">官方的 CLI</a>，为单页面应用 (SPA) 快速搭建繁杂的脚手架。它为现代前端工作流提供了功能齐备的构建设置。只需要几分钟的时间就可以运行起来并带有热重载、保存时 lint 校验，以及生产环境可用的构建版本。更多详情可查阅 <a href="https://cli.vuejs.org/zh/">Vue CLI 的文档</a>。</p><p>TIP</p><p>CLI 工具假定用户对 Node.js 和相关构建工具有一定程度的了解。如果你是新手，我们强烈建议先在不用构建工具的情况下通读<a href="https://v3.cn.vuejs.org/guide/introduction.html">指南</a>，在熟悉 Vue 本身之后再使用 CLI。</p><p>对于 Vue 3，你应该使用 <code>npm</code> 上可用的 Vue CLI v4.5 作为 <code>@vue/cli</code>。要升级，你应该需要全局重新安装最新版本的 <code>@vue/cli</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn global add @vue/cli</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">npm install -g @vue/cli</span><br></pre></td></tr></table></figure><p>然后在 Vue 项目中运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue upgrade --next</span><br></pre></td></tr></table></figure><h2 id="对不同构建版本的解释"><a href="#对不同构建版本的解释" class="headerlink" title="对不同构建版本的解释"></a>对不同构建版本的解释</h2><p>在 <a href="https://cdn.jsdelivr.net/npm/vue@3.0.2/dist/">npm 包的 dist&#x2F; 目录</a>你将会找到很多不同的 Vue.js 构建版本。下面是一个概述，根据不同的使用情况，应该使用哪个 <code>dist</code> 文件：</p><h3 id="使用-CDN-或没有构建工具"><a href="#使用-CDN-或没有构建工具" class="headerlink" title="使用 CDN 或没有构建工具"></a>使用 CDN 或没有构建工具</h3><h4 id="vue-runtime-global-prod-js："><a href="#vue-runtime-global-prod-js：" class="headerlink" title="vue(.runtime).global(.prod).js："></a><code>vue(.runtime).global(.prod).js</code>：</h4><ul><li>若要通过浏览器中的 <code>&lt;script src=&quot;...&quot;&gt;</code> 直接使用，则暴露 Vue 全局。</li><li>浏览器内模板编译：<ul><li><code>vue.global.js</code> 是包含编译器和运行时的“完整”构建版本，因此它支持动态编译模板。</li><li><code>vue.runtime.global.js</code> 只包含运行时，并且需要在构建步骤期间预编译模板。</li></ul></li><li>内联所有 Vue 核心内部包——即：它是一个单独的文件，不依赖于其他文件。这意味着你必须导入此文件和此文件中的所有内容，以确保获得相同的代码实例。</li><li>包含硬编码的 prod&#x2F;dev 分支，并且 prod 构建版本是预先压缩过的。将 <code>*.prod.js</code> 文件用于生产环境。</li></ul><p>提示</p><p>全局打包不是 <a href="https://github.com/umdjs/umd">UMD</a> 构建的，它们被打包成 <a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFEs</a>，并且仅用于通过 <code>&lt;script src=&quot;...&quot;&gt;</code> 直接使用。</p><h4 id="vue-runtime-esm-browser-prod-js："><a href="#vue-runtime-esm-browser-prod-js：" class="headerlink" title="vue(.runtime).esm-browser(.prod).js："></a><code>vue(.runtime).esm-browser(.prod).js</code>：</h4><ul><li>用于通过原生 ES 模块导入使用 (在浏览器中通过 <code>&lt;script type=&quot;module&quot;&gt;</code> 来使用)。</li><li>与全局构建版本共享相同的运行时编译、依赖内联和硬编码的 prod&#x2F;dev 行为。</li></ul><h3 id="使用构建工具"><a href="#使用构建工具" class="headerlink" title="使用构建工具"></a>使用构建工具</h3><h4 id="vue-runtime-esm-bundler-js："><a href="#vue-runtime-esm-bundler-js：" class="headerlink" title="vue(.runtime).esm-bundler.js："></a><code>vue(.runtime).esm-bundler.js</code>：</h4><ul><li><p>用于 <code>webpack</code>，<code>rollup</code> 和 <code>parcel</code> 等构建工具。</p></li><li><p>留下 prod&#x2F;dev 分支的 <code>process.env.NODE_ENV</code> 守卫语句 (必须由构建工具替换)。</p></li><li><p>不提供压缩版本 (打包后与其余代码一起压缩)。</p></li><li><p>import 依赖 (例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@vue/runtime-core</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@vue/runtime-compiler</span><br></pre></td></tr></table></figure><ul><li>导入的依赖项也是 esm bundler 构建版本，并将依次导入其依赖项 (例如：@vue&#x2F;runtime-core imports @vue&#x2F;reactivity)。</li><li>这意味着你<strong>可以</strong>单独安装&#x2F;导入这些依赖，而不会导致这些依赖项的不同实例，但你必须确保它们都为同一版本。</li></ul></li><li><p>浏览器内模板编译：</p><ul><li><code>vue.runtime.esm-bundler.js</code> <strong>(默认)</strong> 仅运行时，并要求所有模板都要预先编译。这是构建工具的默认入口 (通过 <code>package.json</code> 中的 module 字段)，因为在使用构建工具时，模板通常是预先编译的 (例如：在 <code>*.vue</code> 文件中)。</li><li><code>vue.esm-bundler.js</code> 包含运行时编译器。如果你使用了一个构建工具，但仍然想要运行时的模板编译 (例如，DOM 内 模板或通过内联 JavaScript 字符串的模板)，请使用这个文件。你需要配置你的构建工具，将 vue 设置为这个文件。</li></ul></li></ul><h3 id="对于服务端渲染"><a href="#对于服务端渲染" class="headerlink" title="对于服务端渲染"></a>对于服务端渲染</h3><h4 id="vue-cjs-prod-js："><a href="#vue-cjs-prod-js：" class="headerlink" title="vue.cjs(.prod).js："></a><code>vue.cjs(.prod).js</code>：</h4><ul><li>通过 <code>require()</code> 在 Node.js 服务器端渲染使用。</li><li>如果你将应用程序与带有 <code>target: &#39;node&#39;</code> 的 webpack 打包在一起，并正确地将 <code>vue</code> 外部化，则将加载此文件。</li><li>dev&#x2F;prod 文件是预构建的，但是会根据 <code>process.env.NODE_ENV</code> 自动加载相应的文件。</li></ul><h2 id="运行时-编译器-vs-仅运行时"><a href="#运行时-编译器-vs-仅运行时" class="headerlink" title="运行时 + 编译器 vs. 仅运行时"></a>运行时 + 编译器 vs. 仅运行时</h2><p>如果需要在客户端上编译模板 (即：将字符串传递给 template 选项，或者使用元素的 DOM 内 HTML 作为模板挂载到元素)，你将需要编译器，因此需要完整的构建版本：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要编译器</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&#x27;&lt;div&gt;&#123;&#123; hi &#125;&#125;&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不需要</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Vue</span>.<span class="title function_">h</span>(<span class="string">&#x27;div&#x27;</span>, &#123;&#125;, <span class="variable language_">this</span>.<span class="property">hi</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>当使用 <code>vue-loader</code> 时，<code>*.vue</code> 文件中的模板会在构建时预编译为 JavaScript，在最终的捆绑包中并不需要编译器，因此可以只使用运行时构建版本。</p><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><a href="https://github.com/zhaifanhua/Learning-Vue/tree/main/2.Install">查看源码</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL游标(cursor)详细说明及内部循环使用示例</title>
      <link href="/2022/06/10/6956045530ec/"/>
      <url>/2022/06/10/6956045530ec/</url>
      
        <content type="html"><![CDATA[<h1 id="SQL游标-cursor-详细说明及内部循环使用示例"><a href="#SQL游标-cursor-详细说明及内部循环使用示例" class="headerlink" title="SQL游标(cursor)详细说明及内部循环使用示例"></a>SQL游标(cursor)详细说明及内部循环使用示例</h1><h2 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h2><blockquote><p>游标（cursor）是系统为用户开设的一个数据缓冲区，存放SQL语句的执行结果。每个游标区都有一个名字,用户可以用SQL语句逐一从游标中获取记录，并赋给主变量，交由主语言进一步处理。</p></blockquote><p>游标是处理结果集的一种机制，它可以定位到结果集中的某一行，多数据进行读写，也可以移动游标定位到你所需要的行中进行操作数据。一般复杂的存储过程，都会有游标的出现，他的用处主要有：</p><ol><li>定位到结果集中的某一行。</li><li>对当前位置的数据进行读写。</li><li>可以对结果集中的数据单独操作，而不是整行执行相同的操作。</li><li>是面向集合的数据库管理系统和面向行的程序设计之间的桥梁。</li></ol><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><blockquote><p>在数据库中，游标是一个十分重要的概念。游标提供了一种对从表中检索出的数据进行操作的灵活手段，就本质而言，游标实际上是一种能从包括多条数据记录的结果集中每次提取一条记录的机制。游标总是与一条SQL 查询语句相关联因为游标由结果集（可以是零条、一条或由相关的选择语句检索出的多条记录）和结果集中指向特定记录的游标位置组成。当决定对结果集进行处理时，必须声明一个指向该结果集的游标。如果曾经用C 语言写过对文件进行处理的程序，那么游标就像您打开文件所得到的文件句柄一样，只要文件打开成功，该文件句柄就可代表该文件。对于游标而言，其道理是相同的。可见游标能够实现按与传统程序读取平面文件类似的方式处理来自基础表的结果集，从而把表中数据以平面文件的形式呈现给程序。我们知道关系数据库管理系统实质是面向集合的，在MS SQL SERVER 中并没有一种描述表中单一记录的表达形式，除非使用where 子句来限制只有一条记录被选中。因此我们必须借助于游标来进行面向单条记录的数据处理。由此可见，游标允许应用程序对查询语句select 返回的行结果集中每一行进行相同或不同的操作，而不是一次对整个结果集进行同一种操作；它还提供对基于游标位置而对表中数据进行删除或更新的能力；而且，正是游标把作为面向集合的数据库管理系统和面向行的程序设计两者联系起来，使两个数据处理方式能够进行沟通。</p></blockquote><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><blockquote><p>游标速度较慢。</p></blockquote><h2 id="种类"><a href="#种类" class="headerlink" title="种类"></a>种类</h2><blockquote><p>MS SQL SERVER 支持三种类型的游标：Transact_SQL 游标，API服务器游标和客户游标。</p></blockquote><p>（1）<em>Transact_SQL 游标</em></p><p>Transact_SQL 游标是由DECLARE CURSOR 语法定义、主要用在Transact_SQL脚本、存储过程和触发器中。Transact_SQL 游标主要用在服务器上，由从客户端发送给服务器的Transact_SQL 语句或是批处理、存储过程、触发器中的Transact_SQL 进行管理。 Transact_SQL 游标不支持提取数据块或多行数据。</p><p>（2）<em>API游标</em></p><p>API 游标支持在OLE DB， ODBC 以及DB_library 中使用游标函数，主要用在服务器上。每一次客户端应用程序调用API 游标函数，MS SQL SEVER 的OLE DB 提供者、ODBC驱动器或DB_library 的动态链接库（DLL） 都会将这些客户请求传送给服务器以对API游标进行处理。</p><p>（3）<em>客户游标</em></p><p>客户游标主要是当在客户机上缓存结果集时才使用。在客户游标中，有一个缺省的结果集被用来在客户机上缓存整个结果集。客户游标仅支持静态游标而非动态游标。由于服务器游标并不支持所有的Transact-SQL语句或批处理，所以客户游标常常仅被用作服务器游标的辅助。因为在一般情况下，服务器游标能支持绝大多数的游标操作。由于API 游标和Transact-SQL 游标使用在服务器端，所以被称为服务器游标，也被称为后台游标，而客户端游标被称为前台游标。在本章中我们主要讲述服务器（后台）游标。</p><h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><blockquote><p>根据游标检测结果集变化的能力和消耗资源的情况不同，SQL Server支持的API服务器游标分为一下4种：</p></blockquote><ul><li><em>静态游标</em> : 静态游标的结果集，在游标打开的时候建立在TempDB中，不论你在操作游标的时候，如何操作数据库，游标中的数据集都不会变。例如你在游标打开的时候，对游标查询的数据表数据进行增删改，操作之后，静态游标中select的数据依旧显示的为没有操作之前的数据。如果想与操作之后的数据一致，则重新关闭打开游标即可。</li><li><em>动态游标</em> : 这个则与静态游标相对，滚动游标时，动态游标反应结果集中的所有更改。结果集中的行数据值、顺序和成员在每次提取时都会变化。所有用户做的增删改语句通过游标均可见。如果使用API函数或T-SQL Where Current of子句通过游标进行更新，他们将立即可见。在游标外部所做的更新直到提交时才可见。</li><li><em>只进游标</em>：只进游标不支持滚动，只支持从头到尾顺序提取数据，数据库执行增删改，在提取时是可见的，但由于该游标只能进不能向后滚动，所以在行提取后对行做增删改是不可见的。</li><li><em>键集驱动游标</em>：打开键集驱动游标时，该有表中的各个成员身份和顺序是固定的。打开游标时，结果集这些行数据被一组唯一标识符标识，被标识的列做删改时，用户滚动游标是可见的，如果没被标识的列增该，则不可见，比如insert一条数据，是不可见的，若可见，须关闭重新打开游标。 静态游标在滚动时检测不到表数据变化，但消耗的资源相对很少。动态游标在滚动时能检测到所有表数据变化，但消耗的资源却较多。键集驱动游标则处于他们中间，所以根据需求建立适合自己的游标，避免资源浪费。</li></ul><h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><blockquote><p>游标的生命周期包含有五个阶段：声明游标、打开游标、读取游标数据、关闭游标、释放游标。</p></blockquote><h3 id="1，声明游标"><a href="#1，声明游标" class="headerlink" title="1，声明游标"></a>1，声明游标</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> cursor_name <span class="keyword">CURSOR</span> [ <span class="keyword">LOCAL</span> <span class="operator">|</span> <span class="keyword">GLOBAL</span> ] </span><br><span class="line">     [ FORWARD_ONLY <span class="operator">|</span> <span class="keyword">SCROLL</span> ] </span><br><span class="line">     [ <span class="keyword">STATIC</span> <span class="operator">|</span> KEYSET <span class="operator">|</span> <span class="keyword">DYNAMIC</span> <span class="operator">|</span> FAST_FORWARD ] </span><br><span class="line">     [ READ_ONLY <span class="operator">|</span> SCROLL_LOCKS <span class="operator">|</span> OPTIMISTIC ] </span><br><span class="line">     [ TYPE_WARNING ] </span><br><span class="line">     <span class="keyword">FOR</span> select_statement </span><br><span class="line">     [ <span class="keyword">FOR</span> <span class="keyword">UPDATE</span> [ <span class="keyword">OF</span> column_name [ ,...n ] ] ]</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li><p>cursor_name：游标名称。</p></li><li><p>Local：作用域为局部，只在定义它的批处理，存储过程或触发器中有效。</p></li><li><p>Global：作用域为全局，由连接执行的任何存储过程或批处理中，都可以引用该游标。</p></li><li><p>Local | Global: 默认为local。</p></li><li><p>Forward_Only:指定游标智能从第一行滚到最后一行。Fetch Next是唯一支持的提取选项。如果在指定Forward_Only是不指定Static、KeySet、Dynamic关键字，默认为Dynamic游标。如果Forward_Only和Scroll没有指定，Static、KeySet、Dynamic游标默认为Scroll，Fast_Forward默认为Forward_Only</p></li><li><p>Static:静态游标</p></li><li><p>KeySet：键集游标</p></li><li><p>Dynamic：动态游标，不支持Absolute提取选项</p></li><li><p>Fast_Forward：指定启用了性能优化的Forward_Only、Read_Only游标。如果指定啦Scroll或For_Update，就不能指定他啦。</p></li><li><p>Read_Only:不能通过游标对数据进行删改。</p></li><li><p>Scroll_Locks：将行读入游标是，锁定这些行，确保删除或更新一定会成功。如果指定啦Fast_Forward或Static，就不能指定他啦。</p></li><li><p>Optimistic：指定如果行自读入游标以来已得到更新，则通过游标进行的定位更新或定位删除不成功。当将行读入游标时，sqlserver不锁定行，它改用timestamp列值的比较结果来确定行读入游标后是否发生了修改，如果表不行timestamp列，它改用校验和值进行确定。如果已修改改行，则尝试进行的定位更新或删除将失败。如果指定啦Fast_Forward,则不能指定他。</p></li><li><p>Type_Warning:指定将游标从所请求的类型隐式转换为另一种类型时向客户端发送警告信息。</p></li><li><p>For Update[of column_name ,….]:定义游标中可更新的列。</p></li></ul><h3 id="2，声明一个动态游标"><a href="#2，声明一个动态游标" class="headerlink" title="2，声明一个动态游标"></a>2，声明一个动态游标</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> orderNum_02_cursor <span class="keyword">cursor</span> <span class="keyword">scroll</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">select</span> OrderId <span class="keyword">from</span> bigorder <span class="keyword">where</span> orderNum<span class="operator">=</span><span class="string">&#x27;ZEORD003402&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="3，打开游标"><a href="#3，打开游标" class="headerlink" title="3，打开游标"></a>3，打开游标</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--打开游标语法</span></span><br><span class="line"><span class="keyword">open</span> [ <span class="keyword">Global</span> ] cursor_name <span class="operator">|</span> cursor_variable_name</span><br></pre></td></tr></table></figure><p>cursor_name:游标名，cursor_variable_name：游标变量名称，该变量引用了一个游标。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--打开游标</span></span><br><span class="line"><span class="keyword">open</span> orderNum_02_cursor</span><br></pre></td></tr></table></figure><h3 id="4，提取数据"><a href="#4，提取数据" class="headerlink" title="4，提取数据"></a>4，提取数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--提取游标语法</span></span><br><span class="line"><span class="keyword">Fetch</span></span><br><span class="line">[ [Next<span class="operator">|</span>prior<span class="operator">|</span>Frist<span class="operator">|</span><span class="keyword">Last</span><span class="operator">|</span>Absoute n<span class="operator">|</span>Relative n ]</span><br><span class="line"><span class="keyword">from</span> ]</span><br><span class="line">[<span class="keyword">Global</span>] cursor_name</span><br><span class="line">[<span class="keyword">into</span> <span class="variable">@variable_name</span>[,....]]</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>Frist：结果集的第一行</li><li>Prior：当前位置的上一行</li><li>Next：当前位置的下一行</li><li>Last：最后一行</li><li>Absoute n：从游标的第一行开始数，第n行。</li><li>Relative n：从当前位置数，第n行。</li><li>Into @variable_name[,…] : 将提取到的数据存放到变量variable_name中。</li></ul><p>例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--提取数据</span></span><br><span class="line"><span class="keyword">fetch</span> <span class="keyword">first</span> <span class="keyword">from</span> orderNum_02_cursor</span><br><span class="line"><span class="keyword">fetch</span> relative <span class="number">3</span> <span class="keyword">from</span> orderNum_02_cursor</span><br><span class="line"><span class="keyword">fetch</span> next <span class="keyword">from</span> orderNum_02_cursor</span><br><span class="line"><span class="keyword">fetch</span> absolute <span class="number">4</span> <span class="keyword">from</span> orderNum_02_cursor</span><br><span class="line"><span class="keyword">fetch</span> next <span class="keyword">from</span> orderNum_02_cursor</span><br><span class="line"><span class="keyword">fetch</span> <span class="keyword">last</span> <span class="keyword">from</span> orderNum_02_cursor </span><br><span class="line"><span class="keyword">fetch</span> prior <span class="keyword">from</span> orderNum_02_cursor</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> bigorder <span class="keyword">where</span> orderNum<span class="operator">=</span><span class="string">&#x27;ZEORD003402&#x27;</span></span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--提取数据赋值给变量</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@OrderId</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">fetch</span> absolute <span class="number">3</span> <span class="keyword">from</span> orderNum_02_cursor <span class="keyword">into</span> <span class="variable">@OrderId</span></span><br><span class="line"><span class="keyword">select</span> <span class="variable">@OrderId</span> <span class="keyword">as</span> id</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> bigorder <span class="keyword">where</span> orderNum<span class="operator">=</span><span class="string">&#x27;ZEORD003402&#x27;</span></span><br></pre></td></tr></table></figure><p>通过检测全局变量**@@Fetch_Status**的值，获得提取状态信息，该状态用于判断Fetch语句返回数据的有效性。当执行一条Fetch语句之后，@@Fetch_Status可能出现3种值：</p><ul><li><strong>0</strong>，Fetch语句成功。</li><li><strong>-1</strong>：Fetch语句失败或行不在结果集中。</li><li><strong>-2</strong>：提取的行不存在。</li></ul><p>这个状态值可以帮你判断提取数据的成功与否。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable">@OrderId</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">fetch</span> absolute <span class="number">3</span> <span class="keyword">from</span> orderNum_02_cursor <span class="keyword">into</span> <span class="variable">@OrderId</span></span><br><span class="line">while @<span class="variable">@fetch_status</span><span class="operator">=</span><span class="number">0</span>  <span class="comment">--提取成功，进行下一条数据的提取操作</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> <span class="variable">@OrderId</span> <span class="keyword">as</span> id</span><br><span class="line">   <span class="keyword">fetch</span>  next <span class="keyword">from</span> orderNum_02_cursor <span class="keyword">into</span> <span class="variable">@OrderId</span>  <span class="comment">--移动游标</span></span><br><span class="line"> <span class="keyword">end</span></span><br></pre></td></tr></table></figure><h3 id="5-利用游标更新删除数据"><a href="#5-利用游标更新删除数据" class="headerlink" title="5.利用游标更新删除数据"></a>5.利用游标更新删除数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--游标修改当前数据语法</span></span><br><span class="line"><span class="keyword">Update</span> 基表名 <span class="keyword">Set</span> 列名<span class="operator">=</span>值[,...] <span class="keyword">Where</span> <span class="keyword">Current</span> <span class="keyword">of</span> 游标名</span><br><span class="line"><span class="comment">--游标删除当前数据语法</span></span><br><span class="line"><span class="keyword">Delete</span> 基表名  <span class="keyword">Where</span> <span class="keyword">Current</span> <span class="keyword">of</span> 游标名</span><br></pre></td></tr></table></figure><p>游标更新删除当前数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--1.声明游标</span></span><br><span class="line"><span class="keyword">declare</span> orderNum_03_cursor <span class="keyword">cursor</span> <span class="keyword">scroll</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">select</span> OrderId ,userId <span class="keyword">from</span> bigorder <span class="keyword">where</span> orderNum<span class="operator">=</span><span class="string">&#x27;ZEORD003402&#x27;</span></span><br><span class="line"><span class="comment">--2.打开游标</span></span><br><span class="line"><span class="keyword">open</span> orderNum_03_cursor</span><br><span class="line"><span class="comment">--3.声明游标提取数据所要存放的变量</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@OrderId</span> <span class="type">int</span> ,<span class="variable">@userId</span> <span class="type">varchar</span>(<span class="number">15</span>)</span><br><span class="line"><span class="comment">--4.定位游标到哪一行</span></span><br><span class="line"><span class="keyword">fetch</span> <span class="keyword">First</span> <span class="keyword">from</span> orderNum_03_cursor <span class="keyword">into</span> <span class="variable">@OrderId</span>,<span class="variable">@userId</span>  <span class="comment">--into的变量数量必须与游标查询结果集的列数相同</span></span><br><span class="line">while @<span class="variable">@fetch_status</span><span class="operator">=</span><span class="number">0</span>  <span class="comment">--提取成功，进行下一条数据的提取操作 </span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line">   if <span class="variable">@OrderId</span><span class="operator">=</span><span class="number">122182</span></span><br><span class="line">     <span class="keyword">begin</span></span><br><span class="line">     <span class="keyword">Update</span> bigorder <span class="keyword">Set</span> UserId<span class="operator">=</span><span class="string">&#x27;123&#x27;</span> <span class="keyword">Where</span> <span class="keyword">Current</span> <span class="keyword">of</span>  orderNum_03_cursor  <span class="comment">--修改当前行</span></span><br><span class="line">     <span class="keyword">end</span></span><br><span class="line">   if <span class="variable">@OrderId</span><span class="operator">=</span><span class="number">154074</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">Delete</span> bigorder <span class="keyword">Where</span> <span class="keyword">Current</span> <span class="keyword">of</span>  orderNum_03_cursor  <span class="comment">--删除当前行</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">fetch</span> next <span class="keyword">from</span> orderNum_03_cursor <span class="keyword">into</span> <span class="variable">@OrderId</span> ,<span class="variable">@userId</span>  <span class="comment">--移动游标</span></span><br><span class="line"> <span class="keyword">end</span></span><br></pre></td></tr></table></figure><h3 id="6，关闭游标"><a href="#6，关闭游标" class="headerlink" title="6，关闭游标"></a>6，关闭游标</h3><p>游标打开后，服务器会专门为游标分配一定的内存空间存放游标操作的数据结果集，同时使用游标也会对某些数据进行封锁。所以游标一旦用过，应及时关闭，避免服务器资源浪费。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--关闭游标语法</span></span><br><span class="line"><span class="keyword">close</span> [ <span class="keyword">Global</span> ] cursor_name <span class="operator">|</span> cursor_variable_name</span><br><span class="line"><span class="comment">--关闭游标</span></span><br><span class="line"><span class="keyword">close</span> orderNum_03_cursor</span><br></pre></td></tr></table></figure><h3 id="7，删除游标"><a href="#7，删除游标" class="headerlink" title="7，删除游标"></a>7，删除游标</h3><p>删除游标，释放资源</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--释放游标语法</span></span><br><span class="line"><span class="keyword">deallocate</span>  [ <span class="keyword">Global</span> ] cursor_name <span class="operator">|</span> cursor_variable_name</span><br><span class="line"><span class="comment">--释放游标</span></span><br><span class="line"><span class="keyword">deallocate</span> orderNum_03_cursor</span><br></pre></td></tr></table></figure><p>使用实例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">USE Test_DB;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@jid</span> <span class="type">CHAR</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@pic</span> NVARCHAR(<span class="number">64</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> My_Cursor <span class="keyword">CURSOR</span> <span class="comment">--定义游标</span></span><br><span class="line"><span class="keyword">FOR</span> (<span class="keyword">SELECT</span> jid <span class="keyword">FROM</span> journal <span class="keyword">WHERE</span> isall <span class="keyword">in</span>(<span class="number">1</span>,<span class="number">2</span>)) <span class="comment">--查出需要的集合放到游标中</span></span><br><span class="line"><span class="keyword">OPEN</span> My_Cursor; <span class="comment">--打开游标</span></span><br><span class="line"><span class="keyword">FETCH</span> NEXT <span class="keyword">FROM</span> My_Cursor <span class="keyword">INTO</span> <span class="variable">@jid</span>; <span class="comment">--读取第一行数据</span></span><br><span class="line">WHILE @<span class="variable">@FETCH_STATUS</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">SET</span> <span class="variable">@pic</span><span class="operator">=</span>(<span class="keyword">SELECT</span> TOP <span class="number">1</span> smallpic <span class="keyword">FROM</span> journalissue <span class="keyword">WHERE</span> jid<span class="operator">=</span><span class="variable">@jid</span> <span class="keyword">and</span> (smallpic <span class="operator">!=</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> smallpic <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> issueyear <span class="keyword">DESC</span>,issueno <span class="keyword">DESC</span>);</span><br><span class="line">        PRINT (<span class="variable">@jid</span> <span class="operator">+</span><span class="string">&#x27;    &#x27;</span><span class="operator">+</span> <span class="variable">@pic</span>);</span><br><span class="line">        IF(<span class="variable">@jid</span> <span class="operator">!=</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> <span class="variable">@jid</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> <span class="variable">@pic</span> <span class="operator">!=</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> <span class="variable">@pic</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            <span class="keyword">UPDATE</span> journal <span class="keyword">SET</span> pic<span class="operator">=</span><span class="variable">@pic</span> <span class="keyword">WHERE</span> jid<span class="operator">=</span><span class="variable">@jid</span>;</span><br><span class="line">        <span class="keyword">END</span>        </span><br><span class="line">        <span class="keyword">FETCH</span> NEXT <span class="keyword">FROM</span> My_Cursor <span class="keyword">INTO</span> <span class="variable">@jid</span>; <span class="comment">--读取下一行数据</span></span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="keyword">CLOSE</span> My_Cursor; <span class="comment">--关闭游标</span></span><br><span class="line"><span class="keyword">DEALLOCATE</span> My_Cursor; <span class="comment">--释放游标</span></span><br><span class="line">GO</span><br></pre></td></tr></table></figure><p>详细说明<br>RS.OPEN SQL,CONN,A,B<br>参数A为设定游标的类型，其取值为： 0 仅向前游标，只能向前浏览记录，不支持分页、Recordset、BookMark<br>1 键集游标，其他用户对记录所做的修改将反映到记录集中，但其他用户增加或删除记录不会反映到记录集中。支持分页、Recordset、BookMark<br>2 动态游标功能最强，但耗资源也最多。用户对记录所做的修改，增加或删除记录都将反映到记录集中。支持全功能浏览。<br>3 静态游标，只是数据的一个快照，用户对记录所做的修改，增加或删除记录都不会反映到记录集中。支持向前或向后移动<br>参数B为记录集的锁定类型，其取值为：<br>1 锁定类型，默认的，只读，不能作任何修改<br>2 当编辑时立即锁定记录，最安全的方式<br>3 只有在调用Update方法时才锁定记录集，而在此前的其他操作仍可对当前记录进行更改、插入和删除等<br>4 当编辑时记录不会被锁定，而更改、插入和删除是在批处理方式下完成的<br>打开数据记录集方法其实不止一种，但是我们用的最多的就是<br>rs.open sql,1,1的方法，可是后面的数字参数很多人不解其意，下面我们来介绍一下。<br>其实open方法后面有多个参数<br>CursorType LockType CommandType<br>比如 rs.open sql,1,1<br>也可以写成<br>rs.cursorType &#x3D; 1<br>rs.LockType &#x3D; 1<br>rs.open sql<br>其中CursorType代表从一个表或者一个SQL查询结果返回的记录。<br>这个参数有四个值分别是：<br>adOpenForwardOnly 表示只允许在记录集内的记录间往前移动。这个是缺省值。<br>adOpenKeyset 反映由其它用户所做的对记录的改变或者删除动作，但并不反映由其它用户做作的添加新记录的动作。<br>adOpenDynamic 反映由其它用户所做的对记录的改变或者删除动作，包括添加的新记录<br>adOpenStatic 不反映其它用户对记录所做的修改，添加，删除动作。<br>这四个值VBSCRIPT预定义位<br>adOpenForwardOnly &#x3D; 0<br>adOpenKeyset &#x3D; 1<br>adOpenDynamic &#x3D; 2<br>adOpenStatic &#x3D; 3<br>lockType 表示当打开记录集时，数据提供者用于锁定数据库的类型：<br>adLockReadOnly 数据不能改变，这是缺省值！<br>adLockPessimistic 数据提供者在开始编辑数据的时候锁定记录<br>adLockOptimistic 仅当调用update方法时，数据提供者锁定记录<br>adLockBatchOptimistic 用于批处理修改<br>他们的常量值定义分别是：<br>adLockReadOnly &#x3D; 1<br>adLockPessimistic &#x3D; 2<br>adLockOptimistic &#x3D; 3<br>adLockBatchOptimistic &#x3D; 4<br>rs.open sql,conn,1,1 读取记录 select<br>rs.open sql,conn,1,3 只更新记录最好 update<br>rs.open sql,conn,2,3 插入和删除最好 insert delete</p><p>示例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> USE [Community];</span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span> <span class="keyword">DECLARE</span> <span class="variable">@UserInfoID</span> <span class="type">bigint</span>,<span class="variable">@Name</span> nvarchar(<span class="number">100</span>),<span class="variable">@UCAccountID</span> <span class="type">bigint</span>;</span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span> </span><br><span class="line"> <span class="number">6</span> <span class="keyword">DECLARE</span> My_Cursor <span class="keyword">CURSOR</span> <span class="comment">--定义游标</span></span><br><span class="line"> <span class="number">7</span> <span class="keyword">FOR</span> (</span><br><span class="line"> <span class="number">8</span>     <span class="keyword">select</span> <span class="keyword">distinct</span>(UI.[UserInfoID]),UI.[Name],UIToUC.[UCAccountID] <span class="keyword">from</span> [dbo].[CMAreaRelation] <span class="keyword">as</span> AR </span><br><span class="line"> <span class="number">9</span>         <span class="keyword">inner</span> <span class="keyword">join</span> [dbo].[UserInfo] <span class="keyword">as</span> UI <span class="keyword">on</span> UI.[UserInfoID]<span class="operator">=</span>AR.[Creator]</span><br><span class="line"><span class="number">10</span>         <span class="keyword">inner</span> <span class="keyword">join</span> [dbo].[UserInfoToUCAccount] <span class="keyword">as</span> UIToUC <span class="keyword">on</span> UIToUC.[UserInfoID]<span class="operator">=</span>UI.[UserInfoID]</span><br><span class="line"><span class="number">11</span> ) <span class="comment">--查出需要的集合放到游标中</span></span><br><span class="line"><span class="number">12</span> <span class="keyword">OPEN</span> My_Cursor; <span class="comment">--打开游标</span></span><br><span class="line"><span class="number">13</span> <span class="keyword">FETCH</span> NEXT <span class="keyword">FROM</span> My_Cursor <span class="keyword">INTO</span> <span class="variable">@UserInfoID</span>,<span class="variable">@Name</span>,<span class="variable">@UCAccountID</span>; <span class="comment">--读取第一行数据</span></span><br><span class="line"><span class="number">14</span> WHILE @<span class="variable">@FETCH_STATUS</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="number">15</span>     <span class="keyword">BEGIN</span></span><br><span class="line"><span class="number">16</span>         PRINT <span class="string">&#x27;@UserInfoID=&#x27;</span><span class="operator">+</span><span class="keyword">convert</span>(<span class="type">varchar</span>,isnull(<span class="variable">@UserInfoID</span>,<span class="number">0</span>))<span class="operator">+</span><span class="string">&#x27;， @Name=&#x27;</span><span class="operator">+</span>isnull(<span class="variable">@Name</span>,<span class="string">&#x27;&#x27;</span>)<span class="operator">+</span><span class="string">&#x27;， @UCAccountID=&#x27;</span><span class="operator">+</span><span class="keyword">convert</span>(<span class="type">varchar</span>,isnull(<span class="variable">@UCAccountID</span>,<span class="number">0</span>)); <span class="comment">--打印，方便查看（正式项目不需要该行）</span></span><br><span class="line"><span class="number">17</span>         <span class="comment">--这里是根据每一行编写自定义的操作……</span></span><br><span class="line"><span class="number">18</span> </span><br><span class="line"><span class="number">19</span>         <span class="keyword">FETCH</span> NEXT <span class="keyword">FROM</span> My_Cursor <span class="keyword">INTO</span> <span class="variable">@UserInfoID</span>,<span class="variable">@Name</span>,<span class="variable">@UCAccountID</span>; <span class="comment">--读取下一行数据</span></span><br><span class="line"><span class="number">20</span>     <span class="keyword">END</span></span><br><span class="line"><span class="number">21</span> <span class="keyword">CLOSE</span> My_Cursor; <span class="comment">--关闭游标</span></span><br><span class="line"><span class="number">22</span> <span class="keyword">DEALLOCATE</span> My_Cursor; <span class="comment">--释放游标</span></span><br><span class="line"><span class="number">23</span> GO</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue学习笔记1-什么是Vue</title>
      <link href="/2022/06/08/a0cecaa2c8d3/"/>
      <url>/2022/06/08/a0cecaa2c8d3/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue学习笔记1-什么是Vue"><a href="#Vue学习笔记1-什么是Vue" class="headerlink" title="Vue学习笔记1-什么是Vue"></a>Vue学习笔记1-什么是Vue</h1><h2 id="一、什么是-Vue？"><a href="#一、什么是-Vue？" class="headerlink" title="一、什么是 Vue？"></a>一、什么是 Vue？</h2><p>渐进式 JavaScript 框架，一款用于构建 Web 界面，易学易用，性能出色且功能丰富的框架。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202206120337707.png" alt="image-20220612033713860"></p><p>Vue (发音为 &#x2F;vjuː&#x2F;，类似 <strong>view</strong>) 是一款用于构建用户界面的 JavaScript 框架。它基于标准 HTML、CSS 和 JavaScript 构建，并提供了一套声明式的、组件化的编程模型，帮助你高效地开发用户界面，无论任务是简单还是复杂。</p><blockquote><p>以前，我们是使用 <code>HTML、CSS、JS</code> 去完成我们的项目。如果说这个项目比较复杂的话，用 JS 来写是可以写的，没有问题，但是呢，会比较困难，并且任务量会比较大，所以呢，就出现了 vue 这个框架来帮助我们在开发项目的过程中，更加的简单，更加的方便。</p></blockquote><hr><h2 id="二、渐进式框架"><a href="#二、渐进式框架" class="headerlink" title="二、渐进式框架"></a>二、渐进式框架</h2><p>Vue 是一个框架和生态，功能覆盖了大部分前端开发常见的需求。但 Web 世界又是十分多样化的，我们在 Web 上构建的东西可能在形式和规模上有很大不同。考虑到这一点，Vue 被设计成具有灵活性和可逐步集成的特点。根据你的需求场景，Vue 可以按不同的方式使用：</p><ul><li>增强静态的 HTML 而无需构建步骤</li><li>在任何页面中作为 Web Components 嵌入</li><li>单页应用 (SPA)</li><li>全栈 &#x2F; 服务端渲染 (SSR)</li><li>Jamstack &#x2F; 静态站点生成 (SSG)</li><li>目标为桌面端、移动端、WebGL，甚至是命令行终端</li></ul><blockquote><p>什么是渐进式？</p><p>前端，主要是构建用户的界面。以前我们使用 JS 来进行开发，现在一下子换成 vue 了，这个工程量无疑是非常大的，我们会怎么做呢？在项目中有很多页面，引入 vue 框架，我们将页面一点一点的替换掉之前用原生 JS 写的内容，这个时候，我们整个项目就会既包含之前的代码，又包含 vue 写的，这样一个页面一个页面的替换掉，将 vue 作为我们应用的一部分嵌套进去，这就是渐进式。</p></blockquote><blockquote><p>什么是第三方库？</p><p>简单来说就是，别人写的东西我们能拿过来直接用。比如说，轮播图。轮播图很常用，我们在什么地方都可以用到。以前使用原生 JS 来写一个轮播图，那可能会有点麻烦，但是在 vue 里，我们使用第三方库，比如说ElementUI，里面已经包含了我们常用的轮播图等组件，直接拿过来跟我的应用进行结合，这样就会更加的方便，也更加易于维护。</p></blockquote><blockquote><p>什么是单页面应用？</p><p>比如 vue 的官方文档，我们正常阅读时，切换会非常快，为什么？他们都在同一个页面上，我们点击按钮他并没有跳转，只是修改了路径，通过 JS 修改了页面的内容，即 DOM 里面的内容，让我们看上去进行了切换，实际上并没有，所以很大程度提升了用户的体验。以前，我们用 JS 发送请求，若响应比较慢，可能会出现白屏的效果，而单页面应用，没有重新发起请求，所以就没有这个问题，能很快速地切换。</p></blockquote><p>摘自 <a href="https://www.bilibili.com/video/BV1QA4y1d7xf?p=2&share_source=copy_web">写网页的叮叮</a></p><hr><h2 id="三、服务端渲染"><a href="#三、服务端渲染" class="headerlink" title="三、服务端渲染"></a>三、服务端渲染</h2><p>首先，说到服务端渲染我们要先对渲染这个概念有一个大概的了解，就是将数据和模版组装成html。</p><h3 id="客户端渲染（CSR）VS服务端渲染-SSR"><a href="#客户端渲染（CSR）VS服务端渲染-SSR" class="headerlink" title="客户端渲染（CSR）VS服务端渲染(SSR)"></a>客户端渲染（CSR）VS服务端渲染(SSR)</h3><p>那么，为了更好的理解服务端渲染，我们也很有必要去了解一下客户端渲染。将客户端渲染与服务端渲染同时进行学习理解。</p><h4 id="1-客户端渲染"><a href="#1-客户端渲染" class="headerlink" title="1.客户端渲染"></a>1.客户端渲染</h4><h6 id="1-1概念"><a href="#1-1概念" class="headerlink" title="1.1概念"></a>1.1概念</h6><blockquote><p>解释一：客户端渲染模式下，服务端把渲染的静态文件给到客户端，客户端拿到服务端发送过来的文件自己跑一遍js，根据JS运行结果，生成相应DOM，然后渲染给用户。</p></blockquote><blockquote><p>解释二：html 仅仅作为静态文件，客户端在请求时，服务端不做任何处理，直接以原文件的形式返回给客户端客户端，然后根据 html 上的 JavaScript，生成 DOM 插入 html。</p></blockquote><blockquote><p><code>延伸</code>：前端渲染的方式起源于JavaScript的兴起，ajax的大热更是让前端渲染更加成熟，前端渲染真正意义上的实现了前后端分离，前端只专注于UI的开发，后端只专注于逻辑的开发，前后端交互只通过约定好的API来交互，后端提供json数据，前端循环json生成DOM插入到页面中去。</p></blockquote><h6 id="1-2-利弊"><a href="#1-2-利弊" class="headerlink" title="1.2.利弊"></a>1.2.利弊</h6><blockquote><p><code>好处</code>： 网络传输数据量小、减少了服务器压力、前后端分离、局部刷新，无需每次请求完整页面、交互好可实现各种效果</p></blockquote><blockquote><p><code>坏处</code>：不利于SEO、爬虫看不到完整的程序源码、首屏渲染慢（渲染前需要下载一堆js和css等）</p></blockquote><h5 id="2-服务端渲染"><a href="#2-服务端渲染" class="headerlink" title="2.服务端渲染"></a>2.服务端渲染</h5><h6 id="2-1-概念"><a href="#2-1-概念" class="headerlink" title="2.1.概念"></a>2.1.概念</h6><blockquote><p>解释一：服务端在返回 html 之前，在特定的区域，符号里用数据填充，再给客户端，客户端只负责解析 HTML 。</p></blockquote><blockquote><p>解释二：服务端渲染的模式下，当用户第一次请求页面时，由服务器把需要的组件或页面渲染成 HTML 字符串，然后把它返回给客户端。客户端拿到手的，是可以直接渲染然后呈现给用户的 HTML 内容，不需要为了生成 DOM 内容自己再去跑一遍 JS 代码。使用服务端渲染的网站，可以说是“所见即所得”，页面上呈现的内容，我们在 html 源文件里也能找到。</p></blockquote><h6 id="2-2-利弊"><a href="#2-2-利弊" class="headerlink" title="2.2.利弊"></a>2.2.利弊</h6><blockquote><p><code>好处</code>:首屏渲染快、利于SEO、可以生成缓存片段，生成静态化文件、节能（对比客户端渲染的耗电）</p></blockquote><blockquote><p><code>坏处</code>:用户体验较差、不容易维护，通常前端改了部分html或者css，后端也需要修改。</p></blockquote><h5 id="3-对比"><a href="#3-对比" class="headerlink" title="3.对比"></a>3.对比</h5><blockquote><p>其实前后端的渲染本质是一样的，都是字符串的拼接，将数据渲染进一些固定格式的html代码中形成最终的html展示在用户页面上。  因为字符串的拼接必然会损耗一些性能资源。<br> 如果在服务器端渲染，那么消耗的就是server端的性能。<br> 如果是在客户端渲染，常见的手段，比如是直接生成DOM插入到html 中，或者是使用一些前端的模板引擎等。他们初次渲染的原理大多是将原html中的数据标记（例如）替换。</p></blockquote><h3 id="为什么使用服务端渲染，它解决的是什么问题"><a href="#为什么使用服务端渲染，它解决的是什么问题" class="headerlink" title="为什么使用服务端渲染，它解决的是什么问题"></a>为什么使用服务端渲染，它解决的是什么问题</h3><p>简单总结起来就是两点：</p><blockquote><p><code>首屏加载快</code><br>相比于加载单页应用，我只需要加载当前页面的内容，而不需要像 React 或者 Vue 一样加载全部的 js 文件<br><code>SEO 优化</code><br>对于单页应用，搜索引擎并不能收录到 ajax 爬取数据之后然后再动态 js 渲染出来的页面。</p></blockquote><p>为了更便于理解，下面几段话摘自掘金小册：</p><blockquote><p>事实上，很多网站是出于效益的考虑才启用服务端渲染，性能倒是在其次。</p><p>假设 A 网站页面中有一个关键字叫“前端性能优化”，这个关键字是 JS 代码跑过一遍后添加到 HTML 页面中的。那么客户端渲染模式下，我们在搜索引擎搜索这个关键字，是找不到 A 网站的——搜索引擎只会查找现成的内容，不会帮你跑 JS 代码。A 网站的运营方见此情形，感到很头大：搜索引擎搜不出来，用户找不到我们，谁还会用我的网站呢？为了把“现成的内容”拿给搜索引擎看，A 网站不得不启用服务端渲染。</p><p>但性能在其次，不代表性能不重要。服务端渲染解决了一个非常关键的性能问题——首屏加载速度过慢。在客户端渲染模式下，我们除了加载 HTML，还要等渲染所需的这部分 JS 加载完，之后还得把这部分 JS 在浏览器上再跑一遍。这一切都是发生在用户点击了我们的链接之后的事情，在这个过程结束之前，用户始终见不到我们网页的庐山真面目，也就是说用户一直在等！相比之下，服务端渲染模式下，服务器给到客户端的已经是一个直接可以拿来呈现给用户的网页，中间环节早在服务端就帮我们做掉了，用户岂不“美滋滋”？</p></blockquote><h3 id="什么情况下使用服务端渲染"><a href="#什么情况下使用服务端渲染" class="headerlink" title="什么情况下使用服务端渲染"></a>什么情况下使用服务端渲染</h3><p>通过服务端渲染的概念以及它的两个特点：<code>首屏加载速度快</code>、<code>SEO优化</code>。我们知道，服务端渲染其实就是<code>由浏览器做的一些事情，我们放到了服务端去做</code>，那么对于掘金、简书、CSDN、知乎等网站的搭建，这种在网上一搜搜出一堆东西的网站，SEO做的很好，应该多少都用到服务端渲染了吧？当然，做服务端渲染成本是高昂的。vue全家桶或者react全家桶，都是推荐通过服务端渲染来实现路由的。服务端渲染并非完全之策（服务器稀少而宝贵），关于首屏渲染体验以及SEO的优化方案很多，在不使用服务端渲染这个操作下，我们最好的处理方式就是找寻替代优化方案。关于在server端还是在browser端渲染的选择，更多的是要看业务场景。</p><p>摘自 <a href="https://www.jianshu.com/u/5842abb77bd1">六个周</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>U8数据库同步至WMS数据库语句</title>
      <link href="/2022/05/06/f112cbccbc0b/"/>
      <url>/2022/05/06/f112cbccbc0b/</url>
      
        <content type="html"><![CDATA[<h1 id="U8数据库同步至WMS数据库语句"><a href="#U8数据库同步至WMS数据库语句" class="headerlink" title="U8数据库同步至WMS数据库语句"></a>U8数据库同步至WMS数据库语句</h1><h2 id="1-静态数据"><a href="#1-静态数据" class="headerlink" title="1. 静态数据"></a>1. 静态数据</h2><h3 id="1-1-部门档案-Department"><a href="#1-1-部门档案-Department" class="headerlink" title="1.1. 部门档案(Department)"></a>1.1. 部门档案(Department)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> DepartmentSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    cDepCode DEPARTMENT_CODE,</span><br><span class="line">    cDepName DEPARTMENT_NAME,</span><br><span class="line">    cDepFullName DEPARTMENT_DESC,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> DATA_VALID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, dp.dModifyDate, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    Department dp</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, isnull(dp.dModifyDate, getdate()), <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  DepartmentSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h3 id="1-2-用户资料-UserAccount"><a href="#1-2-用户资料-UserAccount" class="headerlink" title="1.2. 用户资料(UserAccount)"></a>1.2. 用户资料(UserAccount)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> UserAccountSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    u.cUser_Id USER_ACCOUNT,</span><br><span class="line">    u.cUser_Name USER_NAME,</span><br><span class="line">    u.cPassword USER_PASSWORD,</span><br><span class="line">    u.cUserEmail E_MAIL,</span><br><span class="line">    d.cDepCode DEPARTMENTID,</span><br><span class="line">    h.cPsnMobilePhone MOBILE,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> DATA_VALID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> u.dPasswordDate <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> u.dCrDate</span><br><span class="line">        <span class="keyword">ELSE</span> u.dPasswordDate</span><br><span class="line">      <span class="keyword">END</span>,</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    UA_User_Ex u</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> hr_hi_person h <span class="keyword">ON</span> h.cPsn_Num <span class="operator">=</span> u.cUser_Id</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Department d <span class="keyword">ON</span> d.cDepCode <span class="operator">=</span> h.cDept_num</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      isnull(</span><br><span class="line">        <span class="keyword">CASE</span></span><br><span class="line">          <span class="keyword">WHEN</span> u.dPasswordDate <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> u.dCrDate</span><br><span class="line">          <span class="keyword">ELSE</span> u.dPasswordDate</span><br><span class="line">        <span class="keyword">END</span>,</span><br><span class="line">        getdate()</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  UserAccountSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h3 id="1-3-客户档案-Customer"><a href="#1-3-客户档案-Customer" class="headerlink" title="1.3. 客户档案(Customer)"></a>1.3. 客户档案(Customer)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> CustomerSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    cCuscode CUSTOMER_CODE,</span><br><span class="line">    cCusname CUSTOMER_NAME,</span><br><span class="line">    cCusabbname SHORT_NAME,</span><br><span class="line">    cc.cCCCode CCUSTOMER_CODE,</span><br><span class="line">    cc.cCCName CCUSTOMER_NAME,</span><br><span class="line">    cu.cCusAddress CUSTOMER_ADDRESS,</span><br><span class="line">    cu.cCusPhone CUSTOMER_TEL,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, cu.dCusDevDate, <span class="number">121</span>) CUSTOMER_DEVDATE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> SALES_CODE,</span><br><span class="line">    <span class="number">0</span> RMA_CENTERID,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> DATA_VALID,</span><br><span class="line">    cu.cModifyPerson MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      (</span><br><span class="line">        <span class="keyword">CASE</span></span><br><span class="line">          <span class="keyword">WHEN</span> cu.dModifyDate <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> cu.dModifyDate</span><br><span class="line">          <span class="keyword">ELSE</span> cu.dCusCreateDatetime</span><br><span class="line">        <span class="keyword">END</span></span><br><span class="line">      ),</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    customer cu</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> customerclass cc <span class="keyword">ON</span> cu.cCCCode <span class="operator">=</span> cc.cCCCode</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      isnull(</span><br><span class="line">        <span class="keyword">CASE</span></span><br><span class="line">          <span class="keyword">WHEN</span> cu.dModifyDate <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> cu.dCusCreateDatetime</span><br><span class="line">          <span class="keyword">ELSE</span> cu.dModifyDate</span><br><span class="line">        <span class="keyword">END</span>,</span><br><span class="line">        getdate()</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  CustomerSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h3 id="1-4-供应商档案-Vendor"><a href="#1-4-供应商档案-Vendor" class="headerlink" title="1.4. 供应商档案(Vendor)"></a>1.4. 供应商档案(Vendor)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> VendorSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    vc.cVCCode VENDOR_CCODE,</span><br><span class="line">    vc.cVCName VENDOR_CNAME,</span><br><span class="line">    v.cVenCode VENDOR_CODE,</span><br><span class="line">    v.cVenName VENDOR_NAME,</span><br><span class="line">    v.cVenAbbname SHORT_NAME,</span><br><span class="line">    v.cVenAddress VENDOR_ADDRESS,</span><br><span class="line">    v.cCreatePerson CREATE_USERID,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> DATA_VALID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      (</span><br><span class="line">        <span class="keyword">CASE</span></span><br><span class="line">          <span class="keyword">WHEN</span> v.dModifyDate <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> v.dVenCreateDatetime</span><br><span class="line">          <span class="keyword">ELSE</span> v.dModifyDate</span><br><span class="line">        <span class="keyword">END</span></span><br><span class="line">      ),</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    Vendor v</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> VendorClass vc <span class="keyword">ON</span> v.cVCCode <span class="operator">=</span> vc.cVCCode</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      isnull(</span><br><span class="line">        <span class="keyword">CASE</span></span><br><span class="line">          <span class="keyword">WHEN</span> v.dModifyDate <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> v.dVenCreateDatetime</span><br><span class="line">          <span class="keyword">ELSE</span> v.dModifyDate</span><br><span class="line">        <span class="keyword">END</span>,</span><br><span class="line">        getdate()</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  VendorSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h3 id="1-5-仓库信息-Warehouse"><a href="#1-5-仓库信息-Warehouse" class="headerlink" title="1.5. 仓库信息(Warehouse)"></a>1.5. 仓库信息(Warehouse)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> WarehouseSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    w.cWhCode WAREHOUSE_NO,</span><br><span class="line">    w.cWhName WAREHOUSE_NAME,</span><br><span class="line">    w.cDepCode DEPARTMENT_NO,</span><br><span class="line">    w.cWhAddress WAREHOUSE_ADDRESS,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> w.bWhPos <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) POSITION_FLAG,</span><br><span class="line">    w.cWhPerson WAREHOUSE_PERSON,</span><br><span class="line">    w.cWhPhone WAREHOUSE_TEL,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> DATA_VALID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, w.dModifyDate, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    Warehouse w</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, isnull(w.dModifyDate, getdate()), <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  WarehouseSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h3 id="1-6-货位信息-Location"><a href="#1-6-货位信息-Location" class="headerlink" title="1.6. 货位信息(Location)"></a>1.6. 货位信息(Location)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> LocationSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    p.cPosCode LOCATION_NO,</span><br><span class="line">    p.cPosName LOCATION_DESC,</span><br><span class="line">    p.cWhCode WAREHOUSE_CODE,</span><br><span class="line">    p.cMemo LOCATION_REMARK,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> DATA_VALID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    POSITION p</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    bPosEnd <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, p.cPosCode, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  LocationSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  LOCATION_NO <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h3 id="1-7-物料档案-Partnumber"><a href="#1-7-物料档案-Partnumber" class="headerlink" title="1.7. 物料档案(Partnumber)"></a>1.7. 物料档案(Partnumber)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> PartnumberSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> i.cInvCode PART_NUMBER,</span><br><span class="line">    i.cInvName PART_DESC1,</span><br><span class="line">    i.cInvStd PART_DESC2,</span><br><span class="line">    com.cComUnitName PART_UNIT,</span><br><span class="line">    i.cInvCCode PART_TYPECODE,</span><br><span class="line">    ic.cInvCName PART_TYPE,</span><br><span class="line">    cVenCode VENDOR_CODE,</span><br><span class="line">    cPosition LOCATION_NO,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> i.bPropertyCheck <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) QC_FLAG,</span><br><span class="line">    <span class="comment">--是否质检</span></span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> i.bInvQuality <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) QUALITY_FLAG,</span><br><span class="line">    <span class="comment">--是否保质期管理 </span></span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> i.bInvBatch <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) BATCH_FLAG,</span><br><span class="line">    <span class="comment">--是否批次管理 </span></span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> DATA_VALID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, i.dModifyDate, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    inventory i</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> inventoryclass ic <span class="keyword">ON</span> i.cInvCCode <span class="operator">=</span> ic.cInvCCode</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> ComputationUnit com <span class="keyword">ON</span> com.cComunitCode <span class="operator">=</span> i.cComUnitCode</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, isnull(i.dModifyDate, getdate()), <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  PartnumberSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h2 id="2-动态数据"><a href="#2-动态数据" class="headerlink" title="2. 动态数据"></a>2. 动态数据</h2><h3 id="2-1-入库作业"><a href="#2-1-入库作业" class="headerlink" title="2.1. 入库作业"></a>2.1. 入库作业</h3><h4 id="2-1-1-收料"><a href="#2-1-1-收料" class="headerlink" title="2.1.1 收料"></a>2.1.1 收料</h4><p>采购（委外）到货单（ArrivalVouch）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> ArrivalVouchSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(ph.cCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(phs.ivouchrowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> phs.ivouchrowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) RTID,</span><br><span class="line">    ph.cCode RTNO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(phs.ivouchrowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> phs.ivouchrowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> <span class="type">VARCHAR</span></span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) ITEMNO,</span><br><span class="line">    v.cVenCode VENDORID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VENDOR_SITE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VENDOR_DELIVERYNO,</span><br><span class="line">    phs.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span> PROPERTYCHECK,</span><br><span class="line">    <span class="built_in">CAST</span>(</span><br><span class="line">      isnull(phs.fValidQuantity, <span class="number">0</span>) <span class="operator">+</span> isnull(phs.fDegradeQuantity, <span class="number">0</span>) <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)</span><br><span class="line">    ) RT_QTY,</span><br><span class="line">    ph.cBusType RT_TYPE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> BRAND,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> ORIGIN,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> RT_STATUS,</span><br><span class="line">    ph.cMaker RT_USERID,</span><br><span class="line">    ph.cpocode PO_NO,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, ph.dDate, <span class="number">121</span>) PLAN_RTDATE,</span><br><span class="line">    getdate() ACTURAL_RTDATE,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> phs.bexigency <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) URGENT_STATUS,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> phs.bGsp <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) QC_FLAG,</span><br><span class="line">    ctransordercode ASN_NO,</span><br><span class="line">    cgeneralordercode ASN_ITEMNO,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> WORK_ORDER,</span><br><span class="line">    phs.cBatch ERPLOT_NO,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> IQC_LOTNO,</span><br><span class="line">    <span class="number">0</span> MINPACK_LOTSIZE,</span><br><span class="line">    phs.cGspState QC_RESULT,</span><br><span class="line">    phs.cWhCode WAREHOUSEID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> WAIVE_NO,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, q.DVERIFYTIME, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    PU_ArrivalVouchs phs</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> PU_ArrivalVouch ph <span class="keyword">ON</span> ph.id <span class="operator">=</span> phs.id</span><br><span class="line">    <span class="keyword">AND</span> phs.cCloser <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> QMCHECKVOUCHER q <span class="keyword">ON</span> q.SOURCEID <span class="operator">=</span> ph.id</span><br><span class="line">    <span class="keyword">AND</span> q.SOURCEAUTOID <span class="operator">=</span> phs.Autoid</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> vendor v <span class="keyword">ON</span> v.cVenCode <span class="operator">=</span> ph.cVenCode</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    ph.cverifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> q.DVERIFYTIME <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> ph.cCloser <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> (</span><br><span class="line">      ph.cBusType <span class="operator">=</span> <span class="string">&#x27;普通采购&#x27;</span></span><br><span class="line">      <span class="keyword">OR</span> ph.cBusType <span class="operator">=</span> <span class="string">&#x27;委外加工&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">AND</span> ph.bNegative <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">AND</span> phs.bGsp <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, q.DVERIFYTIME, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  ArrivalVouchSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><p>采购（委外）到货单（免检）（ArrivalvouchInspection）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> ArrivalvouchInspectionSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(ph.cCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(phs.ivouchrowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> phs.ivouchrowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) RTID,</span><br><span class="line">    ph.cCode RTNO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(phs.ivouchrowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> phs.ivouchrowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> <span class="type">VARCHAR</span></span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) ITEMNO,</span><br><span class="line">    v.cVenCode VENDORID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VENDOR_SITE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VENDOR_DELIVERYNO,</span><br><span class="line">    phs.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PROPERTYCHECK,</span><br><span class="line">    <span class="built_in">CAST</span>(phs.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) RT_QTY,</span><br><span class="line">    ph.cBusType RT_TYPE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> BRAND,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> ORIGIN,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> RT_STATUS,</span><br><span class="line">    ph.cMaker RT_USERID,</span><br><span class="line">    ph.cpocode PO_NO,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, ph.dDate, <span class="number">121</span>) PLAN_RTDATE,</span><br><span class="line">    getdate() ACTURAL_RTDATE,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> phs.bexigency <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) URGENT_STATUS,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> phs.bGsp <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) QC_FLAG,</span><br><span class="line">    ctransordercode ASN_NO,</span><br><span class="line">    cgeneralordercode ASN_ITEMNO,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> WORK_ORDER,</span><br><span class="line">    phs.cBatch ERPLOT_NO,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> IQC_LOTNO,</span><br><span class="line">    <span class="number">0</span> MINPACK_LOTSIZE,</span><br><span class="line">    phs.cGspState QC_RESULT,</span><br><span class="line">    phs.cWhCode WAREHOUSEID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> WAIVE_NO,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, ph.caudittime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    PU_ArrivalVouchs phs</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> PU_ArrivalVouch ph <span class="keyword">ON</span> ph.id <span class="operator">=</span> phs.id</span><br><span class="line">    <span class="keyword">AND</span> phs.cCloser <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> vendor v <span class="keyword">ON</span> v.cVenCode <span class="operator">=</span> ph.cVenCode</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    ph.cverifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> ph.caudittime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> ph.cCloser <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> (</span><br><span class="line">      ph.cBusType <span class="operator">=</span> <span class="string">&#x27;普通采购&#x27;</span></span><br><span class="line">      <span class="keyword">OR</span> ph.cBusType <span class="operator">=</span> <span class="string">&#x27;委外加工&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">AND</span> ph.bNegative <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">AND</span> phs.bGsp <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, ph.caudittime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  ArrivalvouchInspectionSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h4 id="2-1-2-产成品入库"><a href="#2-1-2-产成品入库" class="headerlink" title="2.1.2 产成品入库"></a>2.1.2 产成品入库</h4><p>生产订单(FgstockinManufacture)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinManufactureSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    o.MoCode FORM_NO,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> REMARK,</span><br><span class="line">    <span class="string">&#x27;生产订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_USERID,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_STARTTIME,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;I04&#x27;</span> WRH_FORMCODE,</span><br><span class="line">    <span class="keyword">NULL</span> CREATE_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    o.CreateUser REQUEST_USERID,</span><br><span class="line">    o.CreateDate CREATE_DATE,</span><br><span class="line">    mot.RelsUser MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, mot.RelsTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    mom_order o</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> mom_orderdetail mot <span class="keyword">ON</span> mot.moid <span class="operator">=</span> o.moid</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    mot.Status <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">AND</span> mot.RelsTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> mot.RelsUser <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, mot.RelsTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinManufactureSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>生产订单明细(FgstockinManufactureDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinManufactureDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    o.MoCode <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(od.SortSeq <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) FORM_RECID,</span><br><span class="line">    o.MoCode FORM_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(od.SortSeq <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;生产订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    od.InvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    od.WhCode WAREHOUSEID,</span><br><span class="line">    od.MoLotCode ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(od.Qty <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) RETURN_QTY,</span><br><span class="line">    <span class="number">0</span> ACTUAL_QTY,</span><br><span class="line">    od.remark REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="number">0</span> STOCKIN_QTY,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> RTNPACKAGE_ID,</span><br><span class="line">    od.QcFlag QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> WAIVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> WRH_ORG,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    <span class="keyword">NULL</span> DID,</span><br><span class="line">    od.RelsUser MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, od.RelsTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    mom_orderdetail od</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> mom_order o <span class="keyword">ON</span> o.MOID <span class="operator">=</span> od.MOID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    od.RelsTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> od.RelsUser <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, od.RelsTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinManufactureDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>委外订单(FgstockinOutsourcing)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinOutsourcingSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    mo.cCode FORM_NO,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    mo.cMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;委外订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_USERID,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_STARTTIME,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;I01&#x27;</span> WRH_FORMCODE,</span><br><span class="line">    <span class="keyword">NULL</span> CREATE_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    mo.cMaker REQUEST_USERID,</span><br><span class="line">    mo.dCreateTime CREATE_DATE,</span><br><span class="line">    mo.cVerifier MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, mo.dVerifyTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    OM_MOMain mo</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    mo.cVerifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> mo.dVerifyTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, mo.dVerifyTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinOutsourcingSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>委外订单明细(FgstockinOutsourcingDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinOutsourcingDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(od.MOID <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(od.iVouchRowNo <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) FORM_RECID,</span><br><span class="line">    o.MOID FORM_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(od.iVouchRowNo <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;委外订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> WORK_ORDER,</span><br><span class="line">    od.cInvCode PARTID,</span><br><span class="line">    <span class="keyword">NULL</span> VERSION,</span><br><span class="line">    <span class="keyword">NULL</span> WAREHOUSEID,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(od.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) RETURN_QTY,</span><br><span class="line">    <span class="number">0</span> ACTUAL_QTY,</span><br><span class="line">    od.cbMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="number">0</span> STOCKIN_QTY,</span><br><span class="line">    <span class="keyword">NULL</span> RTNPACKAGE_ID,</span><br><span class="line">    od.bGsp QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> WAIVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> WRH_ORG,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    <span class="keyword">NULL</span> DID,</span><br><span class="line">    o.cVerifier MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dVerifyTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    OM_MODetails od</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> OM_MOMain o <span class="keyword">ON</span> o.MOID <span class="operator">=</span> od.MOID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.dVerifyTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cVerifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dVerifyTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinOutsourcingDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>工单退料单(FgstockinReturnMaterial)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinReturnMaterialSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    o.cCode FORM_NO,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    o.cMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;工单退料单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_USERID,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_STARTTIME,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;I03&#x27;</span> WRH_FORMCODE,</span><br><span class="line">    <span class="keyword">NULL</span> CREATE_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    o.cHandler REQUEST_USERID,</span><br><span class="line">    o.dnmaketime CREATE_DATE,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> o.cMaker</span><br><span class="line">        <span class="keyword">ELSE</span> o.cHandler</span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> o.dnmaketime</span><br><span class="line">        <span class="keyword">ELSE</span> o.dnverifytime</span><br><span class="line">      <span class="keyword">END</span>,</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    rdrecords11 od</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> rdrecord11 o <span class="keyword">ON</span> od.ID <span class="operator">=</span> o.ID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    od.iQuantity <span class="operator">&lt;</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> o.dnmaketime</span><br><span class="line">        <span class="keyword">ELSE</span> o.dnverifytime</span><br><span class="line">      <span class="keyword">END</span>,</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinReturnMaterialSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>工单退料单明细(FgstockinReturnMaterialDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinReturnMaterialDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(o.cCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(od.AutoID <span class="keyword">AS</span> nvarchar) FORM_RECID,</span><br><span class="line">    o.cCode FORM_NO,</span><br><span class="line">    <span class="built_in">CAST</span>(od.AutoID <span class="keyword">AS</span> nvarchar) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;工单退料单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    od.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    o.cWhCode WAREHOUSEID,</span><br><span class="line">    od.cMoLotCode ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="built_in">ABS</span>(od.iQuantity) <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) RETURN_QTY,</span><br><span class="line">    <span class="number">0</span> ACTUAL_QTY,</span><br><span class="line">    od.cbMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="number">0</span> STOCKIN_QTY,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> RTNPACKAGE_ID,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> WAIVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> WRH_ORG,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    <span class="keyword">NULL</span> DID,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> o.cMaker</span><br><span class="line">        <span class="keyword">ELSE</span> o.cHandler</span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> o.dnmaketime</span><br><span class="line">        <span class="keyword">ELSE</span> o.dnverifytime</span><br><span class="line">      <span class="keyword">END</span>,</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    rdrecords11 od</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> rdrecord11 o <span class="keyword">ON</span> od.ID <span class="operator">=</span> o.ID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    od.iQuantity <span class="operator">&lt;</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(</span><br><span class="line">      nvarchar,</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> o.dnmaketime</span><br><span class="line">        <span class="keyword">ELSE</span> o.dnverifytime</span><br><span class="line">      <span class="keyword">END</span>,</span><br><span class="line">      <span class="number">121</span></span><br><span class="line">    ) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinReturnMaterialDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>其他入库单(FgstockinOther)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinOtherSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    o.cCode FORM_NO,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    o.cMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;其他入库单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_USERID,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_STARTTIME,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;I01&#x27;</span> WRH_FORMCODE,</span><br><span class="line">    <span class="keyword">NULL</span> CREATE_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    o.cMaker REQUEST_USERID,</span><br><span class="line">    o.dnmaketime CREATE_DATE,</span><br><span class="line">    o.cHandler MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    RdRecord08 o</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinOtherSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>其他入库单明细(FgstockinOtherDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> FgstockinOtherDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    o.cCode <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(od.AutoID <span class="keyword">AS</span> nvarchar) FORM_RECID,</span><br><span class="line">    o.cCode FORM_NO,</span><br><span class="line">    <span class="built_in">CAST</span>(od.AutoID <span class="keyword">AS</span> nvarchar) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;其他入库单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    od.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    o.cWhCode WAREHOUSEID,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(od.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) RETURN_QTY,</span><br><span class="line">    <span class="number">0</span> ACTUAL_QTY,</span><br><span class="line">    od.cbMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="number">0</span> STOCKIN_QTY,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> RTNPACKAGE_ID,</span><br><span class="line">    <span class="keyword">NULL</span> QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> WAIVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> WRH_ORG,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    <span class="keyword">NULL</span> DID,</span><br><span class="line">    o.cMaker REQUEST_USERID,</span><br><span class="line">    o.dnmaketime CREATE_DATE,</span><br><span class="line">    o.cHandler MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    rdrecords08 od</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> RdRecord08 o <span class="keyword">ON</span> od.ID <span class="operator">=</span> o.ID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  FgstockinOtherDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><h3 id="2-2-出库作业"><a href="#2-2-出库作业" class="headerlink" title="2.2.出库作业"></a>2.2.出库作业</h3><h4 id="2-2-1-材料出库"><a href="#2-2-1-材料出库" class="headerlink" title="2.2.1 材料出库"></a>2.2.1 材料出库</h4><p>生产订单(MaterialstockoutManufacture)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutManufactureSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> o.MoCode FORM_NO,</span><br><span class="line">    od.RelsUser REQUEST_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.CreateDate, <span class="number">120</span>) CREATE_DATE,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, od.RelsDate, <span class="number">120</span>) REQUEST_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    od.remark REMARK,</span><br><span class="line">    <span class="string">&#x27;生产订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_USERID,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_STARTTIME,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOT_SPLIT_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> UNOPEN_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> CHECK_BRAND,</span><br><span class="line">    <span class="string">&#x27;ERP&#x27;</span> CREATE_TYPE,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYAREA_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> MERGE_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> LIFO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> RESERVE_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PRIORITYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    od.RelsUser MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, od.RelsTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    mom_order o</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> mom_orderdetail od <span class="keyword">ON</span> o.MOID <span class="operator">=</span> od.MOID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    od.RelsTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> od.RelsUser <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, od.RelsTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutManufactureSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>生产订单子件(MaterialstockoutManufactureDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutManufactureDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(o.MoCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(om.AllocateId <span class="keyword">AS</span> nvarchar) FORM_RECID,</span><br><span class="line">    <span class="built_in">CAST</span>(o.MoCode <span class="keyword">AS</span> nvarchar) FORM_NO,</span><br><span class="line">    <span class="built_in">CAST</span>(om.AllocateId <span class="keyword">AS</span> nvarchar) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;生产订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    om.InvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    om.WhCode WAREHOUSEID,</span><br><span class="line">    om.LotNo ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(om.Qty <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) REQUEST_QTY,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="number">0</span> <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) ACTUAL_QTY,</span><br><span class="line">    om.remark REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> om.QcFlag <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    od.RelsUser MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, od.RelsTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    mom_moallocate om</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> mom_orderdetail od <span class="keyword">ON</span> om.MoDId <span class="operator">=</span> od.MoDId</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> mom_order o <span class="keyword">ON</span> od.MoId <span class="operator">=</span> o.MoId</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    om.WIPType <span class="operator">=</span> <span class="number">3</span> <span class="comment">--只有领料的物料才同步</span></span><br><span class="line">    <span class="keyword">AND</span> od.RelsTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> od.RelsUser <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, od.RelsTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutManufactureDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>委外订单(MaterialstockoutOutsourcing)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutOutsourcingSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> o.cCode FORM_NO,</span><br><span class="line">    o.cVerifier REQUEST_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dDate, <span class="number">120</span>) CREATE_DATE,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dVerifyDate, <span class="number">120</span>) REQUEST_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    o.cMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;委外订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_USERID,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_STARTTIME,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOT_SPLIT_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> UNOPEN_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> CHECK_BRAND,</span><br><span class="line">    <span class="string">&#x27;ERP&#x27;</span> CREATE_TYPE,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYAREA_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> MERGE_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> LIFO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> RESERVE_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PRIORITYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    o.cVerifier MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dVerifyTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    OM_MOMain o</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.dVerifyTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cVerifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dVerifyTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutOutsourcingSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>委外订单子件(MaterialstockoutOutsourcingDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutOutsourcingDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(o.cCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(ods.irowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> ods.irowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) FORM_RECID,</span><br><span class="line">    <span class="built_in">CAST</span>(o.cCode <span class="keyword">AS</span> nvarchar) FORM_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(ods.irowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> ods.irowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;委外订单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    ods.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    ods.cWhCode WAREHOUSEID,</span><br><span class="line">    ods.cBatch ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(ods.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) REQUEST_QTY,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="number">0</span> <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) ACTUAL_QTY,</span><br><span class="line">    ods.cbMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    o.cVerifier MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dVerifyTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    OM_MOMaterials ods</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> OM_MODetails od <span class="keyword">ON</span> od.MODetailsID <span class="operator">=</span> ods.MoDetailsID</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> OM_MOMain o <span class="keyword">ON</span> o.MOID <span class="operator">=</span> od.MOID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.dVerifyTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cVerifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dVerifyTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutOutsourcingDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>领料申请单(MaterialstockoutMaterial)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutMaterialSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> o.cCode FORM_NO,</span><br><span class="line">    o.cHandler REQUEST_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dDate, <span class="number">120</span>) CREATE_DATE,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dVeriDate, <span class="number">120</span>) REQUEST_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    o.cMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;领料申请单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PROCESS_USERID,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_STARTTIME,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOT_SPLIT_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> UNOPEN_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> CHECK_BRAND,</span><br><span class="line">    <span class="string">&#x27;ERP&#x27;</span> CREATE_TYPE,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYAREA_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> MERGE_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> LIFO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> RESERVE_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PRIORITYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    o.cHandler MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    MaterialAppVouch o</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutMaterialSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>领料申请单子件(MaterialstockoutMaterialDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutMaterialDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(o.cCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(od.irowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> od.irowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) FORM_RECID,</span><br><span class="line">    <span class="built_in">CAST</span>(o.cCode <span class="keyword">AS</span> nvarchar) FORM_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(od.irowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> od.irowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;领料申请单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    od.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    od.cWhCode WAREHOUSEID,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(od.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) REQUEST_QTY,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="number">0</span> <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) ACTUAL_QTY,</span><br><span class="line">    od.cbMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> o.cModifyPerson <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> o.cMaker</span><br><span class="line">        <span class="keyword">ELSE</span> o.cModifyPerson</span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    MaterialAppVouchs od</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> MaterialAppVouch o <span class="keyword">ON</span> o.id <span class="operator">=</span> od.ID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="comment">--od.WIPType = 3 AND  --只有领料的物料才同步</span></span><br><span class="line">    o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutMaterialDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>补料申请单(MaterialstockoutReplenishapply)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutReplenishapplySync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> o.DocCode FORM_NO,</span><br><span class="line">    o.RelsUser REQUEST_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.CreateDate, <span class="number">120</span>) CREATE_DATE,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.DocDate, <span class="number">120</span>) REQUEST_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    <span class="keyword">NULL</span> REMARK,</span><br><span class="line">    <span class="string">&#x27;补料申请单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    o.RelsUser PROCESS_USERID,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_STARTTIME,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOT_SPLIT_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> UNOPEN_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> CHECK_BRAND,</span><br><span class="line">    <span class="string">&#x27;ERP&#x27;</span> CREATE_TYPE,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYAREA_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> MERGE_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> LIFO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> RESERVE_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PRIORITYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    o.ModifyUser MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.RelsTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    mom_replenishapply o</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.RelsTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.RelsUser <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.RelsTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutReplenishapplySync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>补料申请单子件(MaterialstockoutReplenishapplyDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutReplenishapplyDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(o.DocCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(od.SortSeq) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> od.SortSeq</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) FORM_RECID,</span><br><span class="line">    <span class="built_in">CAST</span>(o.DocCode <span class="keyword">AS</span> nvarchar) FORM_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(od.SortSeq) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> od.SortSeq</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;补料申请单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    ods.InvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    ods.WhCode WAREHOUSEID,</span><br><span class="line">    ods.LotNo ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(od.ApplyQty <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) REQUEST_QTY,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="number">0</span> <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) ACTUAL_QTY,</span><br><span class="line">    ods.Remark REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    o.RelsUser MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.RelsTime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    mom_moallocate ods</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> mom_replenishapplydtl od <span class="keyword">ON</span> od.MoAllocateId <span class="operator">=</span> ods.AllocateId</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> mom_replenishapply o <span class="keyword">ON</span> o.ApplyId <span class="operator">=</span> od.ApplyId</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    ods.WIPType <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="comment">--只有领料的物料才同步</span></span><br><span class="line">    o.RelsTime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.RelsUser <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.RelsTime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutReplenishapplyDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>其他出库单(MaterialstockoutOther)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutOtherSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> o.cCode FORM_NO,</span><br><span class="line">    o.cHandler REQUEST_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dnmaketime, <span class="number">120</span>) CREATE_DATE,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dDate, <span class="number">120</span>) REQUEST_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    <span class="keyword">NULL</span> REMARK,</span><br><span class="line">    <span class="string">&#x27;其他出库单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> MOVE_NO,</span><br><span class="line">    o.cHandler PROCESS_USERID,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_STARTTIME,</span><br><span class="line">    <span class="built_in">CAST</span>(<span class="keyword">NULL</span> <span class="keyword">AS</span> datetime) PROCESS_ENDTIME,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOT_SPLIT_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> UNOPEN_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> CHECK_BRAND,</span><br><span class="line">    <span class="string">&#x27;ERP&#x27;</span> CREATE_TYPE,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYAREA_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> MERGE_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> LIFO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> RESERVE_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PRIORITYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    o.cHandler MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    RdRecord09 o</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutOtherSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>其他出库单子件(MaterialstockoutOtherDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> MaterialstockoutOtherDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(o.cCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(od.AutoID <span class="keyword">AS</span> nvarchar) FORM_RECID,</span><br><span class="line">    <span class="built_in">CAST</span>(o.cCode <span class="keyword">AS</span> nvarchar) FORM_NO,</span><br><span class="line">    <span class="built_in">CAST</span>(od.AutoID <span class="keyword">AS</span> nvarchar) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;其他出库单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> WORK_ORDER,</span><br><span class="line">    od.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    o.cWhCode WAREHOUSEID,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_LOTNO,</span><br><span class="line">    <span class="keyword">NULL</span> ERP_PROCESS,</span><br><span class="line">    <span class="built_in">CAST</span>(od.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) REQUEST_QTY,</span><br><span class="line">    <span class="built_in">CAST</span>(od.iFQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) ACTUAL_QTY,</span><br><span class="line">    od.cbMemo REMARK,</span><br><span class="line">    <span class="string">&#x27;&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> QC_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> QC_RESULT,</span><br><span class="line">    <span class="keyword">NULL</span> IQC_LOTNO,</span><br><span class="line">    o.cHandler MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    Rdrecords09 od</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> RdRecord09 o <span class="keyword">ON</span> od.ID <span class="operator">=</span> o.ID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    <span class="comment">--od.WIPType = 3 AND  --只有领料的物料才同步</span></span><br><span class="line">    o.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> o.cHandler <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, o.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  MaterialstockoutOtherDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><h4 id="2-2-2-发货备料"><a href="#2-2-2-发货备料" class="headerlink" title="2.2.2 发货备料"></a>2.2.2 发货备料</h4><p>销售发货退货单(Shipping)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> ShippingSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> <span class="built_in">CAST</span>(d.cDLCode <span class="keyword">AS</span> nvarchar) SHIPPING_NO,</span><br><span class="line">    d.cCusCode CUSTOMERID,</span><br><span class="line">    d.cPersonCode SALER_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, d.dDate, <span class="number">111</span>) CREATE_DATE,</span><br><span class="line">    d.dverifydate SCHEDULE_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> SO_STATUS,</span><br><span class="line">    d.cMemo REMARK,</span><br><span class="line">    d.cBusType SO_TYPE,</span><br><span class="line">    d.cmodifier MODIFY_USERID,</span><br><span class="line">    <span class="keyword">NULL</span> CREATE_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> TRANSPORT_TYPE,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOT_SPLIT_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> CHECK_BRAND,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> RESERVE_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYAREA_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PICKBYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> MERGE_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> LIFO_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> PRIORITYLOCATION,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> UNOPEN_FIRST_FLAG,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span> SOURCE_NO,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, d.dverifysystime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    DispatchList d</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    d.dverifysystime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, dverifysystime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  ShippingSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><p>销售发货退货单明细(ShippingDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> ShippingDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> <span class="built_in">CAST</span>(d.cDLCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(ds.irowno <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) SHIPPING_RECID,</span><br><span class="line">    <span class="built_in">CAST</span>(d.cDLCode <span class="keyword">AS</span> nvarchar) SHIPPING_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(ds.irowno <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) ITEMNO,</span><br><span class="line">    ds.cInvCode PARTID,</span><br><span class="line">    ds.cBatch VERSION,</span><br><span class="line">    cBatch ERP_LOTNO,</span><br><span class="line">    ds.cWhCode WAREHOUSEID,</span><br><span class="line">    <span class="built_in">CAST</span>(ds.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) SOQTY,</span><br><span class="line">    <span class="built_in">CAST</span>(fOutQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) SHIP_QTY,</span><br><span class="line">    iMassDate WARRANTY_MONTH,</span><br><span class="line">    <span class="keyword">NULL</span> CUSTOMER_SITE,</span><br><span class="line">    d.cShipAddress SHIP_ADDRESS,</span><br><span class="line">    <span class="keyword">NULL</span> PO_NO,</span><br><span class="line">    <span class="keyword">NULL</span> PO_ITEMNO,</span><br><span class="line">    ds.cMemo REMARK,</span><br><span class="line">    d.cmodifier MODIFY_USERID,</span><br><span class="line">    <span class="keyword">NULL</span> SHIP_ADDRESS2,</span><br><span class="line">    <span class="keyword">NULL</span> CREATE_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> ITEMNO_FLAG,</span><br><span class="line">    <span class="keyword">NULL</span> SCHEDULE_DATE,</span><br><span class="line">    <span class="keyword">NULL</span> SITEID,</span><br><span class="line">    <span class="keyword">NULL</span> DID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, d.dverifysystime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    DispatchLists ds</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> DispatchList d <span class="keyword">ON</span> ds.DLID <span class="operator">=</span> d.DLID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    d.dverifysystime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, dverifysystime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  ShippingDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h3 id="2-3-调拨作业"><a href="#2-3-调拨作业" class="headerlink" title="2.3. 调拨作业"></a>2.3. 调拨作业</h3><p>调拨申请单(Transfer)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> TransferSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">DISTINCT</span> v.cTVCode FORM_NO,</span><br><span class="line">    <span class="string">&#x27;调拨申请单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, v.dnmaketime, <span class="number">121</span>) CREATE_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FORM_ATTR,</span><br><span class="line">    v.cTVMemo REMARK,</span><br><span class="line">    v.cOWhCode FROM_WRHID,</span><br><span class="line">    v.cIWhCode TARGET_WRHID,</span><br><span class="line">    v.cMaker REQUEST_USERID,</span><br><span class="line">    v.cVerifyPerson PROCESS_USERID,</span><br><span class="line">    v.cModifyPerson MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, v.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    ST_AppTransVouch v</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    v.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> v.cVerifyPerson <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, v.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  TransferSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>调拨申请单明细(TransferDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> TransferDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(v.cTVCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(vs.irowno <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) FORM_RECID,</span><br><span class="line">    v.cTVCode FORM_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(<span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(vs.irowno <span class="keyword">AS</span> nvarchar), <span class="number">3</span>) ITEMNO,</span><br><span class="line">    <span class="string">&#x27;调拨申请单&#x27;</span> FORM_TYPE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FORM_ATTR,</span><br><span class="line">    v.cTVMemo REMARK,</span><br><span class="line">    vs.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    <span class="built_in">CAST</span>(iTVQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) MOVE_QTY,</span><br><span class="line">    v.cOWhCode FROM_WRHID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> FROM_LOCID,</span><br><span class="line">    v.cIWhCode TARGET_WRHID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> TARGET_LOCID,</span><br><span class="line">    <span class="built_in">CAST</span>(iTVQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) FROM_QTY,</span><br><span class="line">    <span class="built_in">CAST</span>(iTvSumQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) TARGET_QTY,</span><br><span class="line">    v.cMaker FROM_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, v.dnmaketime, <span class="number">121</span>) FROM_DATETIME,</span><br><span class="line">    v.cMaker REQUEST_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, v.dnmaketime, <span class="number">121</span>) CREATE_DATE,</span><br><span class="line">    v.cVerifyPerson PROCESS_USERID,</span><br><span class="line">    v.cModifyPerson MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, v.dnverifytime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    ST_AppTransVouchs vs</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> ST_AppTransVouch v <span class="keyword">ON</span> vs.ID <span class="operator">=</span> v.ID</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    v.cVerifyPerson <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> v.dnverifytime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, v.dnverifytime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  TransferDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><h3 id="2-4-退货作业"><a href="#2-4-退货作业" class="headerlink" title="2.4. 退货作业"></a>2.4. 退货作业</h3><h4 id="2-4-1-仓库退货"><a href="#2-4-1-仓库退货" class="headerlink" title="2.4.1 仓库退货"></a>2.4.1 仓库退货</h4><p>采购（委外）退货单(ReturnVendor)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> ReturnVendorSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    ph.cCode FORM_NO,</span><br><span class="line">    ph.cMaker REQUEST_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, ph.cMakeTime, <span class="number">121</span>) CREATE_DATE,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> FORM_STATUS,</span><br><span class="line">    ph.cMemo REMARK,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> ph.cBusType <span class="operator">=</span> <span class="string">&#x27;普通采购&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;采购退货单&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;委外退货单&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) FORM_TYPE,</span><br><span class="line">    <span class="keyword">NULL</span> FORM_ATTR,</span><br><span class="line">    <span class="keyword">NULL</span> [ PROCESS_USERID ],</span><br><span class="line">    <span class="keyword">NULL</span> [ PROCESS_STARTTIME ],</span><br><span class="line">    <span class="keyword">NULL</span> [ PROCESS_ENDTIME ],</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> ph.cchanger <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> ph.cMaker</span><br><span class="line">        <span class="keyword">ELSE</span> ph.cchanger</span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) MODIFY_USERID,</span><br><span class="line">    v.cVenCode VENDORID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, ph.caudittime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    PU_ArrivalVouch ph</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> vendor v <span class="keyword">ON</span> v.cVenCode <span class="operator">=</span> ph.cVenCode</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    ph.cverifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> ph.caudittime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> ph.cCloser <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> (</span><br><span class="line">      ph.cBusType <span class="operator">=</span> <span class="string">&#x27;普通采购&#x27;</span></span><br><span class="line">      <span class="keyword">OR</span> ph.cBusType <span class="operator">=</span> <span class="string">&#x27;委外加工&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">AND</span> ph.bNegative <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, ph.caudittime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  ReturnVendorSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><p>采购（委外）退货单明细(ReturnVendorDetail)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> ReturnVendorDetailSync <span class="keyword">AS</span>(</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">CAST</span>(ph.cCode <span class="keyword">AS</span> nvarchar) <span class="operator">+</span> <span class="string">&#x27;|&#x27;</span> <span class="operator">+</span> <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(phs.ivouchrowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> phs.ivouchrowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> nvarchar</span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) FORM_RECID,</span><br><span class="line">    ph.cCode FORM_NO,</span><br><span class="line">    <span class="keyword">RIGHT</span>(</span><br><span class="line">      <span class="string">&#x27;000&#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(</span><br><span class="line">        (</span><br><span class="line">          <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> len(phs.ivouchrowno) <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> phs.ivouchrowno</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">          <span class="keyword">END</span></span><br><span class="line">        ) <span class="keyword">AS</span> <span class="type">VARCHAR</span></span><br><span class="line">      ),</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    ) ITEMNO,</span><br><span class="line">    phs.cInvCode PARTID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> VERSION,</span><br><span class="line">    <span class="built_in">CAST</span>(phs.iQuantity <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">4</span>)) RETURN_QTY,</span><br><span class="line">    <span class="number">0</span> ACTUAL_QTY,</span><br><span class="line">    <span class="string">&#x27;Initial&#x27;</span> PICK_STATUS,</span><br><span class="line">    phs.cWhCode WAREHOUSEID,</span><br><span class="line">    <span class="string">&#x27;N/A&#x27;</span> ITEMNO_FLAG,</span><br><span class="line">    (</span><br><span class="line">      <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> ph.cchanger <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> ph.cMaker</span><br><span class="line">        <span class="keyword">ELSE</span> ph.cchanger</span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line">    ) MODIFY_USERID,</span><br><span class="line">    <span class="keyword">CONVERT</span>(nvarchar, ph.caudittime, <span class="number">121</span>) dModifyTime,</span><br><span class="line">    <span class="keyword">CONVERT</span>(bit, <span class="number">0</span>) IsSync</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    PU_ArrivalVouchs phs</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> PU_ArrivalVouch ph <span class="keyword">ON</span> ph.id <span class="operator">=</span> phs.id</span><br><span class="line">    <span class="keyword">AND</span> phs.cCloser <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line">    ph.cverifier <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> ph.caudittime <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> ph.cCloser <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">AND</span> (</span><br><span class="line">      ph.cBusType <span class="operator">=</span> <span class="string">&#x27;普通采购&#x27;</span></span><br><span class="line">      <span class="keyword">OR</span> ph.cBusType <span class="operator">=</span> <span class="string">&#x27;委外加工&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">AND</span> ph.bNegative <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span> phs.bGsp <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONVERT</span>(nvarchar, ph.caudittime, <span class="number">121</span>) <span class="operator">&gt;</span> <span class="keyword">CONVERT</span>(nvarchar, <span class="string">&#x27;$&#123;LastDatetime_&#125;&#x27;</span>, <span class="number">121</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  ReturnVendorDetailSync</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  dModifyTime <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> U8,WMS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用C#实现模拟双色球中奖控制台应用程序</title>
      <link href="/2022/05/02/a5f8190eedc3/"/>
      <url>/2022/05/02/a5f8190eedc3/</url>
      
        <content type="html"><![CDATA[<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h1><blockquote><p>其实这是我在大一第一学期CSharp的课程设计，要求编写一个模拟双色球彩票的控制台应用程序，用以实现简单的模拟选购彩票。</p><p>但最近我重新看我的博客时感觉之前写的代码还是有很多不足之处，比如变量的命名，方法的命名，整体代码风格等差强人意，毕竟是入门是写的代码，所以今天稍微修改一下，让命名更规范，注释更明确。当然，更重要的还是：不是吧代码拿来即用，而是让刚开始入门的小伙伴能够快速地对编程感兴趣，对.net平台感兴趣，对CSharp这门语言感兴趣,我们大家共同把国内的.net发展起来。</p></blockquote><h2 id="1-1-你会学到什么？"><a href="#1-1-你会学到什么？" class="headerlink" title="1.1 你会学到什么？"></a>1.1 你会学到什么？</h2><p>简单地运用CSharp语言和.net平台，如变量、方法、类、数组、字典、系统函数、规范的注释、控制台输出、文件的读写、程序怎样设计等。</p><h2 id="1-2-开发环境或运行环境"><a href="#1-2-开发环境或运行环境" class="headerlink" title="1.2 开发环境或运行环境"></a>1.2 开发环境或运行环境</h2><ol><li>Win10或Win11系统，Visual Studio 2022 开发环境；</li><li>.net6，CSharp10；</li></ol><h1 id="2-程序设计"><a href="#2-程序设计" class="headerlink" title="2. 程序设计"></a>2. 程序设计</h1><h2 id="2-1-流程图"><a href="#2-1-流程图" class="headerlink" title="2.1 流程图"></a>2.1 流程图</h2><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113828.PNG" alt="流程"></p><h2 id="2-2-有哪些功能？"><a href="#2-2-有哪些功能？" class="headerlink" title="2.2 有哪些功能？"></a>2.2 有哪些功能？</h2><ol><li>产生模拟奖池；</li><li>生成自定义购号记录；</li><li>打印数据，读取数据；</li><li>界面输出优化；</li><li>保护用户隐私；</li><li>程序结束后可继续查看中奖记录等。</li></ol><h2 id="2-3-运行展示"><a href="#2-3-运行展示" class="headerlink" title="2.3 运行展示"></a>2.3 运行展示</h2><h3 id="2-3-1-双色球规则"><a href="#2-3-1-双色球规则" class="headerlink" title="2.3.1 双色球规则"></a>2.3.1 双色球规则</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113830.png" alt="image-20220502234338317"></p><h3 id="2-3-2-充值或提现"><a href="#2-3-2-充值或提现" class="headerlink" title="2.3.2 充值或提现"></a>2.3.2 充值或提现</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113831.png" alt="image-20220502234727383"></p><h3 id="2-3-3-自动购号"><a href="#2-3-3-自动购号" class="headerlink" title="2.3.3 自动购号"></a>2.3.3 自动购号</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113832.gif" alt="image-202205030113832"></p><p>自动购号在去重后会自动排序展示出来。</p><h3 id="2-3-4-手动购号"><a href="#2-3-4-手动购号" class="headerlink" title="2.3.4 手动购号"></a>2.3.4 手动购号</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113833.gif" alt="动画"></p><p>可以看到，手动购号比系统购号稍微复杂了一点点，会有多次范围检测和重复检测，并且还要提示哪个球重复……完成购号后，自动购号和手动购号的记录就会在程序运行目录保存。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113834.png" alt="image-20220502235840211"></p><p>打开是这样的：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113835.png" alt="image-20220503001059260"></p><p>其实，数据保存方法经过了多次设计，最开始只是为了记录，后来做到开奖时不易拆分，一次次改进而来。设计过程如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">====第1次设计====</span><br><span class="line">用普通数据记录</span><br><span class="line">第【01】注：红色球：01 02 03 04 05 06 蓝色球：07【系统购号】时间：2019.06.12 22:02:01</span><br><span class="line">第【02】注：红色球：06 14 15 22 29 32 蓝色球：11【手动购号】时间：2019.06.12 22:02:07</span><br><span class="line">====第2次设计====</span><br><span class="line">去掉固定字符</span><br><span class="line">01_01_02_03_04_05_06_07_系统购号_2019.06.12 22:02:01</span><br><span class="line">02_06_14_15_22_29_32_11_手动购号_2019.06.12 22:02:07</span><br><span class="line">====第3次设计====</span><br><span class="line">用标记值 _</span><br><span class="line">01_01_02_03_04_05_06_07_2019.06.12 22:02:01</span><br><span class="line">02_06_14_15_22_29_32_11_2019.06.12 22:02:07</span><br><span class="line">====第4次设计====</span><br><span class="line">用标记值 N R B T</span><br><span class="line">N01R020615182426B14T2022-05-02 下午 11:51:55</span><br><span class="line">N02R011316172426B12T2022-05-02 下午 11:52:18</span><br></pre></td></tr></table></figure><h3 id="2-3-5-开奖"><a href="#2-3-5-开奖" class="headerlink" title="2.3.5 开奖"></a>2.3.5 开奖</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113836.gif" alt="动画"></p><p>开奖时会先检测是否有购号记录：没有记录对本程序来说开奖的意义不大，就不开奖；有开奖记录会产生开奖号码，并产生模拟奖池和模拟奖池累计奖金，从而产生奖金总额。</p><p>开奖后，按照自动购号、手动购号的次序进行对比购号记录，有中奖时，记录中将号码和相应的中奖金额便于查看，然后将奖金自动发放到账户余额。之后，删除之前的所有购号记录。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113837.png" alt="image-20220503002344752"></p><p>具体信息如下：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113838.png" alt="image-20220503002516109"></p><h3 id="2-3-6-开奖后的操作"><a href="#2-3-6-开奖后的操作" class="headerlink" title="2.3.6 开奖后的操作"></a>2.3.6 开奖后的操作</h3><p>开奖后你可以继续选择充值、提现、购号等。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113839.png" alt="image-20220503002823362"></p><h1 id="3-核心代码"><a href="#3-核心代码" class="headerlink" title="3. 核心代码"></a>3. 核心代码</h1><p><img src="https://cdn.zhaifanhua.com/blog/img/202205030113840.png" alt="image-20220503003429182"></p><h2 id="3-1-程序入口"><a href="#3-1-程序入口" class="headerlink" title="3.1 程序入口"></a>3.1 程序入口</h2><h3 id="3-1-1入口"><a href="#3-1-1入口" class="headerlink" title="3.1.1入口"></a>3.1.1入口</h3><p>Program.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:Program</span></span><br><span class="line"><span class="comment">// Guid:372ee8df-d0d5-4ceb-b033-613860c6257c</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:11:21</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"><span class="keyword">using</span> TwoColorBall.Main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 程序入口</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">int</span> _windowHeight = <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">int</span> _windowWidth = <span class="number">150</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 程序开始</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;args&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;Exception&quot;&gt;</span><span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        AppDomain.CurrentDomain.UnhandledException += UnhandledExceptionTrapper;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 设置窗口宽高</span></span><br><span class="line">            <span class="keyword">if</span> (RuntimeInformation.IsOSPlatform(OSPlatform.Windows))</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WindowHeight = _windowHeight;</span><br><span class="line">                Console.WindowWidth = _windowWidth;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;\t\t\t\t Copyright (C)<span class="subst">&#123;DateTime.Now.Year&#125;</span> ZhaiFanhua All Rights Reserved.&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;你好！欢迎你进入摘繁华的模拟双色球程序！&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;===================================================程序开始===================================================&quot;</span>);</span><br><span class="line">            <span class="comment">// 入口标记</span></span><br><span class="line">            <span class="built_in">int</span> entranceMark = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (entranceMark != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;请输入以下按键选择：【Q/q】查看规则；【W/w】进入模拟；【E/e】结束程序；&quot;</span>);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">                <span class="built_in">string</span> selectKey = Console.ReadLine() ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line">                <span class="keyword">switch</span> (selectKey.ToUpper())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">                        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;\t你选择了查看规则；&quot;</span>);</span><br><span class="line">                        Console.ResetColor();</span><br><span class="line">                        Rule rule = <span class="keyword">new</span>();</span><br><span class="line">                        rule.Start();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;W&quot;</span>:</span><br><span class="line">                        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;\t你选择了进入模拟；&quot;</span>);</span><br><span class="line">                        Console.ResetColor();</span><br><span class="line">                        Ball ball = <span class="keyword">new</span>();</span><br><span class="line">                        ball.Play();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;E&quot;</span>:</span><br><span class="line">                        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;\t你选择了结束程序!&quot;</span>);</span><br><span class="line">                        Console.ResetColor();</span><br><span class="line">                        entranceMark = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="literal">default</span>:</span><br><span class="line">                        Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;\t你的输入有误，请重新选择!&quot;</span>);</span><br><span class="line">                        Console.ResetColor();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;===================================================程序结束===================================================&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;程序结束，请按任意键退出。&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;\t\t\t\t Copyright (C)<span class="subst">&#123;DateTime.Now.Year&#125;</span> ZhaiFanhua All Rights Reserved.&quot;</span>);</span><br><span class="line">            _ = Console.ReadKey(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;程序出错！错误消息：\n&quot;</span> + ex.Message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 全局异常处理</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UnhandledExceptionTrapper</span>(<span class="params"><span class="built_in">object</span> sender, UnhandledExceptionEventArgs e</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">        Console.WriteLine(e.ExceptionObject.ToString());</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;请按任意键退出！&quot;</span>);</span><br><span class="line">        _ = Console.ReadLine();</span><br><span class="line">        Environment.Exit(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2-Main命名空间"><a href="#3-2-Main命名空间" class="headerlink" title="3.2 Main命名空间"></a>3.2 Main命名空间</h2><h3 id="3-2-1-选择模拟开始"><a href="#3-2-1-选择模拟开始" class="headerlink" title="3.2.1 选择模拟开始"></a>3.2.1 选择模拟开始</h3><p>Ball.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:Ball</span></span><br><span class="line"><span class="comment">// Guid:25182033-35b8-414c-8e5a-2d88a9677ab0</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:20:21</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Main</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 模拟双色球</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Ball</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> BallAutomatic _ballAutomatic = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> BallManual _ballManual = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> Lottery _lottery = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> Wallet _wallet = <span class="keyword">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 开始模拟</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Play</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;         =======================================模拟双色球开始=======================================&quot;</span>);</span><br><span class="line">        <span class="comment">// 新用户充值</span></span><br><span class="line">        Promotion();</span><br><span class="line">        <span class="comment">// 入口标记</span></span><br><span class="line">        <span class="built_in">int</span> entranceMark = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (entranceMark != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请选择：【Q/q】自动购号；【W/w】手动购号；【E/e】对已购双色球开奖；【R/r】充值或提现；【T/t】返回主菜单；&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            <span class="built_in">string</span> selectKey = Console.ReadLine() ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">switch</span> (selectKey.ToUpper())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">                    Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你选择了自动购号；&quot;</span>);</span><br><span class="line">                    Console.ResetColor();</span><br><span class="line">                    _ballAutomatic.Automatic();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;W&quot;</span>:</span><br><span class="line">                    Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你选择了手动购号；&quot;</span>);</span><br><span class="line">                    Console.ResetColor();</span><br><span class="line">                    _ballManual.Manual();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;E&quot;</span>:</span><br><span class="line">                    Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你选择了对已购买双色球开奖；&quot;</span>);</span><br><span class="line">                    Console.ResetColor();</span><br><span class="line">                    _lottery.Prize();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;R&quot;</span>:</span><br><span class="line">                    Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你选择了充值或提现；&quot;</span>);</span><br><span class="line">                    Console.ResetColor();</span><br><span class="line">                    _wallet.RechargeOrConsumptManual();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;T&quot;</span>:</span><br><span class="line">                    Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你选择了返回主菜单；&quot;</span>);</span><br><span class="line">                    Console.ResetColor();</span><br><span class="line">                    entranceMark = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你的输入有误，请重新输入!&quot;</span>);</span><br><span class="line">                    Console.ResetColor();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;         =======================================模拟双色球结束=======================================&quot;</span>);</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 新用户赠送余额</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Promotion</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t为了你的首次体验，系统已为你赠送100.00元用于购买双色球！\n&quot;</span>);</span><br><span class="line">        _wallet.RechargeOrConsumptAutomatic((<span class="built_in">decimal</span>)<span class="number">100.00</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-2-规则"><a href="#3-2-2-规则" class="headerlink" title="3.2.2 规则"></a>3.2.2 规则</h3><p>Rule.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:Rule</span></span><br><span class="line"><span class="comment">// Guid:5c7ad5a7-2239-4327-b82f-f14df6fb1f69</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:22:01</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Main</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 游戏规则</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Rule</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 开始</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Cyan;</span><br><span class="line">        Console.WriteLine(<span class="string">@&quot;一、玩法及说明</span></span><br><span class="line"><span class="string">            双色球投注区分为红球号码区和蓝球号码区，红球号码范围为01～33，蓝球号码范围为01～16。双色球每期从33个红球中</span></span><br><span class="line"><span class="string">            开出6个号码，从16个蓝球中开出1个号码作为中奖号码，双色球玩法即是竞猜开奖号码的6个红球号码和1个蓝球号码，顺</span></span><br><span class="line"><span class="string">            序不限。&quot;</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">@&quot;二、设奖及中奖</span></span><br><span class="line"><span class="string">            |------|-----------|--------|-----------------------------------------------------------------|--------|</span></span><br><span class="line"><span class="string">            |      | 中奖条件  |        |                                                                 |        |</span></span><br><span class="line"><span class="string">            | 奖级 |-----------|中奖说明|                          单注奖金                               |单注赔率|</span></span><br><span class="line"><span class="string">            |      | 红球 |蓝球|        |                                                                 |        |</span></span><br><span class="line"><span class="string">            |------|------|----|--------|-----------------------------------------------------------------|--------|</span></span><br><span class="line"><span class="string">            |      |      |    |        |当奖池资金低于1亿元时，奖金总额为当期高等奖奖金的75%与奖池中累积 |        |</span></span><br><span class="line"><span class="string">            |      |      |    |        |的奖金之和，单注奖金按注均分，单注最高限额封顶1000万元。         |        |</span></span><br><span class="line"><span class="string">            |      |      |    |        |当奖池资金高于1亿元(含)时，奖金总额包括两部分，一部分为当期高等奖|        |</span></span><br><span class="line"><span class="string">            |一等奖|RRRRRR| B  | 中6+1  |奖金的55%与奖池中累积的奖金之和，单注奖金按注均分，单注最高限额封|  ——  |</span></span><br><span class="line"><span class="string">            |      |      |    |        |顶1000万元;另一部分为当期高等奖奖金的20%，单注奖金按注均分，单注 |        |</span></span><br><span class="line"><span class="string">            |      |      |    |        |最高限额封顶1000万元。                                           |        |</span></span><br><span class="line"><span class="string">            |------|------|----|--------|-----------------------------------------------------------------|--------|</span></span><br><span class="line"><span class="string">            |二等奖|RRRRRR|    | 中6+0  |            当期高等奖奖金的25%，单注最高限额封顶500万元。       |  ——  |</span></span><br><span class="line"><span class="string">            |------|------|----|--------|-----------------------------------------------------------------|--------|</span></span><br><span class="line"><span class="string">            |三等奖|RRRRR | B  | 中5+1  |                   单注奖金额固定为3000元                        | 1:1500 |</span></span><br><span class="line"><span class="string">            |------|------|----|--------|-----------------------------------------------------------------|--------|</span></span><br><span class="line"><span class="string">            |      |RRRRR |    | 中5+0  |                                                                 |        |</span></span><br><span class="line"><span class="string">            |四等奖|------|----|--------|                   单注奖金额固定为200元                         | 1:100  |</span></span><br><span class="line"><span class="string">            |      |RRRRR | B  | 中4+1  |                                                                 |        |</span></span><br><span class="line"><span class="string">            |------|------|----|--------|-----------------------------------------------------------------|--------|</span></span><br><span class="line"><span class="string">            |      |RRRR  |    | 中4+0  |                                                                 |        |</span></span><br><span class="line"><span class="string">            |五等奖|------|----|--------|                   单注奖金额固定为10元                          | 1:5    |</span></span><br><span class="line"><span class="string">            |      |RRR   | B  | 中3+1  |                                                                 |        |</span></span><br><span class="line"><span class="string">            |------|------|----|--------|-----------------------------------------------------------------|--------|</span></span><br><span class="line"><span class="string">            |      |RR    | B  | 中2+0  |                                                                 |        |</span></span><br><span class="line"><span class="string">            |      |------|----|--------|                                                                 |        |</span></span><br><span class="line"><span class="string">            |六等奖|R     | B  | 中1+1  |                    单注奖金额固定为5元                          | 1:2.5  |</span></span><br><span class="line"><span class="string">            |      |------|----|--------|                                                                 |        |</span></span><br><span class="line"><span class="string">            |      |      | B  | 中0+1  |                                                                 |        |</span></span><br><span class="line"><span class="string">            |------|------|----|--------|-----------------------------------------------------------------|--------|&quot;</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">@&quot;注：</span></span><br><span class="line"><span class="string">            1、高等奖奖金＝奖金总额－固定奖奖金。</span></span><br><span class="line"><span class="string">            2、当奖池奖金超过1亿元(含)时，下期一等奖奖金总额包括两部分，一部分为高等奖奖金的55% 与奖池奖金之和，单注</span></span><br><span class="line"><span class="string">            奖金按注均分，封顶1000万元；另一部分为高等奖奖金的20%，单注奖金按注均分，封顶1000万元。</span></span><br><span class="line"><span class="string">            3、奖池奖金在1亿元以下时，单注奖金封顶500万元。&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;你已查看完双色球规则!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-3-账户余额"><a href="#3-2-3-账户余额" class="headerlink" title="3.2.3 账户余额"></a>3.2.3 账户余额</h3><p>Wallet.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:Wallet</span></span><br><span class="line"><span class="comment">// Guid:bbf94a5b-f7f3-4202-a11c-aba3dac239c3</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:23:35</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Main</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 账户钱包</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Wallet</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 余额</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">decimal</span> _balance = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">decimal</span> Balance</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> =&gt; _balance;</span><br><span class="line">        <span class="keyword">set</span> =&gt; _balance = <span class="keyword">value</span> &gt;= <span class="number">0</span> ? <span class="keyword">value</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 手动充值或消费</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RechargeOrConsumptManual</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;请输入你的账户存取额(正为充值，负为提现)：&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">decimal</span> money = <span class="built_in">decimal</span>.Parse(Console.ReadLine() ?? <span class="built_in">string</span>.Format(<span class="string">&quot;0&quot;</span>));</span><br><span class="line">        RechargeOrConsumptAutomatic(money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 自动充值或消费</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;money&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RechargeOrConsumptAutomatic</span>(<span class="params"><span class="built_in">decimal</span> money</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">decimal</span> moneyabs = Math.Abs(money);</span><br><span class="line">        <span class="keyword">if</span> (money &gt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t充值或奖励金额为：&#123;0&#125;元；&quot;</span>, FormatMoneyToDecimal(moneyabs));</span><br><span class="line">            Balance += moneyabs;</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (Math.Abs(money) &gt; Balance)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t账户余额不足此提现或消费；&quot;</span>);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t提现或消费金额为：&#123;0&#125;元；&quot;</span>, FormatMoneyToDecimal(moneyabs));</span><br><span class="line">                Balance -= moneyabs;</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//输出账户余额</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t你的账户的余额为：&#123;0&#125;元；&quot;</span>, FormatMoneyToDecimal(Balance));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 格式化金额(1234,5678.90)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;money&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">FormatMoneyToDecimal</span>(<span class="params"><span class="built_in">decimal</span> money</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> moneyStr = money.ToString();</span><br><span class="line">            <span class="built_in">string</span> moneyRes = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="built_in">string</span> moneyInt = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="built_in">string</span> moneyDecimal = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="keyword">if</span> (moneyStr.Contains(<span class="string">&#x27;.&#x27;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                moneyInt = moneyStr.Split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>].ToString();</span><br><span class="line">                moneyDecimal = <span class="string">&quot;.&quot;</span> + moneyStr.Split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>].ToString();</span><br><span class="line">                moneyRes = FormatMoneyToInt(moneyInt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                moneyRes = FormatMoneyToInt(moneyStr);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="built_in">string</span> <span class="title">FormatMoneyToInt</span>(<span class="params"><span class="built_in">string</span> moneyint</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (moneyint.ToString().Length &gt; <span class="number">4</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> moneyNotFormat = moneyint.Substring(<span class="number">0</span>, moneyint.Length - <span class="number">4</span>);</span><br><span class="line">                    <span class="built_in">string</span> moneyFormat = moneyint.Substring(moneyint.Length - <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">                    <span class="keyword">if</span> (moneyNotFormat.Length &gt; <span class="number">4</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> FormatMoneyToInt(moneyNotFormat) + <span class="string">&quot;,&quot;</span> + moneyFormat;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> moneyNotFormat + <span class="string">&quot;,&quot;</span> + moneyFormat;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> moneyint;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> moneyRes + moneyDecimal;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-4-自动购号"><a href="#3-2-4-自动购号" class="headerlink" title="3.2.4 自动购号"></a>3.2.4 自动购号</h3><p>BallAutomatic.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:BallAutomatic</span></span><br><span class="line"><span class="comment">// Guid:8c918fa6-8fdb-486d-a214-ce7627c70fd8</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:24:53</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> TwoColorBall.Common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Main</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 自动购号</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BallAutomatic</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Wallet _myWallet = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> WriteData _writeData = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> Random _random = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[] _balls = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 自动购号</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Automatic</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                    =============================自动购号开始=============================&quot;</span>);</span><br><span class="line">        <span class="built_in">int</span> buytimes = CheckWallet();</span><br><span class="line">        Buy(buytimes);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                    =============================自动购号结束=============================&quot;</span>);</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                                           (你可以选择继续购号或开奖)&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 确认购买注数并判断余额是否可用</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">CheckWallet</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> times = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">int</span> entranceMark = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (entranceMark != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入你要购买几注双色球:&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            times = <span class="built_in">int</span>.Parse(Console.ReadLine() ?? <span class="string">&quot;0&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((<span class="built_in">decimal</span>)times * <span class="number">2</span> &gt; _myWallet.Balance)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t你的账户余额不够购买&#123;0&#125;注双色球，请充值；&quot;</span>, times);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">                _myWallet.RechargeOrConsumptManual();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                entranceMark = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> times;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 购买下注</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;buytimes&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Buy</span>(<span class="params"><span class="built_in">int</span> buytimes</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t系统正在为你购买【&#123;0&#125;】注双色球...&quot;</span>, buytimes);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> sequence = <span class="number">1</span>; sequence &lt;= buytimes; sequence++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;第【&#123;0,2&#125;】注：&quot;</span>, sequence.ToString(<span class="string">&quot;D2&quot;</span>));</span><br><span class="line">            Red();</span><br><span class="line">            Blue();</span><br><span class="line">            Console.Write(<span class="string">&quot;\t【自动购号】&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> time = DateTime.Now.ToString();</span><br><span class="line">            Console.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">            _writeData.RecordBall(<span class="keyword">this</span>.GetType().Name, sequence.ToString(<span class="string">&quot;D2&quot;</span>), _balls, time);</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t系统已为你完成购买【&#123;0,2&#125;】注双色球！&quot;</span>, buytimes);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        _myWallet.RechargeOrConsumptAutomatic(-(<span class="built_in">decimal</span>)buytimes * <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 红色球</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Red</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] redballs = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];</span><br><span class="line">        <span class="comment">// 重复检验</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; redballs.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> ball = _random.Next(<span class="number">1</span>, <span class="number">34</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> (ball == redballs[j])</span><br><span class="line">                &#123;</span><br><span class="line">                    ball = _random.Next(<span class="number">1</span>, <span class="number">34</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            redballs[i] = ball;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 数字排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; redballs.Length - <span class="number">1</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; redballs.Length - <span class="number">1</span> - i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (redballs[j] &gt; redballs[j + <span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> max = redballs[j];</span><br><span class="line">                    redballs[j] = redballs[j + <span class="number">1</span>];</span><br><span class="line">                    redballs[j + <span class="number">1</span>] = max;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 显示记录</span></span><br><span class="line">        Console.Write(<span class="string">&quot;红色球：&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; redballs.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Task.Delay(<span class="number">50</span>).Wait();</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, redballs[i]);</span><br><span class="line">            _balls[i] = redballs[i];</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 蓝色球</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Blue</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> blueball = _random.Next(<span class="number">1</span>, <span class="number">17</span>);</span><br><span class="line">        Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">        Task.Delay(<span class="number">50</span>).Wait();</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">        Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, blueball);</span><br><span class="line">        _balls[<span class="number">6</span>] = blueball;</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-5-手动购号"><a href="#3-2-5-手动购号" class="headerlink" title="3.2.5 手动购号"></a>3.2.5 手动购号</h3><p>BallManual.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:BallManual</span></span><br><span class="line"><span class="comment">// Guid:63af13fc-5ad7-4a56-9631-85cbd96ce4bd</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:25:58</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> TwoColorBall.Common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Main</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 手动购号</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BallManual</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Wallet _myWallet = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> WriteData _writeData = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[] _balls = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 手动购号</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Manual</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                    =============================手动购号开始=============================&quot;</span>);</span><br><span class="line">        <span class="built_in">int</span> buytimes = CheckWallet();</span><br><span class="line">        Buy(buytimes);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                    =============================手动购号结束=============================&quot;</span>);</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                                           (你可以选择继续购号或开奖)&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 确认购买注数并判断余额是否可用</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">CheckWallet</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> times = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">int</span> entranceMark = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (entranceMark != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入你要购买几注双色球:&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            times = <span class="built_in">int</span>.Parse(Console.ReadLine() ?? <span class="string">&quot;0&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((<span class="built_in">decimal</span>)times * <span class="number">2</span> &gt; _myWallet.Balance)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t你的账户余额不够购买&#123;0&#125;注双色球，请充值；&quot;</span>, times);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">                _myWallet.RechargeOrConsumptManual();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                entranceMark = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> times;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 购买下注</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;buytimes&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Buy</span>(<span class="params"><span class="built_in">int</span> buytimes</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t你正在手动购买【&#123;0&#125;】注双色球...&quot;</span>, buytimes);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> sequence = <span class="number">1</span>; sequence &lt;= buytimes; sequence++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入第[&#123;0,2&#125;]注你要选择的(1 - 33之间的)6个[红色球]号码：&quot;</span>, sequence.ToString(<span class="string">&quot;D2&quot;</span>));</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            Red();</span><br><span class="line">            Blue();</span><br><span class="line">            Display(sequence);</span><br><span class="line">            Console.Write(<span class="string">&quot;\t【手动购号】&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> time = DateTime.Now.ToString();</span><br><span class="line">            Console.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">            _writeData.RecordBall(<span class="keyword">this</span>.GetType().Name, sequence.ToString(<span class="string">&quot;D2&quot;</span>), _balls, time);</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t系统已为你完成购买【&#123;0,2&#125;】注双色球！&quot;</span>, buytimes);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        _myWallet.RechargeOrConsumptAutomatic(-(<span class="built_in">decimal</span>)buytimes * <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 红色球</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Red</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] redballs = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> ballth = <span class="number">0</span>; ballth &lt; redballs.Length; ballth++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">            Console.Write(<span class="string">&quot;第&#123;0&#125;个红色球：&quot;</span>, ballth + <span class="number">1</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            <span class="comment">// 当前球</span></span><br><span class="line">            <span class="built_in">int</span> currentball = <span class="built_in">int</span>.Parse(Console.ReadLine() ?? <span class="string">&quot;0&quot;</span>);</span><br><span class="line">            <span class="comment">// 检查</span></span><br><span class="line">            currentball = Inspect(ballth, currentball);</span><br><span class="line">            <span class="comment">// 赋值当前球</span></span><br><span class="line">            redballs[ballth] = currentball;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 数字排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; redballs.Length - <span class="number">1</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; redballs.Length - <span class="number">1</span> - i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (redballs[j] &gt; redballs[j + <span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> max = redballs[j];</span><br><span class="line">                    redballs[j] = redballs[j + <span class="number">1</span>];</span><br><span class="line">                    redballs[j + <span class="number">1</span>] = max;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 赋值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; _balls[<span class="number">0.</span><span class="number">.6</span>].Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            _balls[i] = redballs[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 检查数字是否符合</span></span><br><span class="line">        <span class="function"><span class="built_in">int</span> <span class="title">Inspect</span>(<span class="params"><span class="built_in">int</span> iballth, <span class="built_in">int</span> icurrentball</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 判断当前球是否在（1-33）范围内，若不是，重新输入，若是，赋值</span></span><br><span class="line">            <span class="keyword">while</span> (!(icurrentball &gt;= <span class="number">1</span> &amp;&amp; icurrentball &lt;= <span class="number">33</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.Write(<span class="string">&quot;第&#123;0&#125;个红色球：(输入范围错误！[&#123;1&#125;]超出了输入范围,请重新输入(1-33之间)的数)&quot;</span>, iballth + <span class="number">1</span>, icurrentball);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">                icurrentball = <span class="built_in">int</span>.Parse(Console.ReadLine() ?? <span class="string">&quot;0&quot;</span>);</span><br><span class="line">                icurrentball = Inspect(iballth, icurrentball);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 重复序号</span></span><br><span class="line">            <span class="built_in">int</span> repeatSeq = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 重复个数</span></span><br><span class="line">            <span class="built_in">int</span> repeatNum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 重复标记</span></span><br><span class="line">            <span class="built_in">int</span> repeatMark = <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// 判断当前数字与已选择数字是否有重复</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> ith = <span class="number">0</span>; ith &lt; iballth; ith++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (icurrentball == redballs[ith])</span><br><span class="line">                &#123;</span><br><span class="line">                    repeatSeq = ith;</span><br><span class="line">                    repeatNum++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 若有重复，则重新输入</span></span><br><span class="line">            <span class="keyword">if</span> (repeatNum != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 提示第几个数重复</span></span><br><span class="line">                <span class="keyword">while</span> (repeatMark != <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> repeatTips = <span class="string">&quot;除&quot;</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; iballth; i++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 重复数字</span></span><br><span class="line">                        <span class="built_in">string</span> repeatNums = <span class="built_in">string</span>.Empty;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="built_in">int</span> t = <span class="number">0</span>; t &lt;= i; t++)</span><br><span class="line">                        &#123;</span><br><span class="line">                            repeatNums = <span class="string">&quot;[&quot;</span> + Convert.ToString(redballs[t]) + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        repeatTips += repeatNums;</span><br><span class="line">                    &#125;</span><br><span class="line">                    Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                    Console.Write(<span class="string">&quot;第&#123;0&#125;个红色球：(输入重复错误！你购买的第&#123;1&#125;个红色球已存在数字&#123;2&#125;，请重新输入(1-33之间)(&#123;3&#125;)的数)&quot;</span>, iballth + <span class="number">1</span>, repeatSeq + <span class="number">1</span>, icurrentball, repeatTips);</span><br><span class="line">                    icurrentball = <span class="built_in">int</span>.Parse(Console.ReadLine() ?? <span class="string">&quot;0&quot;</span>);</span><br><span class="line">                    Console.ResetColor();</span><br><span class="line">                    icurrentball = Inspect(iballth, icurrentball);</span><br><span class="line">                    repeatMark = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> icurrentball;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 蓝色球</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Blue</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> blueball = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//判断输入数字是否在（1-16）范围内，若是取值，若不是重新输入</span></span><br><span class="line">        <span class="keyword">while</span> (!(blueball &gt;= <span class="number">1</span> &amp;&amp; blueball &lt;= <span class="number">16</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入你要选择的(1-16之间)1个[蓝色球]号码：&quot;</span>);</span><br><span class="line">            Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            blueball = <span class="built_in">int</span>.Parse(Console.ReadLine() ?? <span class="string">&quot;0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        _balls[<span class="number">6</span>] = blueball;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 显示记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Display</span>(<span class="params"><span class="built_in">int</span> sequence</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write(<span class="string">&quot;第【&#123;0,2&#125;】注：&quot;</span>, sequence.ToString(<span class="string">&quot;D2&quot;</span>));</span><br><span class="line">        Console.Write(<span class="string">&quot;红色球：&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; _balls[<span class="number">0.</span><span class="number">.6</span>].Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Task.Delay(<span class="number">50</span>).Wait();</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, _balls[i]);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">        &#125;</span><br><span class="line">        Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">        Task.Delay(<span class="number">50</span>).Wait();</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">        Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, _balls[<span class="number">6</span>]);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-6-开奖"><a href="#3-2-6-开奖" class="headerlink" title="3.2.6 开奖"></a>3.2.6 开奖</h3><p>Lottery.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:Lottery</span></span><br><span class="line"><span class="comment">// Guid:1ae901e8-4a3f-4281-a62f-a2c9a9640396</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:38:22</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> TwoColorBall.Common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Main</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 开奖</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lottery</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Wallet _wallet = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> ReadData _readData = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> WriteData _writeData = <span class="keyword">new</span>();</span><br><span class="line">    <span class="keyword">private</span> Random _random = <span class="keyword">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 购号记录是否存在</span></span><br><span class="line">    <span class="keyword">private</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">bool</span>&gt; _ballIsRecord = <span class="keyword">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模拟奖池</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">decimal</span> _lottery = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 奖池中累积的奖金之和</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">decimal</span> _bonusCumulative = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 奖金总额</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">decimal</span> _bonusTotal = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 单次中奖金额</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">decimal</span> _bonusAmount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 总中奖金额</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">decimal</span> _bonusAmounts = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 中奖号码</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[] _prizeBall = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 中奖总数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[] _prizeCount = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 中奖等级</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _prizeGrade = <span class="built_in">string</span>.Empty;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 开奖入口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Prize</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 删除开奖记录</span></span><br><span class="line">        _readData.DeleteFile(<span class="keyword">this</span>.GetType().Name);</span><br><span class="line">        _readData.DeleteFile(<span class="string">@&quot;PrizeRecord&quot;</span>);</span><br><span class="line">        <span class="comment">// 判断是否开奖</span></span><br><span class="line">        <span class="built_in">bool</span> isPrize = WhetherPrize();</span><br><span class="line">        <span class="comment">// 有购票记录则开奖，没有则不开奖</span></span><br><span class="line">        <span class="keyword">if</span> (isPrize)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.Write(<span class="string">&quot;\t存在购号记录，即将开奖！\n&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                ================模拟开奖开始================&quot;</span>);</span><br><span class="line">            StartPrize();</span><br><span class="line">            ComparativeData();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                ================模拟开奖结束================&quot;</span>);</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.Write(<span class="string">&quot;\t你没有任何形式的购号记录，请先购号后开奖！\n&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 删除购号记录</span></span><br><span class="line">        _readData.DeleteFile(<span class="keyword">typeof</span>(BallAutomatic).Name);</span><br><span class="line">        _readData.DeleteFile(<span class="keyword">typeof</span>(BallManual).Name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 判断是否开奖</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">bool</span> <span class="title">WhetherPrize</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 删除开奖前创建的模拟开奖历史记录</span></span><br><span class="line">        _readData.DeleteFile(<span class="keyword">this</span>.GetType().Name);</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t正在判断是否开奖...&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        <span class="comment">// 判断购号记录是否存在</span></span><br><span class="line">        _ballIsRecord = FindData();</span><br><span class="line">        <span class="built_in">bool</span> isFind = _ballIsRecord.ToList().Any(e =&gt; e.Value == <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> isFind;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 判断是否存在购号记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">bool</span>&gt; <span class="title">FindData</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.Write(<span class="string">&quot;\t正在判断是否存在购号记录...&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">bool</span>&gt; isFind = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">bool</span>&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123; <span class="keyword">typeof</span>(BallAutomatic).Name,<span class="literal">false</span>&#125;,</span><br><span class="line">            &#123; <span class="keyword">typeof</span>(BallManual).Name,<span class="literal">false</span>&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> _readData.FindData(isFind);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 产生开奖号</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">StartPrize</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t正在产生开奖号码...&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        BallAutomatic myBallAutomatic = <span class="keyword">new</span> BallAutomatic();</span><br><span class="line">        Console.Write(<span class="string">&quot;【开奖号码】&quot;</span>);</span><br><span class="line">        Red();</span><br><span class="line">        Blue();</span><br><span class="line">        Console.Write(<span class="string">&quot;\t【模拟开奖】&quot;</span>);</span><br><span class="line">        <span class="built_in">string</span> time = DateTime.Now.ToString();</span><br><span class="line">        Console.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t开奖号码已产生!&quot;</span>);</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.Write(<span class="string">&quot;\t正在计算奖池金额...&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        <span class="comment">// 奖池</span></span><br><span class="line">        _lottery = _random.Next(<span class="number">10000000</span>, <span class="number">999999999</span>);</span><br><span class="line">        <span class="comment">// 奖池中累积的奖金之和</span></span><br><span class="line">        _bonusCumulative = _random.Next(<span class="number">1000000</span>, <span class="number">99999999</span>);</span><br><span class="line">        <span class="comment">// 奖金总额</span></span><br><span class="line">        _bonusTotal = _lottery + _bonusCumulative;</span><br><span class="line">        Task.Delay(<span class="number">1000</span>).Wait();</span><br><span class="line">        Console.Write(<span class="string">&quot;\t本次开奖奖池金额为：&#123;0&#125;元;奖池中累积的奖金之和为：&#123;1&#125;元;奖金总额为：&#123;2&#125;元;&quot;</span>,</span><br><span class="line">             _wallet.FormatMoneyToDecimal(_lottery),</span><br><span class="line">             _wallet.FormatMoneyToDecimal(_bonusCumulative),</span><br><span class="line">             _wallet.FormatMoneyToDecimal(_bonusTotal));</span><br><span class="line">        Console.WriteLine();</span><br><span class="line">        <span class="comment">// 打印模拟开奖记录</span></span><br><span class="line">        _writeData.RecordLottery(<span class="keyword">this</span>.GetType().Name, _prizeBall, time,</span><br><span class="line">            _wallet.FormatMoneyToDecimal(_lottery),</span><br><span class="line">            _wallet.FormatMoneyToDecimal(_bonusCumulative),</span><br><span class="line">            _wallet.FormatMoneyToDecimal(_bonusTotal));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 红色球</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Red</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] redballs = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];</span><br><span class="line">        <span class="comment">// 重复检验</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; redballs.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> ball = _random.Next(<span class="number">1</span>, <span class="number">34</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> (ball == redballs[j])</span><br><span class="line">                &#123;</span><br><span class="line">                    ball = _random.Next(<span class="number">1</span>, <span class="number">34</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            redballs[i] = ball;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 数字排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; redballs.Length - <span class="number">1</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; redballs.Length - <span class="number">1</span> - i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (redballs[j] &gt; redballs[j + <span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> max = redballs[j];</span><br><span class="line">                    redballs[j] = redballs[j + <span class="number">1</span>];</span><br><span class="line">                    redballs[j + <span class="number">1</span>] = max;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 显示记录</span></span><br><span class="line">        Console.Write(<span class="string">&quot;红色球：&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; redballs.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Task.Delay(<span class="number">50</span>).Wait();</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, redballs[i]);</span><br><span class="line">            _prizeBall[i] = redballs[i];</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 蓝色球</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Blue</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> blueball = _random.Next(<span class="number">1</span>, <span class="number">17</span>);</span><br><span class="line">        Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">        Task.Delay(<span class="number">50</span>).Wait();</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">        Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, blueball);</span><br><span class="line">        _prizeBall[<span class="number">6</span>] = blueball;</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 对比数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ComparativeData</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t正在查找数据，请稍候...&quot;</span>);</span><br><span class="line">        Console.ResetColor();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                                        ========查看中奖开始========&quot;</span>);</span><br><span class="line">        <span class="comment">// 查找数据</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> br <span class="keyword">in</span> _ballIsRecord)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> tip = br.Key == <span class="keyword">typeof</span>(BallAutomatic).Name ? <span class="string">&quot;系统购号&quot;</span> : <span class="string">&quot;手动购号&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (br.Value)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;\t查找到<span class="subst">&#123;tip&#125;</span>数据，正在读取...&quot;</span>);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">                JudgeData(br.Key);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;\t你没有<span class="subst">&#123;tip&#125;</span>数据！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断总中奖数</span></span><br><span class="line">        <span class="keyword">if</span> (_prizeCount[<span class="number">6</span>] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t抱歉，你没有中奖！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;\t你共中奖<span class="subst">&#123;_prizeCount[<span class="number">6</span>]&#125;</span>注，获得总奖金：<span class="subst">&#123;_bonusAmounts&#125;</span>元！其中：&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;一等奖<span class="subst">&#123;_prizeCount[<span class="number">0</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;二等奖<span class="subst">&#123;_prizeCount[<span class="number">1</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;三等奖<span class="subst">&#123;_prizeCount[<span class="number">2</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;四等奖<span class="subst">&#123;_prizeCount[<span class="number">3</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;五等奖<span class="subst">&#123;_prizeCount[<span class="number">4</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;六等奖<span class="subst">&#123; _prizeCount[<span class="number">5</span>]&#125;</span>注；&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        _wallet.RechargeOrConsumptAutomatic(_bonusAmounts);</span><br><span class="line">        _writeData.RecordPrizeAmounts(_prizeCount, _wallet.FormatMoneyToDecimal(_bonusAmounts));</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;                                        ========查看中奖结束========&quot;</span>);</span><br><span class="line">        <span class="comment">// 总中奖数清零</span></span><br><span class="line">        Array.Clear(_prizeCount, <span class="number">0</span>, _prizeCount.Length);</span><br><span class="line">        <span class="comment">// 总中奖金额清零</span></span><br><span class="line">        _bonusAmounts = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 判断数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">JudgeData</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 读取行数</span></span><br><span class="line">        <span class="built_in">int</span> rows = _readData.GetRowsCount(name);</span><br><span class="line">        <span class="comment">// 提示</span></span><br><span class="line">        <span class="built_in">string</span> tip = name == <span class="keyword">typeof</span>(BallAutomatic).Name ? <span class="string">&quot;系统购号&quot;</span> : <span class="string">&quot;手动购号&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> everyrow = <span class="number">1</span>; everyrow &lt;= rows; everyrow++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 读取数据</span></span><br><span class="line">            <span class="built_in">string</span>[] datastr = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">4</span>];</span><br><span class="line">            datastr = _readData.ReadBallData(name, everyrow);</span><br><span class="line">            <span class="comment">// 定义一个读取文件后数组，用于比较是否中奖</span></span><br><span class="line">            <span class="built_in">int</span>[] databall = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line">            <span class="comment">// 拆分后的序号</span></span><br><span class="line">            <span class="built_in">string</span> sequence = datastr[<span class="number">1</span>];</span><br><span class="line">            <span class="comment">// 拆分后的红球</span></span><br><span class="line">            <span class="built_in">string</span> redballstr = datastr[<span class="number">2</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                databall[i] = <span class="built_in">int</span>.Parse(redballstr.Substring(i * <span class="number">2</span>, <span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 拆分后的蓝球</span></span><br><span class="line">            databall[<span class="number">6</span>] = <span class="built_in">int</span>.Parse(datastr[<span class="number">3</span>]);</span><br><span class="line">            <span class="comment">// 拆分后的时间</span></span><br><span class="line">            <span class="built_in">string</span> time = datastr[<span class="number">4</span>];</span><br><span class="line">            <span class="comment">// 开奖数字对比之后计数</span></span><br><span class="line">            <span class="built_in">int</span> red = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">int</span> blue = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; _prizeBall.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (_prizeBall[i] == databall[i])</span><br><span class="line">                &#123;</span><br><span class="line">                    _ = i &lt; <span class="number">6</span> ? red++ : blue++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 判断中奖</span></span><br><span class="line">            JudgePrize(sequence, databall, time, tip, red, blue);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 判断中奖</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sequence&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;databall&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;time&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tip&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;red&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;blue&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">JudgePrize</span>(<span class="params"><span class="built_in">string</span> sequence, <span class="built_in">int</span>[] databall, <span class="built_in">string</span> time, <span class="built_in">string</span> tip, <span class="built_in">int</span> red, <span class="built_in">int</span> blue</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 是否输出</span></span><br><span class="line">        <span class="built_in">bool</span> output = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (red == <span class="number">6</span> &amp;&amp; blue == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            _prizeGrade = <span class="string">&quot;一&quot;</span>;</span><br><span class="line">            _bonusAmount = _bonusTotal * <span class="number">0.75</span>m;</span><br><span class="line">            <span class="keyword">if</span> (_bonusAmount &gt;= <span class="number">10000000</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                _bonusAmount = <span class="number">10000000</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            _prizeCount[<span class="number">6</span>]++;</span><br><span class="line">            _prizeCount[<span class="number">0</span>]++;</span><br><span class="line">            output = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (red == <span class="number">6</span> &amp;&amp; blue == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            _prizeGrade = <span class="string">&quot;二&quot;</span>;</span><br><span class="line">            _bonusAmount = _bonusTotal * <span class="number">0.25</span>m;</span><br><span class="line">            <span class="keyword">if</span> (_bonusAmount &gt;= <span class="number">10000000</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                _bonusAmount = <span class="number">5000000</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            _prizeCount[<span class="number">6</span>]++;</span><br><span class="line">            _prizeCount[<span class="number">1</span>]++;</span><br><span class="line">            output = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (red == <span class="number">5</span> &amp;&amp; blue == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            _prizeGrade = <span class="string">&quot;三&quot;</span>;</span><br><span class="line">            _bonusAmount = <span class="number">3000</span>;</span><br><span class="line">            _prizeCount[<span class="number">6</span>]++;</span><br><span class="line">            _prizeCount[<span class="number">2</span>]++;</span><br><span class="line">            output = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((red == <span class="number">5</span> &amp;&amp; blue == <span class="number">0</span>) || (red == <span class="number">4</span> &amp;&amp; blue == <span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            _prizeGrade = <span class="string">&quot;四&quot;</span>;</span><br><span class="line">            _bonusAmount = <span class="number">200</span>;</span><br><span class="line">            _prizeCount[<span class="number">6</span>]++;</span><br><span class="line">            _prizeCount[<span class="number">3</span>]++;</span><br><span class="line">            output = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((red == <span class="number">4</span> &amp;&amp; blue == <span class="number">0</span>) || (red == <span class="number">3</span> &amp;&amp; blue == <span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            _prizeGrade = <span class="string">&quot;五&quot;</span>;</span><br><span class="line">            _bonusAmount = <span class="number">10</span>;</span><br><span class="line">            _prizeCount[<span class="number">6</span>]++;</span><br><span class="line">            _prizeCount[<span class="number">4</span>]++;</span><br><span class="line">            output = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((red == <span class="number">2</span> &amp;&amp; blue == <span class="number">1</span>) || (red == <span class="number">1</span> &amp;&amp; blue == <span class="number">1</span>) || (red == <span class="number">0</span> &amp;&amp; blue == <span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            _prizeGrade = <span class="string">&quot;六&quot;</span>;</span><br><span class="line">            _bonusAmount = <span class="number">5</span>;</span><br><span class="line">            _prizeCount[<span class="number">6</span>]++;</span><br><span class="line">            _prizeCount[<span class="number">5</span>]++;</span><br><span class="line">            output = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (output)</span><br><span class="line">        &#123;</span><br><span class="line">            _bonusAmounts += _bonusAmount;</span><br><span class="line">            <span class="comment">// 中奖输出</span></span><br><span class="line">            Console.Write(<span class="string">&quot;第【&#123;0&#125;】注：红色球：&quot;</span>, sequence);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, databall[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125;&quot;</span>, databall[<span class="number">6</span>]);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            Console.Write(<span class="string">&quot;\t【&#123;0&#125;】&quot;</span>, tip);</span><br><span class="line">            Console.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">            Console.Write(<span class="string">&quot;\t[该注中了&#123;0&#125;等奖！获得奖金：&#123;1&#125;元；]&quot;</span>, _prizeGrade, _wallet.FormatMoneyToDecimal(_bonusAmount));</span><br><span class="line">            _writeData.RecordPrize(sequence, databall, time, tip, _prizeGrade, _wallet.FormatMoneyToDecimal(_bonusAmount));</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-3-Common命名空间"><a href="#3-3-Common命名空间" class="headerlink" title="3.3 Common命名空间"></a>3.3 Common命名空间</h2><h3 id="3-3-1-写数据"><a href="#3-3-1-写数据" class="headerlink" title="3.3.1 写数据"></a>3.3.1 写数据</h3><p>WriteData.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:WriteData</span></span><br><span class="line"><span class="comment">// Guid:c426bd62-1823-4187-8390-904a85be9d62</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:59:57</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Common</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 记录数据</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WriteData</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 购号记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sequence&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;balls&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;time&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RecordBall</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">string</span> sequence, <span class="built_in">int</span>[] balls, <span class="built_in">string</span> time</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 标记值</span></span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> _sequence = <span class="string">&quot;N&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> _red = <span class="string">&quot;R&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> _blue = <span class="string">&quot;B&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> _time = <span class="string">&quot;T&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> filename = name + <span class="string">&quot;.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">using</span> (StreamWriter file = File.AppendText(filename))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> red = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; balls[<span class="number">0.</span><span class="number">.6</span>].Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                red += balls[i].ToString(<span class="string">&quot;D2&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">string</span> blue = balls[<span class="number">6</span>].ToString(<span class="string">&quot;D2&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> <span class="keyword">record</span> = _sequence + sequence + _red + red + _blue + blue + _time + time;</span><br><span class="line">            file.WriteLine(<span class="keyword">record</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 开奖记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;balls&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;time&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;lottery&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RecordLottery</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span>[] balls, <span class="built_in">string</span> time, <span class="built_in">string</span> lottery, <span class="built_in">string</span> bonusCumulative, <span class="built_in">string</span> bonusTotal</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = name + <span class="string">&quot;.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">using</span> (StreamWriter file = File.AppendText(filename))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> red = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; balls[<span class="number">0.</span><span class="number">.6</span>].Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                red += balls[i].ToString(<span class="string">&quot;D2&quot;</span>) + <span class="string">&quot; &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">string</span> blue = balls[<span class="number">6</span>].ToString(<span class="string">&quot;D2&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> <span class="keyword">record</span> = <span class="string">&quot;红色球：&quot;</span> + red + <span class="string">&quot;蓝色球：&quot;</span> + blue;</span><br><span class="line">            file.Write(<span class="string">&quot;【开奖号码】&#123;0&#125;&quot;</span>, <span class="keyword">record</span>);</span><br><span class="line">            file.Write(<span class="string">&quot;\t【模拟开奖】时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">            file.WriteLine();</span><br><span class="line">            file.Write(<span class="string">&quot;\t本次开奖奖池金额为：&#123;0&#125;元;奖池中累积的奖金之和为：&#123;1&#125;元;奖金总额为：&#123;2&#125;元;&quot;</span>, lottery, bonusCumulative, bonusTotal);</span><br><span class="line">            file.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 中奖记录和金额记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;num&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ball&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;time&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;whichball&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RecordPrize</span>(<span class="params"><span class="built_in">string</span> num, <span class="built_in">int</span>[] ball, <span class="built_in">string</span> time, <span class="built_in">string</span> whichball, <span class="built_in">string</span> prizeGrade, <span class="built_in">string</span> prizeAmount</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = <span class="string">@&quot;PrizeRecord.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">using</span> (StreamWriter file = File.AppendText(filename))</span><br><span class="line">        &#123;</span><br><span class="line">            file.Write(<span class="string">&quot;第【&#123;0&#125;】注：红色球：&quot;</span>, num);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                file.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, ball[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            file.Write(<span class="string">&quot;蓝色球：&#123;0,2:D2&#125;&quot;</span>, ball[<span class="number">6</span>]);</span><br><span class="line">            file.Write(<span class="string">&quot;\t【&#123;0&#125;】&quot;</span>, whichball);</span><br><span class="line">            file.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">            file.Write(<span class="string">&quot;\t\t[该注中了&#123;0&#125;等奖！获得奖金：&#123;1&#125;元；]&quot;</span>, prizeGrade, prizeAmount);</span><br><span class="line">            file.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 中奖概括记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;prizeCount&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;prizeAmounts&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RecordPrizeAmounts</span>(<span class="params"><span class="built_in">int</span>[] prizeCount, <span class="built_in">string</span> prizeAmounts</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = <span class="string">@&quot;PrizeRecord.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">using</span> (StreamWriter file = File.AppendText(filename))</span><br><span class="line">        &#123;</span><br><span class="line">            file.WriteLine(<span class="string">$&quot;\t你共中奖<span class="subst">&#123;prizeCount[<span class="number">6</span>]&#125;</span>注，获得总奖金：<span class="subst">&#123;prizeAmounts&#125;</span>元！其中：&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;一等奖<span class="subst">&#123;prizeCount[<span class="number">0</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;二等奖<span class="subst">&#123;prizeCount[<span class="number">1</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;三等奖<span class="subst">&#123;prizeCount[<span class="number">2</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;四等奖<span class="subst">&#123;prizeCount[<span class="number">3</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;五等奖<span class="subst">&#123;prizeCount[<span class="number">4</span>]&#125;</span>注；&quot;</span> +</span><br><span class="line">                <span class="string">$&quot;六等奖<span class="subst">&#123; prizeCount[<span class="number">5</span>]&#125;</span>注；&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-2-读数据"><a href="#3-3-2-读数据" class="headerlink" title="3.3.2 读数据"></a>3.3.2 读数据</h3><p>ReadData.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©2022 ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:ReadData</span></span><br><span class="line"><span class="comment">// Guid:55cd3ffd-3af8-418a-a091-5eb3f6250fb5</span></span><br><span class="line"><span class="comment">// Author:zhaifanhua</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreatTime:2022-05-02 上午 08:41:21</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TwoColorBall.Common</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 读取数据</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ReadData</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 查找文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filename&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">FindFile</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = name + <span class="string">&quot;.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> File.Exists(filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 删除文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DeleteFile</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = name + <span class="string">&quot;.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (File.Exists(filename))</span><br><span class="line">        &#123;</span><br><span class="line">            File.Delete(filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 查找记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ballbuys&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">bool</span>&gt; <span class="title">FindData</span>(<span class="params">Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">bool</span>&gt; ballbuys</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ballbuys.ToDictionary(e =&gt; e.Key, e =&gt; FindFile(e.Key));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取行数</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GetRowsCount</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = name + <span class="string">&quot;.txt&quot;</span>;</span><br><span class="line">        <span class="built_in">int</span> rowsCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">using</span> (StreamReader read = File.OpenText(filename))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> result = read.ReadToEnd();</span><br><span class="line">            rowsCount = result.Split(<span class="string">&#x27;\n&#x27;</span>).Length - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rowsCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 读取数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;row&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span>[] <span class="title">ReadBallData</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span> row</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = name + <span class="string">&quot;.txt&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span>[] data = File.ReadAllLines(filename);</span><br><span class="line">        <span class="built_in">string</span>[] datastr = data[row - <span class="number">1</span>].Split(<span class="keyword">new</span> <span class="built_in">char</span>[<span class="number">4</span>] &#123; <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;T&#x27;</span> &#125;);</span><br><span class="line">        <span class="keyword">return</span> datastr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-源码分享"><a href="#4-源码分享" class="headerlink" title="4. 源码分享"></a>4. 源码分享</h1><h2 id="4-1-源码分享"><a href="#4-1-源码分享" class="headerlink" title="4.1 源码分享"></a>4.1 源码分享</h2><p>github（国际）：<a href="https://github.com/zhaifanhua/DotNet/tree/main/Demo4_TwoColorBall">源码分享</a></p><p>gitlab（国际）：<a href="https://gitlab.com/zhaifanhua/DotNet/-/tree/main/Demo4_TwoColorBall">源码分享</a></p><p>gitee（国内）：<a href="https://gitee.com/zhaifanhua/DotNet/tree/main/Demo4_TwoColorBall">源码分享</a></p><h1 id="5-最后"><a href="#5-最后" class="headerlink" title="5. 最后"></a>5. 最后</h1><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐。</p><p>摘繁华版权所有，转发或引用请附上原文链接哦！</p>]]></content>
      
      
      <categories>
          
          <category> CSharp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
            <tag> .NET </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>本地git仓库提交代码到远程git仓库</title>
      <link href="/2022/04/25/33d92f78cfa9/"/>
      <url>/2022/04/25/33d92f78cfa9/</url>
      
        <content type="html"><![CDATA[<h1 id="本地git仓库提交代码到远程git仓库"><a href="#本地git仓库提交代码到远程git仓库" class="headerlink" title="本地git仓库提交代码到远程git仓库"></a>本地git仓库提交代码到远程git仓库</h1><p>在实际的开发中，有可能遇到需要将A仓库的某个branch的代码独立成为一个新的仓库B。我们需要的不仅仅是这个branch的最新提交的代码，而是需要它的整个提交历史。这种需求对于git来说非常简单，主要依靠<code>git remote</code>命令来实现。</p><h2 id="1-初始化代码仓库提交到远程git仓库"><a href="#1-初始化代码仓库提交到远程git仓库" class="headerlink" title="1.初始化代码仓库提交到远程git仓库"></a>1.初始化代码仓库提交到远程git仓库</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line">git remote add origin git@server_ip:/path/repo.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><h2 id="2-当前代码提交到另一个远程git仓库"><a href="#2-当前代码提交到另一个远程git仓库" class="headerlink" title="2.当前代码提交到另一个远程git仓库"></a>2.当前代码提交到另一个远程git仓库</h2><p>假如仓库repo_a当前位于branch_a，要求将branch_a的整个数据（包括提交历史）全部提取出来，并建立一个新的仓库repo_b。这里假设仓库repo_b已经被建立。<code>git remote add</code>基本语法如下。name和url是必须的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add [-t &lt;branch&gt;] [-m &lt;master&gt;] [-f] [--[no-]tags] [--mirror=&lt;fetch|push&gt;] &lt;name&gt; &lt;url&gt;</span><br></pre></td></tr></table></figure><p>1、 将仓库repo_b的URL添加到工作仓库的remote。<code>origin_repo_b</code>:自己起的名字，只要不与现有的remote名重复即可，<code>git@server_ip:/path/repo_b.git</code>:repo_b的远程路径。</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin_repo_b git<span class="variable">@server_ip</span><span class="symbol">:/path/repo_b</span>.git</span><br></pre></td></tr></table></figure><p>2、将代码推送到远程repo_b。<code>origin_repo_b</code>:远程仓库repo_b的名字，<code>branch_a</code>:仓库repo_a的的branch_a分支。</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">push</span> origin_repo_b branch_a</span><br></pre></td></tr></table></figure><p>3、克隆仓库repo_b，检查是否push成功。</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git<span class="variable">@server_ip</span><span class="symbol">:/path/repo_b</span>.git</span><br></pre></td></tr></table></figure><h2 id="3-一份相同的代码提交到多个不同的git托管服务器（多个git仓库）"><a href="#3-一份相同的代码提交到多个不同的git托管服务器（多个git仓库）" class="headerlink" title="3.一份相同的代码提交到多个不同的git托管服务器（多个git仓库）"></a>3.一份相同的代码提交到多个不同的git托管服务器（多个git仓库）</h2><p>方法非常相似，多使用到了命令<code>git remote set-url --add [--push] &lt;name&gt; &lt;newurl&gt;</code>，假设在远程的git服务器上又新增了一个仓库repo_c，现在要求repo_b、repo_c提交的代码必须一致。<br>1、将远程repo_c配置到当前的工作的本地git仓库中</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote set-url --add origin_repo_b git<span class="variable">@192</span>.<span class="number">168.1</span>.<span class="number">101</span><span class="symbol">:~/project/repo_c</span>.git</span><br></pre></td></tr></table></figure><p>这句话的意思是，将远程仓库<a href="mailto:&#103;&#105;&#x74;&#x40;&#49;&#57;&#x32;&#x2e;&#49;&#x36;&#56;&#46;&#x31;&#46;&#49;&#48;&#x31;">&#103;&#105;&#x74;&#x40;&#49;&#57;&#x32;&#x2e;&#49;&#x36;&#56;&#46;&#x31;&#46;&#49;&#48;&#x31;</a>:~&#x2F;project&#x2F;repo_c.git也加入到origin_repo_b这个名字下面管理</p><p>2、将代码同时提交到远程仓库repo_b和远程仓库repo_c</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">push</span> origin_repo_b branch_a</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202204251057878.png" alt="Snipaste_2021-12-03_23-12-09"></p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为VisualStudio新建文件创建版权日期模板</title>
      <link href="/2022/04/15/1670a3964288/"/>
      <url>/2022/04/15/1670a3964288/</url>
      
        <content type="html"><![CDATA[<h1 id="1-为什么创建模板文件？"><a href="#1-为什么创建模板文件？" class="headerlink" title="1.为什么创建模板文件？"></a>1.为什么创建模板文件？</h1><p>在没有创建模板文件时，VisualStudio默认创建的文件是这样的。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202204160322427.png" alt="image-20220416030359492"></p><p>可以看到，没有任何注释、版权信息和创建日期等。而在创建模板文件后，VisualStudio默认创建的文件是这样的。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202204160322428.png" alt="image-20220416030832732"></p><p>这在后续修改代码文件或多人合作项目时有莫大的好处。下面就来说说怎么创建并修改默认模板。</p><h1 id="2-新建模板文件"><a href="#2-新建模板文件" class="headerlink" title="2.新建模板文件"></a>2.新建模板文件</h1><blockquote><p>注意：我所用环境为<code>Visual Studio 2022</code>，以下模板适合<code>C#10</code>新语法，旧语法及旧版本以类似方法修改。</p></blockquote><h2 id="2-1在空白目录创建以下三个文件："><a href="#2-1在空白目录创建以下三个文件：" class="headerlink" title="2.1在空白目录创建以下三个文件："></a>2.1在空白目录创建以下三个文件：</h2><p><img src="https://cdn.zhaifanhua.com/blog/img/202204160322429.png" alt="image-20220416031825018"></p><p>Class.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©$year$ ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:$safeitemname$</span></span><br><span class="line"><span class="comment">// Guid:$guid1$</span></span><br><span class="line"><span class="comment">// Author:$username$</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreateTime:$time$</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> $<span class="title">rootnamespace</span>$;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> $safeitemrootname$</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> $<span class="title">safeitemrootname</span>$</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Controller.cs <code>这里仅为ApiController</code></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©$year$ ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:$safeitemname$</span></span><br><span class="line"><span class="comment">// Guid:$guid1$</span></span><br><span class="line"><span class="comment">// Author:$username$</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreateTime:$time$</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Http;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> $<span class="title">rootnamespace</span>$;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> $safeitemrootname$</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> $<span class="title">safeitemname</span>$ : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Interface.cs</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Copyright ©$year$ ZhaiFanhua All Rights Reserved.</span></span><br><span class="line"><span class="comment">// FileName:$safeitemname$</span></span><br><span class="line"><span class="comment">// Guid:$guid1$</span></span><br><span class="line"><span class="comment">// Author:$username$</span></span><br><span class="line"><span class="comment">// Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="comment">// CreateTime:$time$</span></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> $<span class="title">rootnamespace</span>$;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> $safeitemrootname$</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> $<span class="title">safeitemrootname</span>$</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-2找到模板目录并复制"><a href="#2-2找到模板目录并复制" class="headerlink" title="2.2找到模板目录并复制"></a>2.2找到模板目录并复制</h2><p>例如安装的Visual Studio 2022在C盘，则对应的模板目录在：</p><p>【Class】</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\ItemTemplates\CSharp\Code\2052\Class</span><br><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\ItemTemplates\AspNetCore\Code\1033\Class</span><br></pre></td></tr></table></figure><p>【Interface】</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\ItemTemplates\CSharp\Code\2052\Interface</span><br><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\ItemTemplates\AspNetCore\Code\1033\Interface</span><br></pre></td></tr></table></figure><p>【Controller】</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\ItemTemplates\AspNetCore\Web\ASP.NET\1033\WebApiEmptyController</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VisualStudio </tag>
            
            <tag> CSharp </tag>
            
            <tag> DotNet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>彻底的卸载干净oracle 11g</title>
      <link href="/2022/03/07/81dd1523f24f/"/>
      <url>/2022/03/07/81dd1523f24f/</url>
      
        <content type="html"><![CDATA[<h1 id="彻底的卸载干净oracle-11g"><a href="#彻底的卸载干净oracle-11g" class="headerlink" title="彻底的卸载干净oracle 11g"></a>彻底的卸载干净oracle 11g</h1><p>1.关闭oracle所有的服务。可以在windows的服务管理器中关闭；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202203071924697.png" alt="img"></p><p>2.打开注册表：regedit 打开路径： &lt;找注册表 ：开始-&gt;运行-&gt;regedit&gt;<br>  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\<br>  删除该路径下的所有以oracle开始的服务名称，这个键是标识Oracle在windows下注册的各种服务。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202203071924461.png" alt="img"></p><p>3.打开注册表，找到路径：<br>  HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE<br>  删除该oracle目录，该目录下注册着Oracle数据库的软件安装信息。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202203071925216.png" alt="img"></p><p>4.删除注册的oracle事件日志，打开注册表<br>  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application<br>  删除注册表的以oracle开头的所有项目。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202203071925464.png" alt="img"></p><p>5.删除环境变量path中关于oracle的内容。<br>  鼠标右键右单击“我的电脑–&gt;属性–&gt;高级–&gt;环境变量–&gt;PATH 变量。<br>  删除Oracle在该值中的内容。注意:path中记录着一堆操作系统的目录，在windows中各个目录之间使用分号（;）隔开的，删除时注意。<br>  建议：删除PATH环境变量中关于Oracle的值时，将该值全部拷贝到文本编辑器中，找到对应的Oracle的值，删除后，再拷贝修改的串，<br>             粘贴到PATH环境变量中，这样相对而言比较安全。</p><p>​       <img src="https://cdn.zhaifanhua.com/blog/img/202203071925661.png" alt="img"></p><p><img src="https://cdn.zhaifanhua.com/blog/img/202203071925818.png" alt="img"></p><p>6.重新启动操作系统。<br>          以上1~5个步骤操作完毕后，重新启动操作系统。</p><p>7.重启操作系统后各种Oracle相关的进程都不会加载了。这时删除Oracle_Home下的所有数据。<br>   （Oracle_Home指Oracle程序的安装目录）</p><p>8.删除C:\Program Files下oracle目录。<br>    （该目录视Oracle安装所在路径而定）</p><p>9.删除开始菜单下oracle项，如：<br>   C:\Documents and Settings\All Users\「开始」菜单\程序\Oracle - Ora10g<br>   不同的安装这个目录稍有不同。<br>   如果不删除开始菜单下的Oracle相关菜单目录，没关系，这个不影响再次安装Oracle.当再次安装Oracle时，该菜单会被替换。</p><p>至此，Windows平台下Oracle就彻底卸载了。 </p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS上部署自己的DotNet项目</title>
      <link href="/2021/09/30/0e2f883f982a/"/>
      <url>/2021/09/30/0e2f883f982a/</url>
      
        <content type="html"><![CDATA[<h1 id="CentOS上部署自己的DotNet项目"><a href="#CentOS上部署自己的DotNet项目" class="headerlink" title="CentOS上部署自己的DotNet项目"></a>CentOS上部署自己的DotNet项目</h1><h2 id="1-查看环境"><a href="#1-查看环境" class="headerlink" title="1.查看环境"></a>1.查看环境</h2><blockquote><p>这里我的服务器系统是Linux【CentOS Stream 9】，具体版本对应的安装包请【<a href="https://docs.microsoft.com/zh-cn/dotnet/core/install">查看官网</a>】,暂以CentOS Stream 9为例。</p></blockquote><p>通过以下命令查看系统版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a </span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230253803.png" alt="image-20220723025233825"></p><h2 id="2-安装-DotNet"><a href="#2-安装-DotNet" class="headerlink" title="2.安装 DotNet"></a>2.安装 DotNet</h2><p>.NET 包含在 CentOS Stream 9 的 AppStream 存储库中。 但是，.NET Core 3.1 和 .NET 5 已从 CentOS Stream 9 中删除，因此应使用 .NET 6。 有关详细信息，请参阅博客文章<a href="https://omairmajid.com/posts/2021-08-25-using-.net-in-centos-stream-9/">在 CentOS Stream 9 中将 .NET 与 OpenSSL 结合使用 | Omair Majid</a>。</p><h3 id="2-1-安装-SDK"><a href="#2-1-安装-SDK" class="headerlink" title="2.1.安装 SDK"></a>2.1.安装 SDK</h3><p>.NET SDK 使你可以通过 .NET 开发应用。 如果安装 .NET SDK，则无需安装相应的运行时。 若要安装 .NET SDK，请运行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf install dotnet-sdk-6.0</span><br></pre></td></tr></table></figure><h3 id="2-2-安装运行时"><a href="#2-2-安装运行时" class="headerlink" title="2.2.安装运行时"></a>2.2.安装运行时</h3><p>通过 ASP.NET Core 运行时，可以运行使用 .NET 开发且未提供运行时的应用。 以下命令将安装 ASP.NET Core 运行时，这是与 .NET 最兼容的运行时。 在终端中，运行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf install aspnetcore-runtime-6.0</span><br></pre></td></tr></table></figure><p>作为 ASP.NET Core 运行时的一种替代方法，你可以安装不包含 ASP.NET Core 支持的 .NET 运行时：将上一命令中的 <code>aspnetcore-runtime-6.0</code> 替换为 <code>dotnet-runtime-6.0</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf install dotnet-runtime-6.0</span><br></pre></td></tr></table></figure><h2 id="3-检查-SDK-版本"><a href="#3-检查-SDK-版本" class="headerlink" title="3.检查 SDK 版本"></a>3.检查 SDK 版本</h2><p>可使用终端查看当前安装的 .NET SDK 版本。 打开终端并运行以下命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet --list-sdks</span><br></pre></td></tr></table></figure><h2 id="4-检查运行时版本"><a href="#4-检查运行时版本" class="headerlink" title="4.检查运行时版本"></a>4.检查运行时版本</h2><p>可使用以下命令查看当前安装的 .NET 运行时版本。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet --list-runtimes</span><br></pre></td></tr></table></figure><h2 id="5-挂载服务"><a href="#5-挂载服务" class="headerlink" title="5.挂载服务"></a>5.挂载服务</h2><blockquote><p>假如你有一个 DotNet 项目叫做【ZhaiFanhuaBlog】，部署上传在服务器的【&#x2F;home&#x2F;web&#x2F;zhaifanhua.com&#x2F;demo&#x2F;ZhaiFanhuaBlog&#x2F;】路径下。</p><p>该项目可执行文件名称是【ZhaiFanhuaBlog.WebApi.dll】，你想用ip【127.0.0.1】，url【http:&#x2F;&#x2F;*:9708】来访问。</p></blockquote><p>把 DotNet 也变成一个像mysql，nginx一样的后台服务，用systemctl来管理。可以这样配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 编辑配置文件</span><br><span class="line">vim /usr/lib/systemd/system/ZhaiFanhuaBlog.service</span><br></pre></td></tr></table></figure><h3 id="5-1-编辑输入："><a href="#5-1-编辑输入：" class="headerlink" title="5.1.编辑输入："></a>5.1.编辑输入：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=ZhaiFanhuaBlog</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">WorkingDirectory=/home/web/zhaifanhua.com/demo/ZhaiFanhuaBlog/</span><br><span class="line">ExecStart=dotnet /home/web/zhaifanhua.com/demo/ZhaiFanhuaBlog/ZhaiFanhuaBlog.WebApi.dll --urls=&quot;http://*:9708&quot; --ip=&quot;127.0.0.1&quot;</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=10</span><br><span class="line">KillSignal=SIGINT</span><br><span class="line">SyslogIdentifier=ZhaiFanhuaImage</span><br><span class="line">User=root</span><br><span class="line">Environment=ASPNETCORE_ENVIRONMENT=Production</span><br><span class="line">Environment=DOTNET_PRINT_TELEMETRY_MESSAGE=false</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><h3 id="5-2-更新配置"><a href="#5-2-更新配置" class="headerlink" title="5.2.更新配置"></a>5.2.更新配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure><h3 id="5-3-进程守护"><a href="#5-3-进程守护" class="headerlink" title="5.3.进程守护"></a>5.3.进程守护</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 设置开机自启动</span><br><span class="line">systemctl enable ZhaiFanhuaBlog</span><br><span class="line"># 停止开机自启动</span><br><span class="line">systemctl disable ZhaiFanhuaBlog</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230253804.png" alt="image-20220723024239729"></p><h3 id="5-4-管理命令"><a href="#5-4-管理命令" class="headerlink" title="5.4.管理命令"></a>5.4.管理命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 启动服务</span><br><span class="line">systemctl start ZhaiFanhuaBlog</span><br><span class="line"># 停止服务</span><br><span class="line">systemctl stop ZhaiFanhuaBlog</span><br><span class="line"># 重新服务</span><br><span class="line">systemctl restart ZhaiFanhuaBlog</span><br><span class="line"># 查看状态</span><br><span class="line">systemctl status ZhaiFanhuaBlog</span><br></pre></td></tr></table></figure><p> <img src="https://cdn.zhaifanhua.com/blog/img/202207230253805.png" alt="image-20220723024148230"></p><h2 id="6-访问"><a href="#6-访问" class="headerlink" title="6.访问"></a>6.访问</h2><h3 id="6-1-直接用ip访问"><a href="#6-1-直接用ip访问" class="headerlink" title="6.1.直接用ip访问"></a>6.1.直接用ip访问</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230253807.png" alt="image-20220723024823675"></p><h3 id="6-2-用-Nginx-反代，用域名访问"><a href="#6-2-用-Nginx-反代，用域名访问" class="headerlink" title="6.2.用 Nginx 反代，用域名访问"></a>6.2.用 Nginx 反代，用域名访问</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202207230253808.png" alt="image-20220723025002294"></p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DotNet </tag>
            
            <tag> CentOS </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux操作系统查看系统信息</title>
      <link href="/2021/09/02/0c008dd2a9ae/"/>
      <url>/2021/09/02/0c008dd2a9ae/</url>
      
        <content type="html"><![CDATA[<h3 id="1、CPU信息"><a href="#1、CPU信息" class="headerlink" title="1、CPU信息"></a>1、CPU信息</h3><p>Linux下的CPU信息全部都在&#x2F;proc&#x2F;cpuinfo这个文件中，可以直接打开看。</p><p>总核数 &#x3D; 物理CPU个数 X 每颗物理CPU的核数<br>总逻辑CPU数 &#x3D; 物理CPU个数 X 每颗物理CPU的核数 X 超线程数</p><p>判断是否开启了超线程：<br>如果多个逻辑CPU的”physical id”和”core id”均相同，说明开启了超线程<br>或者换句话说：<br>逻辑CPU个数 &gt; 物理CPU个数 * CPU内核数 开启了超线程<br>逻辑CPU个数 &#x3D; 物理CPU个数 * CPU内核数 没有开启超线程</p><p>（1）查看物理CPU的个数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo |grep &quot;physical id&quot;|sort |uniq|wc -l</span><br><span class="line"># 或</span><br><span class="line">grep &quot;physical id&quot; /proc/cpuinfo|sort -u</span><br><span class="line"># 或</span><br><span class="line">grep &#x27;physical id&#x27; /proc/cpuinfo | sort -u | wc –l</span><br></pre></td></tr></table></figure><p>（2）查看每个物理CPU中core的个数(即核数)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo| grep &quot;cpu cores&quot;| uniq</span><br><span class="line"># 或</span><br><span class="line">cat /proc/cpuinfo |grep &quot;cores&quot;|uniq</span><br><span class="line"># 或</span><br><span class="line">grep &#x27;core id&#x27; /proc/cpuinfo | sort -u | wc -l</span><br></pre></td></tr></table></figure><p>（3）查看逻辑CPU的个数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo| grep &quot;processor&quot;| wc -l</span><br></pre></td></tr></table></figure><p>（4）查看线程数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &#x27;processor&#x27; /proc/cpuinfo | sort -u | wc -l</span><br></pre></td></tr></table></figure><p>（5）查看CPU信息（型号）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq –c</span><br></pre></td></tr></table></figure><p>（6）查看各个物理CPU上面封装的逻辑处理器（即超线程后的CPU）个数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep siblings</span><br></pre></td></tr></table></figure><p>（7）查看CPU的主频</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo |grep MHz|uniq</span><br></pre></td></tr></table></figure><p>（8）linux CPU大小</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo |grep &quot;model name&quot; &amp;&amp; cat /proc/cpuinfo |grep &quot;physical id&quot;</span><br></pre></td></tr></table></figure><p>说明：Linux下可以在&#x2F;proc&#x2F;cpuinfo中看到每个cpu的详细信息。但是对于双核的cpu，在cpuinfo中会看到两个cpu。常常会让人误以为是两个单核的cpu。其实应该通过Physical Processor ID来区分单核和双核。而Physical Processor ID可以从cpuinfo或者dmesg中找到。flags 如果有 ht 说明支持超线程技术。判断物理CPU的个数可以查看physical id 的值，相同则为同一个物理CPU。<br>如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">model name: Intel(R) Xeon(TM) CPU 2.80GHz</span><br><span class="line">model name: Intel(R) Xeon(TM) CPU 2.80GHz</span><br><span class="line">model name: Intel(R) Xeon(TM) CPU 2.80GHz</span><br><span class="line">model name: Intel(R) Xeon(TM) CPU 2.80GHz</span><br><span class="line">physical id : 0</span><br><span class="line">physical id : 0</span><br><span class="line">physical id : 3</span><br><span class="line">physical id : 3</span><br></pre></td></tr></table></figure><p>可以看到上面，这台机器有两个双核的CPU，ID分别是0和3，大小是2.8G。</p><h3 id="2、查看内存信息"><a href="#2、查看内存信息" class="headerlink" title="2、查看内存信息"></a>2、查看内存信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/meminfo</span><br></pre></td></tr></table></figure><h3 id="3、-内存大小"><a href="#3、-内存大小" class="headerlink" title="3、 内存大小"></a>3、 内存大小</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/meminfo |grep MemTotal</span><br></pre></td></tr></table></figure><h3 id="4、硬盘大小"><a href="#4、硬盘大小" class="headerlink" title="4、硬盘大小"></a>4、硬盘大小</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l |grep Disk</span><br></pre></td></tr></table></figure><h3 id="5、查看主板型号"><a href="#5、查看主板型号" class="headerlink" title="5、查看主板型号"></a>5、查看主板型号</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmidecode |grep -A16 &quot;System Information$&quot;</span><br></pre></td></tr></table></figure><h3 id="6、查看机器型号"><a href="#6、查看机器型号" class="headerlink" title="6、查看机器型号"></a>6、查看机器型号</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmidecode | grep &quot;Product Name&quot;</span><br></pre></td></tr></table></figure><h3 id="7、查看当前操作系统内核信息"><a href="#7、查看当前操作系统内核信息" class="headerlink" title="7、查看当前操作系统内核信息"></a>7、查看当前操作系统内核信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure><h3 id="8、查看当前操作系统发行版信息"><a href="#8、查看当前操作系统发行版信息" class="headerlink" title="8、查看当前操作系统发行版信息"></a>8、查看当前操作系统发行版信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/issue | grep Linux</span><br></pre></td></tr></table></figure><h3 id="9、-更多查看linux硬件信息的方法"><a href="#9、-更多查看linux硬件信息的方法" class="headerlink" title="9、 更多查看linux硬件信息的方法"></a>9、 更多查看linux硬件信息的方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">uname -a # 查看内核/操作系统/CPU信息的linux系统信息命令</span><br><span class="line">head -n 1 /etc/issue # 查看操作系统版本，是数字1不是字母L</span><br><span class="line">cat /proc/cpuinfo # 查看CPU信息的linux系统信息命令</span><br><span class="line">hostname # 查看计算机名的linux系统信息命令</span><br><span class="line">lspci -tv # 列出所有PCI设备</span><br><span class="line">lsusb -tv # 列出所有USB设备的linux系统信息命令</span><br><span class="line">lsmod # 列出加载的内核模块</span><br><span class="line">env # 查看环境变量资源</span><br><span class="line">free -m # 查看内存使用量和交换区使用量</span><br><span class="line">df -h # 查看各分区使用情况</span><br><span class="line">du -sh # 查看指定目录的大小</span><br><span class="line">grep MemTotal /proc/meminfo # 查看内存总量</span><br><span class="line">grep MemFree /proc/meminfo # 查看空闲内存量</span><br><span class="line">uptime # 查看系统运行时间、用户数、负载</span><br><span class="line">cat /proc/loadavg # 查看系统负载磁盘和分区</span><br><span class="line">mount | column -t # 查看挂接的分区状态</span><br><span class="line">fdisk -l # 查看所有分区</span><br><span class="line">swapon -s # 查看所有交换分区</span><br><span class="line">hdparm -i /dev/hda # 查看磁盘参数(仅适用于IDE设备)</span><br><span class="line">dmesg | grep IDE # 查看启动时IDE设备检测状况网络</span><br><span class="line">ifconfig # 查看所有网络接口的属性</span><br><span class="line">iptables -L # 查看防火墙设置</span><br><span class="line">route -n # 查看路由表</span><br><span class="line">netstat -lntp # 查看所有监听端口</span><br><span class="line">netstat -antp # 查看所有已经建立的连接</span><br><span class="line">netstat -s # 查看网络统计信息进程</span><br><span class="line">ps -ef # 查看所有进程</span><br><span class="line">top # 实时显示进程状态用户</span><br><span class="line">w # 查看活动用户</span><br><span class="line">id # 查看指定用户信息</span><br><span class="line">last # 查看用户登录日志</span><br><span class="line">cut -d: -f1 /etc/passwd # 查看系统所有用户</span><br><span class="line">cut -d: -f1 /etc/group # 查看系统所有组</span><br><span class="line">crontab -l # 查看当前用户的计划任务服务</span><br><span class="line">chkconfig –list # 列出所有系统服务</span><br><span class="line">chkconfig –list | grep on # 列出所有启动的系统服务程序</span><br><span class="line">rpm -qa # 查看所有安装的软件包</span><br><span class="line">cat /proc/cpuinfo # 查看CPU相关参数的linux系统命令</span><br><span class="line">cat /proc/partitions # 查看linux硬盘和分区信息的系统信息命令</span><br><span class="line">cat /proc/meminfo # 查看linux系统内存信息的linux系统命令</span><br><span class="line">cat /proc/version # 查看版本，类似uname -r</span><br><span class="line">cat /proc/ioports # 查看设备io端口</span><br><span class="line">cat /proc/interrupts # 查看中断</span><br><span class="line">cat /proc/pci # 查看pci设备的信息</span><br><span class="line">cat /proc/swaps # 查看所有swap分区的信息</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cloudreve的搭建</title>
      <link href="/2021/08/25/b8dcb6cb1c90/"/>
      <url>/2021/08/25/b8dcb6cb1c90/</url>
      
        <content type="html"><![CDATA[<h1 id="1-获取-Cloudreve"><a href="#1-获取-Cloudreve" class="headerlink" title="1.获取 Cloudreve"></a>1.获取 Cloudreve</h1><p>你可以在 <a href="https://github.com/cloudreve/Cloudreve/releases">GitHub Release</a> 页面获取已经构建打包完成的主程序。其中每个版本都提供了常见系统架构下可用的主程序，命名规则为<code>cloudreve_版本号_操作系统_CPU架构.tar.gz</code> 。比如，普通64位Linux系统上部署3.0.0版本，则应该下载<code>cloudreve_3.0.0_linux_amd64.tar.gz</code>。</p><p>如果你想体验最新的功能特性，可以在 <a href="https://github.com/cloudreve/Cloudreve/actions">GitHub Actions</a> 中下载每次 commit 后构建的开发版。注意，开发版并不稳定，无法用于生产用途，且不保证完全可用。获取 Cloudreve</p><p>你可以在 <a href="https://github.com/cloudreve/Cloudreve/releases">GitHub Release</a> 页面获取已经构建打包完成的主程序。其中每个版本都提供了常见系统架构下可用的主程序，命名规则为<code>cloudreve_版本号_操作系统_CPU架构.tar.gz</code> 。比如，普通64位Linux系统上部署3.0.0版本，则应该下载<code>cloudreve_3.0.0_linux_amd64.tar.gz</code>。</p><p>如果你想体验最新的功能特性，可以在 <a href="https://github.com/cloudreve/Cloudreve/actions">GitHub Actions</a> 中下载每次 commit 后构建的开发版。注意，开发版并不稳定，无法用于生产用途，且不保证完全可用。</p><h1 id="2-启动-Cloudreve"><a href="#2-启动-Cloudreve" class="headerlink" title="2.启动 Cloudreve"></a>2.启动 Cloudreve</h1><p>Linux下，直接解压并执行主程序即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#解压获取到的主程序</span><br><span class="line">tar -zxvf cloudreve_VERSION_OS_ARCH.tar.gz</span><br><span class="line"># 赋予执行权限</span><br><span class="line">chmod +x ./cloudreve</span><br><span class="line"># 启动Cloudreve</span><br><span class="line">./cloudreve</span><br></pre></td></tr></table></figure><p>Cloudreve 在首次启动时，会创建初始管理员账号，请注意保管管理员密码，此密码只会在首次启动时出现。如果您忘记初始管理员密码，需要删除同级目录下的<code>cloudreve.db</code>，重新启动主程序以初始化新的管理员账户。</p><p>Cloudreve 默认会监听<code>5212</code>端口。你可以在浏览器中访问<code>http://服务器IP:5212</code>进入 Cloudreve。</p><p>以上步骤操作完后，最简单的部署就完成了。你可能需要一些更为具体的配置，才能让Cloudreve更好的工作，具体流程请参考下面的配置流程。</p><h1 id="3-可选部署流程"><a href="#3-可选部署流程" class="headerlink" title="3.可选部署流程"></a>3.可选部署流程</h1><h2 id="3-1-反向代理"><a href="#3-1-反向代理" class="headerlink" title="3.1.反向代理"></a>3.1.反向代理</h2><p>在自用或者小规模使用的场景下，你完全可以使用 Cloudreve 内置的 Web 服务器。但是如果你需要使用HTTPS，亦或是需要与服务器上其他 Web 服务共存时，你可能需要使用主流 Web 服务器反向代理 Cloudreve ，以获得更丰富的扩展功能。</p><p>你需要在Web服务器中新建一个虚拟主机，完成所需的各项配置（如启用HTTPS），然后在网站配置文件中加入反代规则：</p><p>NGINX，在网站的<code>server</code>字段中加入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    proxy_set_header Host $http_host;</span><br><span class="line">    proxy_redirect off;</span><br><span class="line">    proxy_pass http://127.0.0.1:5212;</span><br><span class="line"></span><br><span class="line">    # 如果您要使用本地存储策略，请将下一行注释符删除，并更改大小为理论最大文件尺寸</span><br><span class="line">    # client_max_body_size 20000m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2-进程守护"><a href="#3-2-进程守护" class="headerlink" title="3.2.进程守护"></a>3.2.进程守护</h2><h3 id="3-2-1-Systemd"><a href="#3-2-1-Systemd" class="headerlink" title="3.2.1.Systemd"></a>3.2.1.Systemd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 编辑配置文件</span><br><span class="line">vim /usr/lib/systemd/system/cloudreve.service</span><br></pre></td></tr></table></figure><p>将下文 <code>PATH_TO_CLOUDREVE</code> 更换为程序所在目录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Cloudreve</span><br><span class="line">Documentation=https://docs.cloudreve.org</span><br><span class="line">After=network.target</span><br><span class="line">After=mysqld.service</span><br><span class="line">Wants=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">WorkingDirectory=/PATH_TO_CLOUDREVE</span><br><span class="line">ExecStart=/PATH_TO_CLOUDREVE/cloudreve</span><br><span class="line">Restart=on-abnormal</span><br><span class="line">RestartSec=5s</span><br><span class="line">KillMode=mixed</span><br><span class="line"></span><br><span class="line">StandardOutput=null</span><br><span class="line">StandardError=syslog</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><h3 id="3-2-2-更新配置和启动服务"><a href="#3-2-2-更新配置和启动服务" class="headerlink" title="3.2.2.更新配置和启动服务"></a>3.2.2.更新配置和启动服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 更新配置</span><br><span class="line">systemctl daemon-reload</span><br><span class="line"># 启动服务</span><br><span class="line">systemctl start cloudreve</span><br><span class="line"># 设置开机启动</span><br><span class="line">systemctl enable cloudreve</span><br></pre></td></tr></table></figure><h3 id="3-2-3-启动报错情况处理"><a href="#3-2-3-启动报错情况处理" class="headerlink" title="3.2.3.启动报错情况处理"></a>3.2.3.启动报错情况处理</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/202202151121393.png" alt="image-20220215104701510"></p><p>原因：是selinux中间移动了位置，导致selinux的安全上下文没切换，报权限不足。</p><p>解决办法：关掉selinux。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getenforce</span><br></pre></td></tr></table></figure><p>如果为disabled 就是已经关闭，如果enforce 就是强制的模式。</p><p>（方法1）不重启的头闭，重启电脑后失效。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setenforce　0</span><br></pre></td></tr></table></figure><p>（方法2）重启电脑的关闭，重启电脑，永久生效。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/selinux/config</span><br><span class="line"># 把SELINUX=enforce改成disabled就可以了</span><br></pre></td></tr></table></figure><h1 id="4-管理命令："><a href="#4-管理命令：" class="headerlink" title="4.管理命令："></a>4.管理命令：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 启动服务</span><br><span class="line">systemctl start cloudreve</span><br><span class="line"># 停止服务</span><br><span class="line">systemctl stop cloudreve</span><br><span class="line"># 重启服务</span><br><span class="line">systemctl restart cloudreve</span><br><span class="line"># 查看状态</span><br><span class="line">systemctl status cloudreve</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202108181552967.png" alt="image-20210818155215456"></p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网盘 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitLab的安装与部署</title>
      <link href="/2021/08/18/99467d836556/"/>
      <url>/2021/08/18/99467d836556/</url>
      
        <content type="html"><![CDATA[<h2 id="1-GitLab介绍"><a href="#1-GitLab介绍" class="headerlink" title="1.GitLab介绍"></a>1.GitLab介绍</h2><h4 id="1-1-GitLab："><a href="#1-1-GitLab：" class="headerlink" title="1.1.GitLab："></a>1.1.GitLab：</h4><blockquote><p>是一个基于Git实现的在线代码仓库托管软件，你可以用gitlab自己搭建一个类似于Github一样的系统，一般用于在企业、学校等内部网络搭建git私服。</p></blockquote><ul><li>功能：Gitlab 是一个提供代码托管、提交审核和问题跟踪的代码管理平台。对于软件工程质量管理非常重要。</li><li>版本：GitLab 分为社区版（CE） 和企业版（EE）。</li><li>配置：建议CPU2核，内存2G以上。</li></ul><h4 id="1-2-Gitlab的服务构成："><a href="#1-2-Gitlab的服务构成：" class="headerlink" title="1.2.Gitlab的服务构成："></a>1.2.Gitlab的服务构成：</h4><ul><li>Nginx：静态web服务器。</li><li>gitlab-shell：用于处理Git命令和修改authorized keys列表。（Ruby）</li><li>gitlab-workhorse: 轻量级的反向代理服务器。（go，GitLab Workhorse是一个敏捷的反向代理。它会处理一些大的HTTP请求，比如文件上传、文件下载、Git push&#x2F;pull和Git包下载。其它请求会反向代理到GitLab Rails应用，即反向代理给后端的unicorn。)</li><li>logrotate：日志文件管理工具。</li><li>postgresql：数据库。</li><li>redis：缓存数据库。</li><li>sidekiq：用于在后台执行队列任务（异步执行）。（Ruby）</li><li>unicorn：An HTTP server for Rack applications，GitLab Rails应用是托管在这个服务器上面的。（Ruby Web Server,主要使用Ruby编写）</li></ul><h2 id="2-GitLab安装"><a href="#2-GitLab安装" class="headerlink" title="2.GitLab安装"></a>2.GitLab安装</h2><h4 id="2-1-源码安装"><a href="#2-1-源码安装" class="headerlink" title="2.1.源码安装"></a>2.1.源码安装</h4><h5 id="2-1-1-安装并配置必要的依赖"><a href="#2-1-1-安装并配置必要的依赖" class="headerlink" title="2.1.1.安装并配置必要的依赖"></a>2.1.1.安装并配置必要的依赖</h5><p>在 CentOS 7（和 RedHat&#x2F;Oracle&#x2F;Scientific Linux 7）上，下面的命令也会在系统防火墙中打开 HTTP、HTTPS 和 SSH 访问。这是一个可选步骤，如果您打算仅从本地网络访问 GitLab，则可以跳过它。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y curl policycoreutils-python openssh-server perl</span><br><span class="line"># 如果未启用，则启用OpenSSH服务器守护程序：sudo systemctl status sshd</span><br><span class="line">sudo systemctl enable sshd</span><br><span class="line">sudo systemctl start sshd</span><br><span class="line"></span><br><span class="line"># 检查是否需要打开防火墙：sudo systemctl status firewalld</span><br><span class="line">sudo firewall-cmd --permanent --add-service=http</span><br><span class="line">sudo firewall-cmd --permanent --add-service=https</span><br><span class="line">sudo systemctl reload firewalld</span><br></pre></td></tr></table></figure><p>接下来，安装 Postfix 以发送通知电子邮件。如果您想使用其他解决方案发送电子邮件，请跳过此步骤并在安装 GitLab 后<a href="https://docs.gitlab.com/omnibus/settings/smtp.html">配置外部 SMTP 服务器</a>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install postfix</span><br><span class="line">sudo systemctl enable postfix</span><br><span class="line">sudo systemctl start postfix</span><br></pre></td></tr></table></figure><p>在 Postfix 安装过程中，可能会出现一个配置屏幕。选择“Internet 站点”并按 Enter。</p><p>将您服务器的外部 DNS 用于“邮件名称”，然后按 Enter。如果出现其他屏幕，请继续按 Enter 接受默认值。</p><h5 id="2-1-2-添加GitLab包仓库并安装包"><a href="#2-1-2-添加GitLab包仓库并安装包" class="headerlink" title="2.1.2.添加GitLab包仓库并安装包"></a>2.1.2.添加GitLab包仓库并安装包</h5><p>添加 GitLab 包存储库。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></figure><p>接下来，安装 GitLab 包。确保您已正确<a href="https://docs.gitlab.com/omnibus/settings/dns.html">设置 DNS</a>，并更改<code>https://gitlab.example.com</code>为您要访问 GitLab 实例的 URL。安装将在该 URL 上自动配置和启动 GitLab。<br>对于<code>https://</code>URL，GitLab 将<a href="https://docs.gitlab.com/omnibus/settings/ssl.html#lets-encrypthttpsletsencryptorg-integration">使用 Let’s Encrypt</a>自动<a href="https://docs.gitlab.com/omnibus/settings/ssl.html#lets-encrypthttpsletsencryptorg-integration">请求证书</a>，这需要入站 HTTP 访问和<a href="https://docs.gitlab.com/omnibus/settings/dns.html">有效的主机名</a>。您也可以<a href="https://docs.gitlab.com/omnibus/settings/nginx.html#manually-configuring-https">使用自己的证书</a>或仅使用<code>http://</code>（不带<code>s</code>）。<br>如果您想为初始管理员用户 ( <code>root</code>)指定自定义密码，请查看<a href="https://docs.gitlab.com/omnibus/installation/index.html#set-up-the-initial-password">文档</a>。如果未指定密码，将自动生成随机密码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo EXTERNAL_URL=&quot;https://gitlab.example.com&quot; yum install -y gitlab-ee</span><br></pre></td></tr></table></figure><h5 id="2-1-3-浏览到主机名并登录"><a href="#2-1-3-浏览到主机名并登录" class="headerlink" title="2.1.3.浏览到主机名并登录"></a>2.1.3.浏览到主机名并登录</h5><p>除非您在安装过程中提供了自定义密码，否则将随机生成一个密码并在<code>/etc/gitlab/initial_root_password</code>. 使用此密码和用户名<code>root</code>登录。有关<a href="https://docs.gitlab.com/omnibus/README.html#installation-and-configuration-using-omnibus-package">安装和配置的详细说明，</a>请参阅我们的<a href="https://docs.gitlab.com/omnibus/README.html#installation-and-configuration-using-omnibus-package">文档</a>。</p><p>完成安装后，请考虑<a href="https://docs.gitlab.com/ee/install/next_steps.html">建议的后续步骤</a>，包括身份验证选项和注册限制。</p><h4 id="2-2-包安装"><a href="#2-2-包安装" class="headerlink" title="2.2.包安装"></a>2.2.包安装</h4><h5 id="2-2-1-安装并配置必要的依赖（同2-1-源码安装的2-1-1-安装并配置必要的依赖）"><a href="#2-2-1-安装并配置必要的依赖（同2-1-源码安装的2-1-1-安装并配置必要的依赖）" class="headerlink" title="2.2.1.安装并配置必要的依赖（同2.1.源码安装的2.1.1.安装并配置必要的依赖）"></a>2.2.1.安装并配置必要的依赖（同2.1.源码安装的2.1.1.安装并配置必要的依赖）</h5><h5 id="2-2-2-查看系统信息，下载对应的GitLab安装包"><a href="#2-2-2-查看系统信息，下载对应的GitLab安装包" class="headerlink" title="2.2.2.查看系统信息，下载对应的GitLab安装包"></a>2.2.2.查看系统信息，下载对应的GitLab安装包</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202108172236480.png" alt="image-20210817223621085"></p><p>可以看到我这里是 Linux VM-0-14-centos 3.10.0-1160.31.1.el7.x86_64 #1 SMP Thu Jun 10 13:32:12 UTC 2021 x86_64 x86_64 x86_64 GNU&#x2F;Linux，那么就需要下载el7.x86_64.rpm的社区安装包。这里我下载了截至2021&#x2F;8&#x2F;17最新的安装包（gitlab-ce-13.12.10-ce.0.el7.x86_64.rpm）。</p><p>下载包（这里推荐先本地下载，再上传服务器，下载地址：<a href="https://packages.gitlab.com/gitlab/gitlab-ce/packages/el/7/gitlab-ce-13.12.10-ce.0.el7.x86_64.rpm/download.rpm">下载</a>）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --content-disposition https://packages.gitlab.com/gitlab/gitlab-ce/packages/el/7/gitlab-ce-13.12.10-ce.0.el7.x86_64.rpm/download.rpm</span><br></pre></td></tr></table></figure><p>这里我是本地下载，再上传服务器的，上传的目录为（&#x2F;home&#x2F;lib）</p><p><img src="https://cdn.zhaifanhua.com/blog/img/202108172311381.png" alt="image-20210817231129912"></p><h5 id="2-2-3-安装GitLab-软件包"><a href="#2-2-3-安装GitLab-软件包" class="headerlink" title="2.2.3.安装GitLab 软件包"></a>2.2.3.安装GitLab 软件包</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh /home/libgitlab-ce-13.12.10-ce.0.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><h5 id="2-2-4-配置域名："><a href="#2-2-4-配置域名：" class="headerlink" title="2.2.4.配置域名："></a>2.2.4.配置域名：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/202108172337072.png" alt="image-20210817233745549"></p><p>如上图，我的域名为 <a href="https://git.zhaifanhua.com/">https://git.zhaifanhua.com</a> </p><h4 id="配置生效"><a href="#配置生效" class="headerlink" title="配置生效"></a>配置生效</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 使配置生效</span><br><span class="line">sudo gitlab-ctl reconfigure</span><br><span class="line"># 重新启动服务</span><br><span class="line">sudo gitlab-ctl restart</span><br></pre></td></tr></table></figure><h2 id="3-外部Nginx反向代理Gitlab内部Nginx"><a href="#3-外部Nginx反向代理Gitlab内部Nginx" class="headerlink" title="3.外部Nginx反向代理Gitlab内部Nginx"></a>3.外部Nginx反向代理Gitlab内部Nginx</h2><p>由于Gitlab在安装的时候内部集成了Nginx，一般情况下，采用外部Nginx反向代理的思路来统一管理。</p><h3 id="编辑gitlab配置文件"><a href="#编辑gitlab配置文件" class="headerlink" title="编辑gitlab配置文件"></a>编辑gitlab配置文件</h3><ul><li>1、让gitlab的内置nginx监听7000端口</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br><span class="line">nginx[&#x27;listen_port&#x27;] = 7000</span><br></pre></td></tr></table></figure><ul><li>2、 设置gitlab的访问路径（是通过外部nginx反向代理访问的）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">external_url &#x27;http://域名/gitlab&#x27;</span><br></pre></td></tr></table></figure><ul><li>3、 让配置生效</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br><span class="line">gitlab-ctl restart</span><br></pre></td></tr></table></figure><h3 id="配置外部nginx"><a href="#配置外部nginx" class="headerlink" title="配置外部nginx"></a>配置外部nginx</h3><ul><li>1、编辑nginx配置文件</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">   server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name 192.168.3.101;</span><br><span class="line">        charset utf-8;</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=63072000&quot; always;</span><br><span class="line">        #-------------代码------------------</span><br><span class="line">        location /gitlab &#123;</span><br><span class="line">            # 设置最大允许上传单个的文件大小</span><br><span class="line">            client_max_body_size 1024m;</span><br><span class="line">            proxy_redirect off;</span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            # 反向代理到 gitlab 内置的 nginx</span><br><span class="line">            proxy_pass  http://127.0.0.1:7000;</span><br><span class="line">            index index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>2、重启nginx</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 检测配置是否正确</span><br><span class="line">nginx -t</span><br><span class="line">  </span><br><span class="line"># 重启nginx</span><br><span class="line">nginx -s reload  # or service nginx restart</span><br></pre></td></tr></table></figure><h2 id="4-GitLab管理常用命令"><a href="#4-GitLab管理常用命令" class="headerlink" title="4.GitLab管理常用命令"></a>4.GitLab管理常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 禁止 Gitlab 开机自启动</span></span><br><span class="line">systemctl <span class="built_in">disable</span> gitlab-runsvdir.service</span><br><span class="line"><span class="comment"># 启用 Gitlab 开机自启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> gitlab-runsvdir.service</span><br><span class="line"></span><br><span class="line">gitlab-ctl start    <span class="comment"># 启动所有 gitlab 组件；</span></span><br><span class="line">gitlab-ctl stop        <span class="comment"># 停止所有 gitlab 组件；</span></span><br><span class="line">gitlab-ctl restart        <span class="comment"># 重启所有 gitlab 组件；</span></span><br><span class="line">gitlab-ctl status        <span class="comment"># 查看服务状态；</span></span><br><span class="line">vim /etc/gitlab/gitlab.rb        <span class="comment"># 修改gitlab配置文件；</span></span><br><span class="line">gitlab-ctl reconfigure        <span class="comment"># 重新编译gitlab的配置；</span></span><br><span class="line">gitlab-rake gitlab:check SANITIZE=<span class="literal">true</span> --trace    <span class="comment"># 检查gitlab；</span></span><br><span class="line">gitlab-ctl <span class="built_in">tail</span>        <span class="comment"># 查看日志；</span></span><br><span class="line">gitlab-ctl <span class="built_in">tail</span> nginx/gitlab_access.log</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitLab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最喜欢的一篇散文</title>
      <link href="/2021/08/12/bdc030f44548/"/>
      <url>/2021/08/12/bdc030f44548/</url>
      
        <content type="html"><![CDATA[<h1 id="最喜欢的一篇散文"><a href="#最喜欢的一篇散文" class="headerlink" title="最喜欢的一篇散文"></a>最喜欢的一篇散文</h1><h2 id="沉思望江楼-崔明秋"><a href="#沉思望江楼-崔明秋" class="headerlink" title="沉思望江楼(崔明秋)"></a>沉思望江楼(崔明秋)</h2><p>历史是那么的遥远，远得几乎无力去陈述。历史又仿佛就在眼前，与一块块青砖对视，黑色的瓦片间一棵小草缓缓地伸出手掌，举着生命的意象。风从双肩掠过，在我的耳畔低语着季节的万般柔情。多少年的冬去春来，多少年的隐忍与执着，多少年的寂寞与守望，历史在这里折断了嗓音，它仿佛就是巨大的磨盘研磨着灰色的时光。刻在墙上的文字在夕阳的余晖中目送着一个又一个日子悲壮地离去。那一横一竖、一撇一捺中隐藏了多少无常世事，吞咽了多少惆怅与苦涩。<br>青山如黛，碧草如丝，江水在时间的磨砺中依旧保持着最初的纯真，向它该去的地方流去，不舍昼夜。任何的兴衰荣辱、时代变迁都似乎与它无关。愁肠百结的是这门窗紧闭、缄默不语的望江楼。爱情早已苍老无语，它在岸边站成一座城市的标记，在浩渺烟波中站成一个永不透露的承诺。它不需要被赞美，朴素得如苍穹永恒的淡蓝，或是古老长城那永远的深灰。它目睹了太多的悲欢离合，望着时光如落木萧萧而下，多少种命运，多少种凄凉，多少种无奈……阅尽沧桑，却依然无法让内心生出坚硬的老茧。<br>文字记载的历史，是帝王将相的江山与权谋明争暗斗的喧嚣。对于一座古老建筑的探寻，人们争先恐后想要找到的也是那些王公贵族、文武官员留下的痕迹。光绪七年，钦差大臣吴大澂到宁古塔巡查边务，宁古塔副都统容峻为其在牡丹江畔建造望江楼，作为住所。吴大澂，字清卿，出生于江苏吴县，是清代金石学家、书画家和诗人。光绪十一年，吴大澂奉旨再来宁古塔，与俄使勘界，在望江楼短暂停留，这也是他最后一次来到。他凭栏远眺，心中既有对前尘往事的回忆，同时也生出一丝伤感与留恋，于是写下了《登望江楼题诗》：“忆昔临江筑小楼，与君传酒话中秋，自径一去三年别，那想重来两日留。国恩未报归和远，敢把闲情寄白鸥。”而那些在历史长河中如沙砾一样默默无闻的人却终将成为烟尘，消散在天际。他们甚至没有被遗忘的幸运。江水在大地上流淌，而另一条隐秘的河流在历史的掌心流淌。<br>青苔葳蕤，石阶湿滑，古老的望江楼在月光的浸润中泛起柔和的光。江畔小路冷清下来，高大的榆树弯曲的树枝也在夜风的抚弄下有了些许的灵动。新植的杨树睁着懵懂无知的眼睛，渴求读懂那紧闭门窗内神秘的往事与深邃的哲理。夜，让一切变得真实起来，虚荣与狭隘被星星纤细的明亮刺破。<br>黑暗，也许更能接近神灵，在风中行走的灵魂寻找着怀念的人。面对一座古老的建筑，面对厚重的历史，人们的敬畏与崇拜太少太少。欲望的无限扩张，故土成为被遗忘的薄薄的过往。谁会在月亮的注视中，俯身向下，去感悟一滴露水的清澈与柔弱？谁会在斑驳的树影与青草的气息中去感谢大地的恩泽？又有谁会站在望江楼前，仰视那木制的栏杆、镂空的花窗，在时光的遗韵中缅怀那些用汗水、泪水、鲜血或是用生命来创造历史的平凡人？<br>人们在不断追寻着历史的真相，更加渴望探求到时间与空间的真相。这种探求本身就是一场失望之旅与无果而终。人类是渺小的，不要说面对庞大的历史与多变的世界，就是面对自己的命运，又有谁不是无力而脆弱的呢？也许，所有的真相都只是一个真相，生命终究只是落花流水，如秋草一般在风中哀怨地等待冬天，等待大地最后的宽容与收留……<br>推土机霸气地推倒一座座灰瓦红砖的房舍，生长多年粗壮而挺拔的杨树也在电锯的嘶叫声中轰然倒下。一片片残枝碎叶、一堆堆残砖碎瓦被卡车轰鸣着运走。那轰鸣声带着势不可挡，带着理直气壮，仿佛在为一个即将到来的新时代吹响号角。卡车运走的不只是一堆堆的垃圾，更像是一个旧时代的废墟。古城的韵味被粗野地撕碎，那曾经被日子压得弯弯曲曲的街巷消失于一座座拔地而起的钢筋与水泥构成的高大丛林中。还有什么可以见证古城的历史？时间失去了等待的耐心，记忆还来不及书写，孩子们已羽翼丰满，展开飞翔的姿势。就连那滚滚东去的江水也被欲望的排泄物污染而发出腥臭的味道。<br>望江楼的身后是车水马龙、商铺林立的街市，那一幢幢崭新而高大的建筑穿着文明与进步的华丽外衣，讥笑着这座散发着岁月沧桑味道的望江楼。它是那么的孤单，那么的寡言，坐在它身旁的老人干涩的眼里蜷缩着欲言又止的忧伤。<br>多年以来，将多少细碎的脚步留在了江畔，将多少细碎的心事留在了望江楼苍老的目光之中。我叩不开那紧闭的门窗，也无法进入那青砖围砌的建筑内部，去感受一颗古老而忧郁的心。我只有站在寂寥的岸边，听流水的叹息声，在那幅灰暗的轮廓中，我看到的除了时光，还是时光……</p>]]></content>
      
      
      <categories>
          
          <category> 散文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 散文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SqlServer常用语句及函数</title>
      <link href="/2021/07/12/0f67388a472e/"/>
      <url>/2021/07/12/0f67388a472e/</url>
      
        <content type="html"><![CDATA[<h1 id="一、SqlServer常用语句"><a href="#一、SqlServer常用语句" class="headerlink" title="一、SqlServer常用语句"></a>一、SqlServer常用语句</h1><h2 id="1、删除所有表"><a href="#1、删除所有表" class="headerlink" title="1、删除所有表"></a>1、删除所有表</h2><h3 id="1-1、删除所有表的外键约束（防止由于外键约束表删除失败）"><a href="#1-1、删除所有表的外键约束（防止由于外键约束表删除失败）" class="headerlink" title="1.1、删除所有表的外键约束（防止由于外键约束表删除失败）"></a>1.1、删除所有表的外键约束（防止由于外键约束表删除失败）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> c1 <span class="keyword">cursor</span> <span class="keyword">for</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;alter table [&#x27;</span><span class="operator">+</span> object_name(parent_obj) <span class="operator">+</span> <span class="string">&#x27;] drop constraint [&#x27;</span><span class="operator">+</span>name<span class="operator">+</span><span class="string">&#x27;]; &#x27;</span></span><br><span class="line"><span class="keyword">from</span> sysobjects</span><br><span class="line"><span class="keyword">where</span> xtype <span class="operator">=</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line"><span class="keyword">open</span> c1</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@c1</span> <span class="type">varchar</span>(<span class="number">8000</span>)</span><br><span class="line"><span class="keyword">fetch</span> next <span class="keyword">from</span> c1 <span class="keyword">into</span> <span class="variable">@c1</span></span><br><span class="line">while(@<span class="variable">@fetch_status</span><span class="operator">=</span><span class="number">0</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">exec</span>(<span class="variable">@c1</span>)</span><br><span class="line"><span class="keyword">fetch</span> next <span class="keyword">from</span> c1 <span class="keyword">into</span> <span class="variable">@c1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">close</span> c1</span><br><span class="line"><span class="keyword">deallocate</span> c1</span><br></pre></td></tr></table></figure><h3 id="1-2、删除所有的存储过程"><a href="#1-2、删除所有的存储过程" class="headerlink" title="1.2、删除所有的存储过程"></a>1.2、删除所有的存储过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名(是要删除表所在的那个数据库的名称)</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@sql</span> <span class="type">varchar</span>(<span class="number">8000</span>)</span><br><span class="line">while (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> sysobjects <span class="keyword">where</span> type<span class="operator">=</span><span class="string">&#x27;P&#x27;</span>)<span class="operator">&gt;</span><span class="number">0</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@sql</span><span class="operator">=</span><span class="string">&#x27;drop Procedure &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">FROM</span> sysobjects</span><br><span class="line"><span class="keyword">WHERE</span> (type <span class="operator">=</span> <span class="string">&#x27;P&#x27;</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="string">&#x27;drop Procedure &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">exec</span>(<span class="variable">@sql</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p> 1.3、删除所有表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名(是要删除表所在的那个数据库的名称)</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@sql</span> <span class="type">varchar</span>(<span class="number">8000</span>)</span><br><span class="line">while (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> sysobjects <span class="keyword">where</span> type<span class="operator">=</span><span class="string">&#x27;U&#x27;</span>)<span class="operator">&gt;</span><span class="number">0</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@sql</span><span class="operator">=</span><span class="string">&#x27;drop table &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">FROM</span> sysobjects</span><br><span class="line"><span class="keyword">WHERE</span> (type <span class="operator">=</span> <span class="string">&#x27;U&#x27;</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="string">&#x27;drop table &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">exec</span>(<span class="variable">@sql</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="二、SqlServer常用函数"><a href="#二、SqlServer常用函数" class="headerlink" title="二、SqlServer常用函数"></a>二、SqlServer常用函数</h1><h2 id="1、concert-函数"><a href="#1、concert-函数" class="headerlink" title="1、concert() 函数"></a>1、concert() 函数</h2><blockquote><p>concert() 函数是把日期转换为新数据类型的通用函数。concert() 函数可以用不同的格式显示日期&#x2F;时间数据。</p></blockquote><h3 id="1-1、语法"><a href="#1-1、语法" class="headerlink" title="1.1、语法"></a>1.1、语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONVERT(data_type(length),data_to_be_converted,style)</span><br></pre></td></tr></table></figure><p><em>data_type(length)</em> 规定目标数据类型（带有可选的长度）。<em>data_to_be_converted</em> 含有需要转换的值。<em>style</em> 规定日期&#x2F;时间的输出格式。</p><p>可以使用的 <em>style</em> 值：</p><table><thead><tr><th align="left">Style ID</th><th align="left">Style 格式</th></tr></thead><tbody><tr><td align="left">100 或者 0</td><td align="left">mon dd yyyy hh:miAM （或者 PM）</td></tr><tr><td align="left">101</td><td align="left">mm&#x2F;dd&#x2F;yy</td></tr><tr><td align="left">102</td><td align="left">yy.mm.dd</td></tr><tr><td align="left">103</td><td align="left">dd&#x2F;mm&#x2F;yy</td></tr><tr><td align="left">104</td><td align="left">dd.mm.yy</td></tr><tr><td align="left">105</td><td align="left">dd-mm-yy</td></tr><tr><td align="left">106</td><td align="left">dd mon yy</td></tr><tr><td align="left">107</td><td align="left">Mon dd, yy</td></tr><tr><td align="left">108</td><td align="left">hh:mm:ss</td></tr><tr><td align="left">109 或者 9</td><td align="left">mon dd yyyy hh:mi:ss:mmmAM（或者 PM）</td></tr><tr><td align="left">110</td><td align="left">mm-dd-yy</td></tr><tr><td align="left">111</td><td align="left">yy&#x2F;mm&#x2F;dd</td></tr><tr><td align="left">112</td><td align="left">yymmdd</td></tr><tr><td align="left">113 或者 13</td><td align="left">dd mon yyyy hh:mm:ss:mmm(24h)</td></tr><tr><td align="left">114</td><td align="left">hh:mi:ss:mmm(24h)</td></tr><tr><td align="left">120 或者 20</td><td align="left">yyyy-mm-dd hh:mi:ss(24h)</td></tr><tr><td align="left">121 或者 21</td><td align="left">yyyy-mm-dd hh:mi:ss.mmm(24h)</td></tr><tr><td align="left">126</td><td align="left">yyyy-mm-ddThh:mm:ss.mmm（没有空格）</td></tr><tr><td align="left">130</td><td align="left">dd mon yyyy hh:mi:ss:mmmAM</td></tr><tr><td align="left">131</td><td align="left">dd&#x2F;mm&#x2F;yy hh:mi:ss:mmmAM</td></tr></tbody></table><h3 id="1-2、实例"><a href="#1-2、实例" class="headerlink" title="1.2、实例"></a>1.2、实例</h3><p>下面的脚本使用 concert() 函数来显示不同的格式。我们将使用 GETDATE() 函数来获得当前的日期&#x2F;时间：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONVERT(VARCHAR(19),GETDATE())</span><br><span class="line">CONVERT(VARCHAR(10),GETDATE(),110) </span><br><span class="line">CONVERT(VARCHAR(11),GETDATE(),106)</span><br><span class="line">CONVERT(VARCHAR(24),GETDATE(),113)</span><br></pre></td></tr></table></figure><p>结果类似：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Dec 29 2008 11:45 PM</span><br><span class="line">12-29-2008</span><br><span class="line">29 Dec 08</span><br><span class="line">29 Dec 2008 16:25:46.635</span><br></pre></td></tr></table></figure><h2 id="2、count-函数"><a href="#2、count-函数" class="headerlink" title="2、count()函数"></a>2、count()函数</h2><h3 id="2-1、count-1-and-count"><a href="#2-1、count-1-and-count" class="headerlink" title="2.1、count(1) and count(*)"></a>2.1、count(1) and count(*)</h3><p>当表的数据量大些时，对表作分析之后，使用count(1)还要比使用count( * )用时多了！<br>从执行计划来看，count(1)和count( * )的效果是一样的。 但是在表做过分析之后，count(1)会比count( * )的用时少些（1w以内数据量），不过差不了多少。 如果count(1)是聚索引,id,那肯定是count(1)快。但是差的很小的。<br>因为count( * ),自动会优化指定到那一个字段。所以没必要去count(1)，用count( * )，sql会帮你完成优化的 因此：count(1)和count( * )基本没有差别！ </p><h3 id="2-2、count-1-and-count-字段"><a href="#2-2、count-1-and-count-字段" class="headerlink" title="2.2、count(1) and count(字段)"></a>2.2、count(1) and count(字段)</h3><p>两者的主要区别是<br>（1） count(1) 会统计表中的所有的记录数，包含字段为null 的记录。<br>（2） count(字段) 会统计该字段在表中出现的次数，忽略字段为null 的情况。即不统计字段为null 的记录。 </p><h3 id="2-3、count-和-count-1-和count-列名-区别"><a href="#2-3、count-和-count-1-和count-列名-区别" class="headerlink" title="2.3、count(*) 和 count(1)和count(列名)区别"></a>2.3、count(*) 和 count(1)和count(列名)区别</h3><p>执行效果上：<br>count(*)包括了所有的列，相当于行数，在统计结果的时候，不会忽略列值为NULL<br>count(1)包括了忽略所有列，用1代表代码行，在统计结果的时候，不会忽略列值为NULL<br>count(列名)只包括列名那一列，在统计结果的时候，会忽略列值为空（这里的空不是只空字符串或者0，而是表示null）的计数，即某个字段值为NULL时，不统计。</p><p>执行效率上：<br>列名为主键，count(列名)会比count(1)快<br>列名不为主键，count(1)会比count(列名)快<br>如果表多个列并且没有主键，则 count（1） 的执行效率优于 count（ * ）<br>如果有主键，则 select count（主键）的执行效率是最优的<br>如果表只有一个字段，则 select count（*）最优。</p><h2 id="3、len-函数"><a href="#3、len-函数" class="headerlink" title="3、len() 函数"></a>3、len() 函数</h2><p>len() 函数返回文本字段中值的长度。</p><h2 id="4、cast-函数"><a href="#4、cast-函数" class="headerlink" title="4、cast() 函数"></a>4、cast() 函数</h2><p>4.1、CAST()函数的参数是一个表达式，它包括用AS关键字分隔的源值和目标数据类型。以下例子用于将文本字符串’12’转换为整型:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CAST(&#x27;12&#x27; AS int)</span><br></pre></td></tr></table></figure><p>4.2、返回值是整型值12。如果试图将一个代表小数的字符串转换为整型值，又会出现什么情况呢？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CAST(&#x27;12.5&#x27; AS int)  </span><br></pre></td></tr></table></figure><p>4.3、CAST()函数和CONVERT()函数都不能执行四舍五入或截断操作。由于12.5不能用int数据类型来表示，所以对这个函数调用将产生一个错误:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Server: Msg 245, Level 16, State 1, Line 1 Syntax error converting the varchar value     &#x27;12.5&#x27; to a column of data type int.</span><br></pre></td></tr></table></figure><p>4.4、要返回一个合法的数值，就必须使用能处理这个值的数据类型。对于这个例子，存在多个可用的数据类型。如果通过CAST()函数将这个值转换为decimal类型，需要首先定义decimal值的精度与小数位数。在本例中，精度与小数位数分别为9 与2。精度是总的数字位数，包括小数点左边和右边位数的总和。而小数位数是小数点右边的位数。这表示本例能够支持的最大的整数值是9999999，而最小的小数是0.01。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CAST(&#x27;12.5&#x27; AS decimal(9,2))</span><br></pre></td></tr></table></figure><p>decimal数据类型在结果网格中将显示有效小数位: 12.50</p><p>4.5、精度和小数位数的默认值分别是18与0。如果在decimal类型中不提供这两个值，SQL Server将截断数字的小数部分，而不会产生错误。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CAST(&#x27;12.5&#x27; AS decimal)</span><br></pre></td></tr></table></figure><p>结果是一个整数值：12</p><h1 id="三、常用问题"><a href="#三、常用问题" class="headerlink" title="三、常用问题"></a>三、常用问题</h1><h2 id="Sqlserver数据库还原一直显示“正在还原…”解决方法"><a href="#Sqlserver数据库还原一直显示“正在还原…”解决方法" class="headerlink" title="Sqlserver数据库还原一直显示“正在还原…”解决方法"></a>Sqlserver数据库还原一直显示“正在还原…”解决方法</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RESTORE database 数据库名  <span class="keyword">with</span> recovery</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SqlServer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SqlServer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决电脑不能复制移动删除文件夹的方法</title>
      <link href="/2021/07/06/79b27c6a1631/"/>
      <url>/2021/07/06/79b27c6a1631/</url>
      
        <content type="html"><![CDATA[<blockquote><p>有时候小伙伴们正在或刚使用过的文件夹或者某个文件，想要把它移动到其它的位置，或者删除它，又或者仅仅想重命名这个文件，但是在操作过程中，我们发现它弹出来了文件夹或者文件正在被使用，操作无法完成，怎么办呢？对于这种情况，我们可以使用多种方法来解决。具体是什么呢？</p></blockquote><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p><strong>找到占用文件或文件夹的进程，结束那个进程就可以了。具体为：</strong></p><p><strong>【任务管理器】&gt;【性能】&gt;【打开资源监视器】&gt;【CPU】&gt;【关联的句柄】&gt;【输入文件夹地址】&gt;【结束进程】</strong></p><h3 id="1、文件夹正在使用"><a href="#1、文件夹正在使用" class="headerlink" title="1、文件夹正在使用"></a>1、文件夹正在使用</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/20210706115625.png" alt="image-20210706115621973"></p><h3 id="2、【Ctrl】-【Alt】-【Del】快捷键打开任务管理器"><a href="#2、【Ctrl】-【Alt】-【Del】快捷键打开任务管理器" class="headerlink" title="2、【Ctrl】+【Alt】+【Del】快捷键打开任务管理器"></a>2、【Ctrl】+【Alt】+【Del】快捷键打开任务管理器</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/20210706115834.png" alt="image-20210706115833003"></p><h3 id="3、点击性能选项卡选择打开资源管理器"><a href="#3、点击性能选项卡选择打开资源管理器" class="headerlink" title="3、点击性能选项卡选择打开资源管理器"></a>3、点击性能选项卡选择打开资源管理器</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/20210706120026.png" alt="image-20210706120025366"></p><h3 id="4、打开-CPU-选项卡"><a href="#4、打开-CPU-选项卡" class="headerlink" title="4、打开 CPU 选项卡"></a>4、打开 CPU 选项卡</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/20210706120121.png" alt="image-20210706120119301"></p><h3 id="5、将路径复制到【关键的句柄】，右键【结束进程】"><a href="#5、将路径复制到【关键的句柄】，右键【结束进程】" class="headerlink" title="5、将路径复制到【关键的句柄】，右键【结束进程】"></a>5、将路径复制到【关键的句柄】，右键【结束进程】</h3><p><img src="https://cdn.zhaifanhua.com/blog/img/20210706120235.png" alt="image-20210706120233849"></p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210706120403.png" alt="image-20210706120401074"></p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐​​ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 攻略 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 攻略 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>通用.NET数据库访问类SqlHelper</title>
      <link href="/2021/06/19/1adfa4983617/"/>
      <url>/2021/06/19/1adfa4983617/</url>
      
        <content type="html"><![CDATA[<h1 id="通用-NET数据库访问类SqlHelper"><a href="#通用-NET数据库访问类SqlHelper" class="headerlink" title="通用.NET数据库访问类SqlHelper"></a>通用.NET数据库访问类SqlHelper</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Xml;</span><br><span class="line"><span class="keyword">using</span> System.Data.SqlClient;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Configuration;</span><br><span class="line"><span class="comment">/*解释: </span></span><br><span class="line"><span class="comment"> * --------连接字符串属性--------</span></span><br><span class="line"><span class="comment"> * &quot;Server&quot;或&quot;Data Source&quot;属性:服务器名</span></span><br><span class="line"><span class="comment"> * &quot;Database&quot;或&quot;Initial Catalog&quot;属性:数据库名</span></span><br><span class="line"><span class="comment"> * &quot;Persist Security Info&quot;属性:是否保存安全信息，即数据库连接成功后是否保存密码信息(True或False)</span></span><br><span class="line"><span class="comment"> * --------密码验证登录--------</span></span><br><span class="line"><span class="comment"> * &quot;Uid&quot;或&quot;User Id&quot;属性:连接数据库的验证用户名</span></span><br><span class="line"><span class="comment"> * &quot;Pwd&quot;或&quot;Password&quot;属性:连接数据库的验证密码</span></span><br><span class="line"><span class="comment"> * --------Windows登录--------</span></span><br><span class="line"><span class="comment"> * &quot;AttachDbFilename&quot;属性:服务器的文件路径</span></span><br><span class="line"><span class="comment"> * &quot;Integrated Security&quot;属性:Windows登录（True或False，SSPI即为True）</span></span><br><span class="line"><span class="comment"> * --------获取连接字符串--------</span></span><br><span class="line"><span class="comment"> * 如果要获取连接数据连接对象或字符串的话，先要修改Configuration中的ConnectionStrings为&quot;ConnectionString&quot;才能调用。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ZhaiFanHua.DAL</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SqlServer数据访问帮助类 </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">SqlHelper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> 私有构造函数和方法</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">SqlHelper</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将SqlParameter参数数组(参数值)分配给SqlCommand命令. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将给任何一个参数分配DBNull.Value; </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 该操作将阻止默认值的使用. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;command&quot;&gt;</span>命令名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParameters数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AttachParameters</span>(<span class="params">SqlCommand command, SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (command == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;command&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandParameters != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">foreach</span> (SqlParameter p <span class="keyword">in</span> commandParameters)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (p != <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 检查未分配值的输出参数,将其分配以DBNull.Value. </span></span><br><span class="line">                        <span class="keyword">if</span> ((p.Direction == ParameterDirection.InputOutput || p.Direction == ParameterDirection.Input) &amp;&amp;</span><br><span class="line">                                                    (p.Value == <span class="literal">null</span>))</span><br><span class="line">                        &#123;</span><br><span class="line">                            p.Value = DBNull.Value;</span><br><span class="line">                        &#125;</span><br><span class="line">                        command.Parameters.Add(p);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将DataRow类型的列值分配到SqlParameter参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>要分配值的SqlParameter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>将要分配给存储过程参数的DataRow<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AssignParameterValues</span>(<span class="params">SqlParameter[] commandParameters, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((commandParameters == <span class="literal">null</span>) || (dataRow == <span class="literal">null</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 设置参数值 </span></span><br><span class="line">            <span class="keyword">foreach</span> (SqlParameter commandParameter <span class="keyword">in</span> commandParameters)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 创建参数名称,如果不存在,只抛出一个异常. </span></span><br><span class="line">                <span class="keyword">if</span> (commandParameter.ParameterName == <span class="literal">null</span> ||</span><br><span class="line">                                    commandParameter.ParameterName.Length &lt;= <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(</span><br><span class="line">                        <span class="built_in">string</span>.Format(<span class="string">&quot;请提供参数&#123;0&#125;一个有效的名称&#123;1&#125;.&quot;</span>, i, commandParameter.ParameterName));</span><br><span class="line">                <span class="comment">// 从dataRow的表中获取为参数数组中数组名称的列的索引. </span></span><br><span class="line">                <span class="comment">// 如果存在和参数名称相同的列,则将列值赋给当前名称的参数. </span></span><br><span class="line">                <span class="keyword">if</span> (dataRow.Table.Columns.IndexOf(commandParameter.ParameterName.Substring(<span class="number">1</span>)) != <span class="number">-1</span>)</span><br><span class="line">                    commandParameter.Value = dataRow[commandParameter.ParameterName.Substring(<span class="number">1</span>)];</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将一个对象数组分配给SqlParameter参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>要分配值的SqlParameter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>将要分配给存储过程参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AssignParameterValues</span>(<span class="params">SqlParameter[] commandParameters, <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((commandParameters == <span class="literal">null</span>) || (parameterValues == <span class="literal">null</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 确保对象数组个数与参数个数匹配,如果不匹配,抛出一个异常. </span></span><br><span class="line">            <span class="keyword">if</span> (commandParameters.Length != parameterValues.Length)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;参数值个数与参数不匹配.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 给参数赋值 </span></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>, j = commandParameters.Length; i &lt; j; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// If the current array value derives from IDbDataParameter, then assign its Value property </span></span><br><span class="line">                <span class="keyword">if</span> (parameterValues[i] <span class="keyword">is</span> IDbDataParameter)</span><br><span class="line">                &#123;</span><br><span class="line">                    IDbDataParameter paramInstance = (IDbDataParameter)parameterValues[i];</span><br><span class="line">                    <span class="keyword">if</span> (paramInstance.Value == <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        commandParameters[i].Value = DBNull.Value;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        commandParameters[i].Value = paramInstance.Value;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (parameterValues[i] == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    commandParameters[i].Value = DBNull.Value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    commandParameters[i].Value = parameterValues[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 预处理用户提供的命令,数据库连接/事务/命令类型/参数 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;command&quot;&gt;</span>要处理的SqlCommand<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>数据库连接<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的事务或者是null值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本, 其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或都T-SQL命令文本<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>和命令相关联的SqlParameter参数数组,如果没有参数为&#x27;null&#x27;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;mustCloseConnection&quot;&gt;</span><span class="doctag">&lt;c&gt;</span>true<span class="doctag">&lt;/c&gt;</span> 如果连接是打开的,则为true,其它情况下为false.<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrepareCommand</span>(<span class="params">SqlCommand command, SqlConnection connection, SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, SqlParameter[] commandParameters, <span class="keyword">out</span> <span class="built_in">bool</span> mustCloseConnection</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (command == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;command&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandText == <span class="literal">null</span> || commandText.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;commandText&quot;</span>);</span><br><span class="line">            <span class="comment">// If the provided connection is not open, we will open it </span></span><br><span class="line">            <span class="keyword">if</span> (connection.State != ConnectionState.Open)</span><br><span class="line">            &#123;</span><br><span class="line">                mustCloseConnection = <span class="literal">true</span>;</span><br><span class="line">                connection.Open();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 给命令分配一个数据库连接. </span></span><br><span class="line">            command.Connection = connection;</span><br><span class="line">            <span class="comment">// 设置命令文本(存储过程名或SQL语句) </span></span><br><span class="line">            command.CommandText = commandText;</span><br><span class="line">            <span class="comment">// 分配事务 </span></span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">                command.Transaction = transaction;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 设置命令类型. </span></span><br><span class="line">            command.CommandType = commandType;</span><br><span class="line">            <span class="comment">// 分配命令参数 </span></span><br><span class="line">            <span class="keyword">if</span> (commandParameters != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                AttachParameters(command, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> 私有构造函数和方法结束</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> 数据库连接 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 一个有效的数据库连接字符串 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetConnSting</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ConfigurationManager.ConnectionStrings[<span class="string">&quot;ConnectionString&quot;</span>].ConnectionString;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 一个有效的数据库连接对象 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlConnection <span class="title">GetConnection</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            SqlConnection Connection = <span class="keyword">new</span> SqlConnection(SqlHelper.GetConnSting());</span><br><span class="line">            <span class="keyword">return</span> Connection;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteNonQuery命令</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接字符串,类型的SqlCommand. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(connString, CommandType.StoredProcedure, &quot;PublishOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本, 其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回命令影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteNonQuery(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接字符串,类型的SqlCommand.如果没有提供参数,不返回结果. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(connString, CommandType.StoredProcedure, &quot;PublishOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本, 其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParameter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回命令影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connection, commandType, commandText, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接字符串的存储过程,将对象数组的值赋给存储过程参数, </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法需要在参数缓存方法中探索参数并生成参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法没有提供访问输出参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(connString, &quot;PublishOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串/param&gt; </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配到存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回受影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果存在参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从探索存储过程参数(加载到缓存)并分配给存储过程参数数组. </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数情况下 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, CommandType.StoredProcedure, &quot;PublishOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteNonQuery(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, CommandType.StoredProcedure, &quot;PublishOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>T存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// Finally, execute the command </span></span><br><span class="line">            <span class="built_in">int</span> retval = cmd.ExecuteNonQuery();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                connection.Close();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,将对象数组的值赋给存储过程参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, &quot;PublishOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行带事务的SqlCommand. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例.:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(trans, CommandType.StoredProcedure, &quot;PublishOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数/returns&gt; </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteNonQuery(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行带事务的SqlCommand(指定参数). </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行 </span></span><br><span class="line">            <span class="built_in">int</span> retval = cmd.ExecuteNonQuery();</span><br><span class="line">            <span class="comment">// 清除参数集,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行带事务的SqlCommand(指定参数值). </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, trans, &quot;PublishOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回受影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> ExecuteNonQuery方法结束</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteDataset方法</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteDataset(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例: </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamters参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connection, commandType, commandText, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,直接提供参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例: </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(connString, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中检索存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数分配值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteDataset(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定存储过程参数,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="comment">// 预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 创建SqlDataAdapter和DataSet. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter da = <span class="keyword">new</span> SqlDataAdapter(cmd))</span><br><span class="line">            &#123;</span><br><span class="line">                DataSet ds = <span class="keyword">new</span> DataSet();</span><br><span class="line">                <span class="comment">// 填充DataSet. </span></span><br><span class="line">                da.Fill(ds);</span><br><span class="line">                cmd.Parameters.Clear();</span><br><span class="line">                <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                    connection.Close();</span><br><span class="line">                <span class="keyword">return</span> ds;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输入参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例.:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(conn, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 比缓存中加载存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数分配值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定事务的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteDataset(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定事务的命令,指定参数,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 创建 DataAdapter &amp; DataSet </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter da = <span class="keyword">new</span> SqlDataAdapter(cmd))</span><br><span class="line">            &#123;</span><br><span class="line">                DataSet ds = <span class="keyword">new</span> DataSet();</span><br><span class="line">                da.Fill(ds);</span><br><span class="line">                cmd.Parameters.Clear();</span><br><span class="line">                <span class="keyword">return</span> ds;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定事务的命令,指定参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输入参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例.:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(trans, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数分配值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> ExecuteDataset数据集命令结束</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteReader 数据阅读器</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 枚举,标识数据库连接是由SqlHelper提供还是由调用者提供 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">enum</span> SqlConnectionOwnership</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>由SqlHelper提供连接<span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">            Internal,</span><br><span class="line">            <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>由调用者提供连接<span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">            External</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的数据阅读器. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 如果是SqlHelper打开连接,当连接关闭DataReader也将关闭. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 如果是调用都打开连接,DataReader由调用都管理. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的事务,或者为 &#x27;null&#x27;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParameters参数数组,如果没有参数则为&#x27;null&#x27;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionOwnership&quot;&gt;</span>标识数据库连接对象是由调用者提供还是由SqlHelper提供<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, SqlParameter[] commandParameters, SqlConnectionOwnership connectionOwnership</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// 创建命令 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                PrepareCommand(cmd, connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">                <span class="comment">// 创建数据阅读器 </span></span><br><span class="line">                SqlDataReader dataReader;</span><br><span class="line">                <span class="keyword">if</span> (connectionOwnership == SqlConnectionOwnership.External)</span><br><span class="line">                &#123;</span><br><span class="line">                    dataReader = cmd.ExecuteReader();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dataReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 清除参数,以便再次使用.. </span></span><br><span class="line">                <span class="comment">// <span class="doctag">HACK:</span> There is a problem here, the output parameter values are fletched </span></span><br><span class="line">                <span class="comment">// when the reader is closed, so if the parameters are detached from the command </span></span><br><span class="line">                <span class="comment">// then the SqlReader can磘 set its values. </span></span><br><span class="line">                <span class="comment">// When this happen, the parameters can磘 be used again in other command. </span></span><br><span class="line">                <span class="built_in">bool</span> canClear = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">foreach</span> (SqlParameter commandParameter <span class="keyword">in</span> cmd.Parameters)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (commandParameter.Direction != ParameterDirection.Input)</span><br><span class="line">                        canClear = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (canClear)</span><br><span class="line">                &#123;</span><br><span class="line">                    cmd.Parameters.Clear();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> dataReader;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                    connection.Close();</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的数据阅读器. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的数据阅读器,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组(new SqlParameter(&quot;@prodid&quot;, 24))<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            SqlConnection connection = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                connection = <span class="keyword">new</span> SqlConnection(connectionString);</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connection, <span class="literal">null</span>, commandType, commandText, commandParameters, SqlConnectionOwnership.Internal);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// If we fail to return the SqlDatReader, we need to close the connection ourselves </span></span><br><span class="line">                <span class="keyword">if</span> (connection != <span class="literal">null</span>) connection.Close();</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(connString, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的数据阅读器. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库连接对象的数据阅读器,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, SqlConnectionOwnership.External);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库连接对象的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(conn, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>T存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库事务的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库事务的数据阅读器,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   SqlDataReader dr = ExecuteReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(transaction.Connection, transaction, commandType, commandText, commandParameters, SqlConnectionOwnership.External);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库事务的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(trans, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> ExecuteReader数据阅读器</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteScalar 返回结果集中的第一行第一列</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(connString, CommandType.StoredProcedure, &quot;GetOrderCount&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteScalar(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,指定参数,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(connString, CommandType.StoredProcedure, &quot;GetOrderCount&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connection, commandType, commandText, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,指定参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(connString, &quot;GetOrderCount&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(conn, CommandType.StoredProcedure, &quot;GetOrderCount&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteScalar(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定参数,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(conn, CommandType.StoredProcedure, &quot;GetOrderCount&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行SqlCommand命令,并返回结果. </span></span><br><span class="line">            <span class="built_in">object</span> retval = cmd.ExecuteScalar();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                connection.Close();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(conn, &quot;GetOrderCount&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(trans, CommandType.StoredProcedure, &quot;GetOrderCount&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteScalar(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,指定参数,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(trans, CommandType.StoredProcedure, &quot;GetOrderCount&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行SqlCommand命令,并返回结果. </span></span><br><span class="line">            <span class="built_in">object</span> retval = cmd.ExecuteScalar();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,指定参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(trans, &quot;GetOrderCount&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// PPull the parameters for this stored procedure from the parameter cache () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> ExecuteScalar</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteXmlReader XML阅读器 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的SqlCommand命令,并产生一个XmlReader对象做为结果集返回. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteXmlReader(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">                <span class="comment">// 执行命令 </span></span><br><span class="line">                XmlReader retval = cmd.ExecuteXmlReader();</span><br><span class="line">                <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">                cmd.Parameters.Clear();</span><br><span class="line">                <span class="keyword">return</span> retval;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                    connection.Close();</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(conn, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的SqlCommand命令,并产生一个XmlReader对象做为结果集返回. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteXmlReader(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行命令 </span></span><br><span class="line">            XmlReader retval = cmd.ExecuteXmlReader();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(trans, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> ExecuteXmlReader 阅读器结束</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> FillDataset 填充数据集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,映射数据表并填充数据集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                FillDataset(connection, commandType, commandText, dataSet, tableNames);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,映射数据表并填充数据集.指定命令参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                FillDataset(connection, commandType, commandText, dataSet, tableNames, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,映射数据表并填充数据集,指定存储过程参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, 24); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span>    </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                FillDataset(connection, spName, dataSet, tableNames, parameterValues);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,映射数据表并填充数据集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span>    </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(connection, commandType, commandText, dataSet, tableNames, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,映射数据表并填充数据集,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(connection, <span class="literal">null</span>, commandType, commandText, dataSet, tableNames, commandParameters);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,映射数据表并填充数据集,指定存储过程参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                FillDataset(connection, CommandType.StoredProcedure, spName, dataSet, tableNames, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                FillDataset(connection, CommandType.StoredProcedure, spName, dataSet, tableNames);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,映射数据表并填充数据集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(transaction, commandType, commandText, dataSet, tableNames, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,映射数据表并填充数据集,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(transaction.Connection, transaction, commandType, commandText, dataSet, tableNames, commandParameters);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,映射数据表并填充数据集,指定存储过程参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(trans, &quot;GetOrders&quot;, ds, new string[]&#123;&quot;orders&quot;&#125;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                FillDataset(transaction, CommandType.StoredProcedure, spName, dataSet, tableNames, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                FillDataset(transaction, CommandType.StoredProcedure, spName, dataSet, tableNames);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [私有方法][内部调用]执行指定数据库连接对象/事务的命令,映射数据表并填充数据集,DataSet/TableNames/SqlParameters. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, SqlTransaction transaction, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand command = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(command, connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行命令 </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter dataAdapter = <span class="keyword">new</span> SqlDataAdapter(command))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 追加表映射 </span></span><br><span class="line">                <span class="keyword">if</span> (tableNames != <span class="literal">null</span> &amp;&amp; tableNames.Length &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> tableName = <span class="string">&quot;Table&quot;</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="built_in">int</span> index = <span class="number">0</span>; index &lt; tableNames.Length; index++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (tableNames[index] == <span class="literal">null</span> || tableNames[index].Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The tableNames parameter must contain a list of tables, a value was provided as null or empty string.&quot;</span>, <span class="string">&quot;tableNames&quot;</span>);</span><br><span class="line">                        dataAdapter.TableMappings.Add(tableName, tableNames[index]);</span><br><span class="line">                        tableName += (index + <span class="number">1</span>).ToString();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 填充数据集使用默认表名称 </span></span><br><span class="line">                dataAdapter.Fill(dataSet);</span><br><span class="line">                <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">                command.Parameters.Clear();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                connection.Close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> UpdateDataset 更新数据集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行数据集更新到数据库,指定inserted, updated, or deleted命令. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  UpdateDataset(conn, insertCommand, deleteCommand, updateCommand, dataSet, &quot;Order&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;insertCommand&quot;&gt;</span>[追加记录]一个有效的T-SQL语句或存储过程<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;deleteCommand&quot;&gt;</span>[删除记录]一个有效的T-SQL语句或存储过程<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;updateCommand&quot;&gt;</span>[更新记录]一个有效的T-SQL语句或存储过程<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要更新到数据库的DataSet<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableName&quot;&gt;</span>要更新到数据库的DataTable<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UpdateDataset</span>(<span class="params">SqlCommand insertCommand, SqlCommand deleteCommand, SqlCommand updateCommand, DataSet dataSet, <span class="built_in">string</span> tableName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (insertCommand == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;insertCommand&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (deleteCommand == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;deleteCommand&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (updateCommand == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;updateCommand&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (tableName == <span class="literal">null</span> || tableName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;tableName&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlDataAdapter,当操作完成后释放. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter dataAdapter = <span class="keyword">new</span> SqlDataAdapter())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 设置数据适配器命令 </span></span><br><span class="line">                dataAdapter.UpdateCommand = updateCommand;</span><br><span class="line">                dataAdapter.InsertCommand = insertCommand;</span><br><span class="line">                dataAdapter.DeleteCommand = deleteCommand;</span><br><span class="line">                <span class="comment">// 更新数据集改变到数据库 </span></span><br><span class="line">                dataAdapter.Update(dataSet, tableName);</span><br><span class="line">                <span class="comment">// 提交所有改变到数据集. </span></span><br><span class="line">                dataSet.AcceptChanges();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> CreateCommand 创建一条SqlCommand命令 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 创建SqlCommand命令,指定数据库连接对象,存储过程名和参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlCommand command = CreateCommand(conn, &quot;AddCustomer&quot;, &quot;CustomerID&quot;, &quot;CustomerName&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sourceColumns&quot;&gt;</span>源表的列名称数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlCommand命令<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlCommand <span class="title">CreateCommand</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">string</span>[] sourceColumns</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建命令 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand(spName, connection);</span><br><span class="line">            cmd.CommandType = CommandType.StoredProcedure;</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((sourceColumns != <span class="literal">null</span>) &amp;&amp; (sourceColumns.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 将源表的列到映射到DataSet命令中. </span></span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> index = <span class="number">0</span>; index &lt; sourceColumns.Length; index++)</span><br><span class="line">                    commandParameters[index].SourceColumn = sourceColumns[index];</span><br><span class="line">                <span class="comment">// Attach the discovered parameters to the SqlCommand object </span></span><br><span class="line">                AttachParameters(cmd, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> cmd;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteNonQueryTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回受影响的行数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQueryTypedParams</span>(<span class="params">String connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回受影响的行数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQueryTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事物的存储过程,使用DataRow做为参数值,返回受影响的行数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQueryTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// Sf the row has values, the store procedure parameters must be initialized </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteDatasetTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDatasetTypedParams</span>(<span class="params"><span class="built_in">string</span> connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">//如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDatasetTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事务的存储过程,使用DataRow做为参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDatasetTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteReaderTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回DataReader. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReaderTypedParams</span>(<span class="params">String connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回DataReader. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReaderTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事物的存储过程,使用DataRow做为参数值,返回DataReader. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReaderTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteScalarTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalarTypedParams</span>(<span class="params">String connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalarTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事务的存储过程,使用DataRow做为参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalarTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> ExecuteXmlReaderTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回XmlReader类型的结果集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReaderTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事务的存储过程,使用DataRow做为参数值,返回XmlReader类型的结果集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReaderTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SqlHelperParameterCache提供缓存存储过程参数,并能够在运行时从存储过程中探索参数. </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">SqlHelperParameterCache</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> 私有方法,字段,构造函数 </span></span><br><span class="line">        <span class="comment">// 私有构造函数,妨止类被实例化. </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">SqlHelperParameterCache</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 这个方法要注意 </span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Hashtable paramCache = Hashtable.Synchronized(<span class="keyword">new</span> Hashtable());</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 探索运行时的存储过程,返回SqlParameter参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 初始化参数值为 DBNull.Value. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span>是否包含返回值参数<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlParameter[] <span class="title">DiscoverSpParameterSet</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand(spName, connection);</span><br><span class="line">            cmd.CommandType = CommandType.StoredProcedure;</span><br><span class="line">            connection.Open();</span><br><span class="line">            <span class="comment">// 检索cmd指定的存储过程的参数信息,并填充到cmd的Parameters参数集中. </span></span><br><span class="line">            SqlCommandBuilder.DeriveParameters(cmd);</span><br><span class="line">            connection.Close();</span><br><span class="line">            <span class="comment">// 如果不包含返回值参数,将参数集中的每一个参数删除. </span></span><br><span class="line">            <span class="keyword">if</span> (!includeReturnValueParameter)</span><br><span class="line">            &#123;</span><br><span class="line">                cmd.Parameters.RemoveAt(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建参数数组 </span></span><br><span class="line">            SqlParameter[] discoveredParameters = <span class="keyword">new</span> SqlParameter[cmd.Parameters.Count];</span><br><span class="line">            <span class="comment">// 将cmd的Parameters参数集复制到discoveredParameters数组. </span></span><br><span class="line">            cmd.Parameters.CopyTo(discoveredParameters, <span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 初始化参数值为 DBNull.Value. </span></span><br><span class="line">            <span class="keyword">foreach</span> (SqlParameter discoveredParameter <span class="keyword">in</span> discoveredParameters)</span><br><span class="line">            &#123;</span><br><span class="line">                discoveredParameter.Value = DBNull.Value;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> discoveredParameters;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> SqlParameter参数数组的深层拷贝. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;originalParameters&quot;&gt;</span>原始参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个同样的参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlParameter[] <span class="title">CloneParameters</span>(<span class="params">SqlParameter[] originalParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            SqlParameter[] clonedParameters = <span class="keyword">new</span> SqlParameter[originalParameters.Length];</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>, j = originalParameters.Length; i &lt; j; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                clonedParameters[i] = (SqlParameter)((ICloneable)originalParameters[i]).Clone();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> clonedParameters;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> 私有方法,字段,构造函数结束</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> 缓存方法</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 追加参数数组到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>要缓存的参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CacheParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandText == <span class="literal">null</span> || commandText.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;commandText&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> hashKey = connectionString + <span class="string">&quot;:&quot;</span> + commandText;</span><br><span class="line">            paramCache[hashKey] = commandParameters;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 从缓存中获取参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetCachedParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandText == <span class="literal">null</span> || commandText.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;commandText&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> hashKey = connectionString + <span class="string">&quot;:&quot;</span> + commandText;</span><br><span class="line">            SqlParameter[] cachedParameters = paramCache[hashKey] <span class="keyword">as</span> SqlParameter[];</span><br><span class="line">            <span class="keyword">if</span> (cachedParameters == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> CloneParameters(cachedParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> 缓存方法结束</span></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> 检索指定的存储过程的参数集</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 返回指定的存储过程的参数集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> GetSpParameterSet(connectionString, spName, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 返回指定的存储过程的参数集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符.<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span>是否包含返回值参数<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> GetSpParameterSetInternal(connection, spName, includeReturnValueParameter);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [内部]返回指定的存储过程的参数集(使用连接对象). </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接字符<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> GetSpParameterSet(connection, spName, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [内部]返回指定的存储过程的参数集(使用连接对象) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 是否包含返回值参数 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">using</span> (SqlConnection clonedConnection = (SqlConnection)((ICloneable)connection).Clone())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> GetSpParameterSetInternal(clonedConnection, spName, includeReturnValueParameter);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [私有]返回指定的存储过程的参数集(使用连接对象) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span>是否包含返回值参数<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSetInternal</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> hashKey = connection.ConnectionString + <span class="string">&quot;:&quot;</span> + spName + (includeReturnValueParameter ? <span class="string">&quot;:include ReturnValue Parameter&quot;</span> : <span class="string">&quot;&quot;</span>);</span><br><span class="line">            SqlParameter[] cachedParameters;</span><br><span class="line">            cachedParameters = paramCache[hashKey] <span class="keyword">as</span> SqlParameter[];</span><br><span class="line">            <span class="keyword">if</span> (cachedParameters == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] spParameters = DiscoverSpParameterSet(connection, spName, includeReturnValueParameter);</span><br><span class="line">                paramCache[hashKey] = spParameters;</span><br><span class="line">                cachedParameters = spParameters;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> CloneParameters(cachedParameters);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span> 参数集检索结束</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CSharp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
            <tag> .NET </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用端口及范围</title>
      <link href="/2021/06/12/488d33cd9c1d/"/>
      <url>/2021/06/12/488d33cd9c1d/</url>
      
        <content type="html"><![CDATA[<h3 id="端口范围"><a href="#端口范围" class="headerlink" title="端口范围"></a>端口范围</h3><p>一般用到的是1到65535，其中0一般不使用。端口号可分为3大类：<br>1、公认端口（Well Known Ports）：从0到1023，它们紧密绑定（binding）于一些服务。通常这些端口的通讯明确表明了某种服务的协议。例如：80端口实际上总是HTTP通讯。<br>2、注册端口（Registered Ports）：从1024到49151。它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用于许多其它目的。例如：许多系统处理动态端口从1024左右开始。<br>3、动态和&#x2F;或私有端口（Dynamic and&#x2F;or Private Ports）：从49152到65535。理论上，不应为服务分配这些端口。实际上，机器通常从1024起分配动态端口。但也有例外：SUN的RPC端口从32768开始。</p><h3 id="常用版"><a href="#常用版" class="headerlink" title="常用版"></a>常用版</h3><p>21：FTP服务所开放的端口，用于上传、下载文件。<br>22：SSH端口，用于通过命令行模式远程连接Linux服务器或vps。<br>23：Telnet端口，用于Telnet远程登录服务器。<br>25：SMTP服务所开放的端口，用于发送邮件。<br>80：HTTP用于HTTP服务提供访问功能，例如，IIS、Apache、Nginx 等服务。<br>110：POP3用于POP3 协议，POP3 是电子邮件收发的协议。<br>143：IMAP用于IMAP（Internet Message Access Protocol）协议，IMAP 是用于电子邮件的接收的协议。<br>443：HTTPS 用于HTTPS服务提供访问功能。HTTPS 是一种能提供加密和通过安全端口传输的一种协议。<br>1433：SQL Server SQL Server的TCP 端口，用于供SQL Server对外提供服务。<br>1434：SQL Server SQL Server的UDP端口，用于返回SQL Server使用了哪个 TCP&#x2F;IP 端口。<br>1521：Oracle通信端口，服务器上部署了Oracle SQL需要放行的端口。<br>3306：MySQL数据库对外提供服务的端口。<br>3389：远程桌面服务端口，可以通过这个端口远程连接服务器。<br>8080：代理端口,同80端口一样，8080 端口常用于WWW代理服务，实现网页浏览。</p><h3 id="简易版"><a href="#简易版" class="headerlink" title="简易版"></a>简易版</h3><p>0 端口：无效端口,通常用于分析操作系统<br>1 端口：传输控制协议端口服务多路开关选择器<br>2 端口：管理实用程序<br>3 端口：压缩进程<br>5 端口：远程作业登录<br>7 端口：回显<br>9 端口：丢弃<br>11 端口：在线用户<br>13 端口：时间<br>17 端口：每日引用<br>18 端口：消息发送协议<br>19 端口：字符发生器<br>20 端口：FTP 文件传输协议(默认数据口)<br>21 端口：FTP 文件传输协议(控制)<br>22 端口：SSH 远程登录协议<br>23 端口：telnet(终端仿真协议),木马 Tiny Telnet Server 开放此端口<br>24 端口：预留给个人用邮件系统<br>25 端口：SMTP 服务器所开放的端口，用于发送邮件<br>27 端口：NSW 用户系统 FE<br>29 端口：MSG ICP<br>31 端口：MSG 验证,木马 Master Paradise、HackersParadise 开放此端口<br>33 端口：显示支持协议<br>35 端口：预留给个人打印机服务<br>37 端口：时间<br>38 端口：路由访问协议<br>39 端口：资源定位协议<br>41 端口：图形<br>42 端口：主机名服务<br>43 端口：who is 服务<br>44 端口：MPM(消息处理模块)标志协议<br>45 端口：消息处理模块<br>46 端口：消息处理模块(默认发送口)<br>47 端口：NI FTP<br>48 端口：数码音频后台服务<br>49 端口：TACACS 登录主机协议<br>50 端口：远程邮件检查协议<br>51 端口：IMP(接口信息处理机)逻辑地址维护<br>52 端口：施乐网络服务系统时间协议<br>53 端口：dns 域名服务器<br>54 端口：施乐网络服务系统票据交换<br>55 端口：ISI 图形语言<br>56 端口：施乐网络服务系统验证<br>57 端口：预留个人用终端访问<br>58 端口：施乐网络服务系统邮件<br>59 端口：预留个人文件服务<br>60 端口：未定义<br>61 端口：NI 邮件<br>62 端口：异步通讯适配器服务<br>63 端口：whois++<br>64 端口：通讯接口<br>65 端口：TACACS 数据库服务<br>66 端口：Oracle SQL*NET<br>67 端口：引导程序协议服务端<br>68 端口：引导程序协议客户端<br>69 端口：小型文件传输协议<br>70 端口：信息检索协议<br>71 端口：远程作业服务<br>72 端口：远程作业服务<br>73 端口：远程作业服务<br>74 端口：远程作业服务<br>75 端口：预留给个人拨出服务<br>76 端口：分布式外部对象存储<br>77 端口：预留给个人远程作业输入服务<br>78 端口：修正 TCP<br>79 端口：查询远程主机在线用户等信息<br>80 端口：http,用于网页浏览,木马 Executor 开放此端口<br>81 端口：HOST2 名称服务<br>82 端口：传输实用程序<br>83 端口：模块化智能终端 ML 设备<br>84 端口：公用追踪设备<br>85 端口：模块化智能终端 ML 设备<br>86 端口：Micro Focus Cobol 编程语言<br>87 端口：预留给个人终端连接<br>88 端口：Kerberros 安全认证系统<br>89 端口：SU&#x2F;MIT telnet(终端仿真网关)<br>90 端口：DNSIX 安全属性标记图<br>91 端口：MIT Dover 假脱机<br>92 端口：网络打印协议<br>93 端口：设备控制协议<br>94 端口：Tivoli 对象调度<br>96 端口：DIXIE 协议规范<br>97 端口：快速远程虚拟文件协议<br>98 端口：TAC 新闻协议<br>99 端口：后门程序 ncx99 开放此端口<br>100 端口：未知用途<br>101 端口：NIC 主机名称服务<br>102 端口：消息传输代理<br>103 端口：Genesis 点对点传输网络<br>105 端口：信箱名称服务<br>106 端口：3COM-TSMUX 开放端口<br>107 端口：远程 Telnet 服务<br>108 端口：SNA 网关访问服务<br>109 端口：POP2 服务器开放此端口,用于接收邮件<br>110 端口：POP3 服务器开放此端口,用于接收邮件<br>111 端口：SUN 公司的 RPC 服务所有端口<br>112 端口：McIDAS 数据传输协议<br>113 端口：认证服务，用于鉴别 TCP 连接的用户<br>114 端口：音频新闻多点服务<br>115 端口：简单文件传输服务<br>116 端口：ANSA REX 通知<br>117 端口：UUCP 路径服务<br>118 端口：SQL 服务<br>119 端口：NEWS 新闻组传输协议，承载 USENET 通信<br>121 端口：木马 BO jammerkillahV 开放端口<br>122 端口：SMAKY 网络<br>123 端口：网络时间协议，蠕虫病毒会利用，一般关闭<br>128 端口：GSS X 许可认证<br>129 端口：密码生成器协议<br>130 端口：Cisco 软件开放端口<br>131 端口：Cisco 软件开放端口<br>132 端口：Cisco 软件开放端口<br>133 端口：统计服务<br>134 端口：INGRES-网络服务<br>135 端口：DCOM 服务，冲击波病毒利用，不能关闭<br>136 端口：命名系统<br>137 端口：NETBIOS 协议应用，为共享开放<br>138 端口：NETBIOS 协议应用，为共享开放<br>139 端口：NETBIOS 协议应用，为共享开放<br>140 端口：EMFIS 数据服务<br>141 端口：EMFIS 控制服务<br>143 端口：Interim 邮件访问协议<br>144 端口：UMA 软件开放端口<br>145 端口：UAAC 协议<br>149 端口：AED 512 仿真服务<br>150 端口：SQL(结构化查询语言)-网络<br>152 端口：后台文件传输协议<br>156 端口：SQL(结构化查询语言)服务<br>158 端口：PC 邮件服务器<br>159 端口：NSS-路由<br>160 端口：SGMP-陷阱<br>161 端口：简单网络管理协议<br>162 端口：SNMP 陷阱<br>163 端口：CMIP&#x2F;TCP 管理<br>164 端口：CMIP&#x2F;TCP 代理<br>166 端口：Sirius 系统<br>169 端口：发送<br>170 端口：网络附言<br>177 端口：x 显示管理控制协议，入侵者通过它访问 X-windows 操作台<br>178 端口：NextStep Window 服务<br>179 端口：边界网关协议<br>180 端口：图表<br>181 端口：统一<br>184 端口：OC 服务器<br>185 端口：远程-KIS<br>186 端口：KIS 协议<br>187 端口：应用通信接口<br>189 端口：队列文件传输<br>190 端口：网关进入控制协议<br>191 端口：Prospero 目录服务<br>192 端口：OSU 网络监视系统<br>193 端口：Spider 远程控制协议<br>194 端口：多线交谈协议<br>197 端口：目录地址服务<br>198 端口：目录地址服务监视器<br>200 端口：IBM 系统资源控制器<br>201 端口：AppleTalk(Mac 机所用的网络协议)路由保证<br>202 端口：AppleTalk(Mac 机所用的网络协议)Name Binding<br>203 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>204 端口：AppleTalk(Mac 机所用的网络协议)回显<br>205 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>206 端口：AppleTalk(Mac 机所用的网络协议)区信息<br>207 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>208 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>209 端口：快速邮件传输协议<br>210 端口：ANSI(美国国家标准协会)Z39.50<br>211 端口：Texas Instruments 914C&#x2F;G 终端<br>213 端口：IPX(以太网所用的协议)<br>218 端口：Netix 消息记录协议<br>219 端口：Unisys ARPs<br>220 端口：交互邮件访问协议 v3<br>223 端口：证书分发中心<br>224 端口：masq 拨号器<br>241 端口：预留端口 (224-241)<br>245 端口：链接<br>246 端口：显示系统协议<br>257 端口：安全电子交易系统<br>258 端口：Yak Winsock 个人聊天<br>259 端口：有效短程遥控<br>260 端口：开放端口<br>261 端口：IIOP 基于 TLS&#x2F;SSL 的命名服务<br>266 端口：SCSI(小型计算机系统接口)on ST<br>267 端口：Tobit David 服务层<br>268 端口：Tobit David 复制<br>281 端口：个人连结<br>282 端口：Cable 端口 A&#x2F;X<br>286 端口：FXP 通信<br>308 端口：Novastor 备份<br>313 端口：Magenta 逻辑<br>318 端口：PKIX 时间标记<br>333 端口：Texar 安全端口<br>344 端口：Prospero 数据存取协议<br>345 端口：Perf 分析工作台<br>346 端口：Zebra 服务器<br>347 端口：Fatmen 服务器<br>348 端口：Cabletron 管理协议<br>358 端口：Shrink 可上网家电协议<br>359 端口：网络安全风险管理协议<br>362 端口：SRS 发送<br>363 端口：RSVP 隧道<br>372 端口：列表处理<br>373 端口：Legend 公司<br>374 端口：Legend 公司<br>376 端口：AmigaEnvoy 网络查询协议<br>377 端口：NEC 公司<br>378 端口：NEC 公司<br>379 端口：TIA&#x2F;EIA&#x2F;IS-99 调制解调器客户端<br>380 端口：TIA&#x2F;EIA&#x2F;IS-99 调制解调器服务器<br>381 端口：hp(惠普)性能数据收集器<br>382 端口：hp(惠普)性能数据控制节点<br>383 端口：hp(惠普)性能数据警报管理<br>384 端口：远程网络服务器系统<br>385 端口：IBM 应用程序<br>386 端口：ASA 信息路由器定义文件.<br>387 端口：Appletalk 更新路由.<br>389 端口：轻型目录访问协议<br>395 端口：网络监视控制协议<br>396 端口：Novell(美国 Novell 公司)Netware(Novell 公司出的网络操作系统)over IP<br>400 端口：工作站解决方案<br>401 端口：持续电源<br>402 端口：Genie 协议<br>406 端口：交互式邮件支持协议<br>408 端口：Prospero 资源管理程序<br>409 端口：Prospero 资源节点管理.<br>410 端口：DEC(数据设备公司)远程调试协议<br>411 端口：远程 MT 协议<br>412 端口：陷阱协定端口<br>413 端口：存储管理服务协议<br>414 端口：信息查询<br>415 端口：B 网络<br>423 端口：IBM 操作计划和控制开端<br>424 端口：IBM 操作计划和控制追踪<br>425 端口：智能计算机辅助设计<br>427 端口：服务起位置<br>434 端口：移动 ip 代理<br>435 端口：移动 ip 管理<br>443 端口：基于 TLS&#x2F;SSL 的网页浏览端口，能提供加密和通过安全端口传输的另一种 HTTP<br>444 端口：简单网络内存分页协议<br>445 端口：Microsoft-DS，为共享开放，震荡波病毒利用，一般应关闭<br>446 端口：DDM-远程关系数据库访问<br>447 端口：DDM-分布式文件管理<br>448 端口：DDM-使用安全访问远程数据库<br>456 端口：木马 HACKERS PARADISE 开放此端口<br>458 端口：apple quick time 软件开放端口<br>459 端口：ampr-rcmd 命令<br>464 端口：k 密码服务<br>469 端口：广播控制协议<br>470 端口：scx-代理<br>472 端口：ljk-登陆<br>481 端口：Ph 服务<br>487 端口：简单异步文件传输<br>489 端口：nest-协议<br>491 端口：go-登陆<br>499 端口：ISO ILL 协议<br>500 端口：Internet 密钥交换，Lsass 开放端口，不能关闭<br>509 端口：陷阱<br>510 端口：FirstClass 协议<br>512 端口：远程进程执行<br>513 端口：远程登陆<br>514 端口：cmd 命令<br>515 端口：spooler<br>516 端口：可视化数据<br>518 端口：交谈<br>519 端口：unix 时间<br>520 端口：扩展文件名称服务器<br>525 端口：时间服务<br>526 端口：新日期<br>529 端口：在线聊天系统服务<br>530 端口：远程过程调用<br>531 端口：聊天<br>532 端口：读新闻<br>533 端口：紧急广播端口<br>534 端口：MegaMedia 管理端<br>537 端口：网络流媒体协议<br>542 端口：商业<br>543 端口：Kerberos(软件)v4&#x2F;v5<br>544 端口：krcmd 命令<br>546 端口：DHCPv6 客户端<br>547 端口：DHCPv6 服务器<br>552 端口：设备共享<br>554 端口：Real Time Stream 控制协议<br>555 端口：木马 PhAse1.0、Stealth Spy、IniKiller 开放此端口<br>556 端口：远距离文件服务器<br>563 端口：基于 TLS&#x2F;SSL 的网络新闻传输协议<br>564 端口：plan 9 文件服务<br>565 端口：whoami 查询<br>566 端口：streettalk<br>567 端口：banyan-rpc(远程过程调用)<br>568 端口：DPA 成员资格<br>569 端口：MSN 成员资格<br>570 端口：demon(调试监督程序)<br>571 端口：udemon(调试监督程序)<br>572 端口：声纳<br>573 端口：banyan-贵宾<br>574 端口：FTP 软件代理系统<br>581 端口：Bundle Discovery 协议<br>582 端口：SCC 安全<br>583 端口：Philips 视频会议<br>584 端口：密钥服务器<br>585 端口：IMAP4+SSL (Use 993 instead)<br>586 端口：密码更改<br>587 端口：申请<br>589 端口：Eye 连结<br>595 端口：CAB 协议<br>597 端口：PTC 名称服务<br>598 端口：SCO 网络服务器管理 3<br>599 端口：Aeolon Core 协议<br>600 端口：Sun IPC(进程间通讯)服务器<br>601 端口：可靠系统登陆服务<br>604 端口：通道<br>606 端口：Cray 统一资源管理<br>608 端口：发送人-传递&#x2F;提供 文件传输器<br>609 端口：npmp-陷阱<br>610 端口：npmp-本地<br>611 端口：npmp-gui( 图形用户界面)<br>612 端口：HMMP 指引<br>613 端口：HMMP 操作<br>614 端口：SSL(加密套接字协议层)shell(壳)<br>615 端口：Internet 配置管理<br>616 端口：SCO(Unix 系统)系统管理服务器<br>617 端口：SCO 桌面管理服务器<br>619 端口：Compaq(康柏公司)EVM<br>620 端口：SCO 服务器管理<br>623 端口：ASF 远程管理控制协议<br>624 端口：Crypto 管理<br>631 端口：IPP (Internet 打印协议)<br>633 端口：服务更新(Sterling 软件)<br>637 端口：局域网服务器<br>641 端口：repcmd 命令<br>647 端口：DHCP(动态主机配置协议)Failover<br>648 端口：注册登记协议(RRP)<br>649 端口：Cadview-3d 软件协议<br>666 端口：木马 Attack FTP、Satanz Backdoor 开放此端口<br>808 端口：ccproxy http&#x2F;gopher&#x2F;ftp (over http)协议<br>1001 端口：木马 Silencer，WebEx 开放端口<br>1011 端口：木马 Doly 开放端口<br>1024 端口：动态端口的开始,木马 yai 开放端口<br>1025 端口：inetinfo.exe(互联网信息服务)木马 netspy 开放端口<br>1026 端口：inetinfo.exe(互联网信息服务)<br>1027 端口：应用层网关服务<br>1030 端口：应用层网关服务<br>1031 端口：BBN IAD<br>1033 端口：本地网络信息端口<br>1034 端口：同步通知<br>1036 端口：安全部分传输协议<br>1070 端口：木马 Psyber Stream，Streaming Audio 开放端口<br>1071 端口：网络服务开放端口<br>1074 端口：网络服务开放端口<br>1080 端口：Socks 这一协议以通道方式穿过防火墙，允许防火墙后面的人通过一个 IP 地址访问 INTERNET<br>1110 端口：卡巴斯基反病毒软件开放此端口<br>1125 端口：卡巴斯基反病毒软件开放此端口<br>1203 端口：许可证生效端口<br>1204 端口：登陆请求监听端口<br>1206 端口：Anthony 数据端口<br>1222 端口：SNI R&amp;D 网络端口<br>1233 端口：普遍的附录服务器端口<br>1234 端口：木马 SubSeven2.0、Ultors Trojan 开放此端口<br>1243 端口：木马 SubSeven1.0&#x2F;1.9 开放此端口<br>1245 端口：木马 Vodoo，GabanBus，NetBus，Vodoo 开放此端口<br>1273 端口：EMC-网关端口<br>1289 端口：JWalk 服务器端口<br>1290 端口：WinJa 服务器端口<br>1333 端口：密码策略(网络服务)(svchost.exe)<br>1334 端口：网络服务(svchost.exe)<br>1335 端口：数字公正协议<br>1336 端口：即时聊天协议(svchost.exe)<br>1349 端口：注册网络协议端口<br>1350 端口：注册网络协议端口<br>1352 端口：tcp lotusnote lotus note<br>1371 端口：富士通配置协议端口<br>1372 端口：富士通配置协议端口<br>1374 端口：EPI 软件系统端口<br>1376 端口：IBM 个人-个人软件端口<br>1377 端口：Cichlid 许可证管理端口<br>1378 端口：Elan 许可证管理端口<br>1380 端口：Telesis 网络许可证管理端口<br>1381 端口：苹果网络许可证管理端口<br>1386 端口：CheckSum 许可证管理端口<br>1387 端口：系统开放端口(rundll32.exe)<br>1388 端口：数据库高速缓存端口<br>1389 端口：文档管理端口<br>1390 端口：存储控制器端口<br>1391 端口：存储器存取服务器端口<br>1392 端口：打印管理端口<br>1393 端口：网络登陆服务器端口<br>1394 端口：网络登陆客户端端口<br>1395 端口：PC 工作站管理软件端口<br>1396 端口：DVL 活跃邮件端口<br>1397 端口：音频活跃邮件端口<br>1398 端口：视频活跃邮件端口<br>1399 端口：Cadkey 许可证管理端口<br>1433 端口：Microsoft 的 SQL 服务开放端口<br>1434 端口：Microsoft 的 SQL 服务监视端口<br>1492 端口：木马 FTP99CMP 开放此端口<br>1509 端口：木马 Psyber Streaming Server 开放此端口<br>1512 端口：Microsoft Windows 网络名称服务<br>1524 端口：许多攻击脚本安装一个后门 SHELL 于这个端口<br>1600 端口：木马 Shivka-Burka 开放此端口<br>1645 端口：远程认证拨号用户服务<br>1701 端口：第 2 层隧道协议<br>1731 端口：NetMeeting 音频调用控制<br>1801 端口：Microsoft 消息队列服务器<br>1807 端口：木马 SpySender 开放此端口<br>1900 端口：可被利用 ddos 攻击，一般关闭<br>1912 端口：金山词霸开放此端口<br>1981 端口：木马 ShockRave 开放此端口<br>1999 端口：木马 BackDoor,yai 开放此端口<br>2000 端口：木马 GirlFriend 1.3、Millenium 1.0 开放此端口<br>2001 端口：木马 Millenium 1.0、Trojan Cow,黑洞 2001 开放此端口<br>2003 端口：GNU 查询<br>2023 端口：木马 Pass Ripper 开放此端口<br>2049 端口：NFS 程序常运行于此端口<br>2115 端口：木马 Bugs 开放此端口<br>2140 端口：木马 Deep Throat 1.0&#x2F;3.0，The Invasor 开放此端口<br>2500 端口：应用固定端口会话复制的 RPC 客户<br>2504 端口：网络平衡负荷<br>2565 端口：木马 Striker 开放此端口<br>2583 端口：木马 Wincrash 2.0 开放此端口<br>2801 端口：木马 Phineas Phucker 开放此端口<br>2847 端口：诺顿反病毒服务开放此端口<br>3024 端口：木马 WinCrash 开放此端口<br>3128 端口：squid http 代理服务器开放此端口<br>3129 端口：木马 Master Paradise 开放此端口<br>3150 端口：木马 The Invasor,deep throat 开放此端口<br>3210 端口：木马 SchoolBus 开放此端口<br>3306 端口：MySQL 开放此端口<br>3333 端口：木马 Prosiak 开放此端口<br>3389 端口：WINDOWS 2000 终端开放此端口<br>3456 端口：inetinfo.exe(互联网信息服务)开放端口，VAT 默认数据<br>3457 端口：VAT 默认控制<br>3527 端口：Microsoft 消息队列服务器<br>3700 端口：木马 Portal of Doom 开放此端口<br>3996 端口：木马 RemoteAnything 开放此端口<br>4000 端口：腾讯 QQ 客户端开放此端口<br>4060 端口：木马 RemoteAnything 开放此端口<br>4092 端口：木马 WinCrash 开放此端口<br>4133 端口：NUTS Bootp 服务器<br>4134 端口：NIFTY-Serve HMI 协议<br>4141 端口：Workflow 服务器<br>4142 端口：文档服务器<br>4143 端口：文档复制<br>4145 端口：VVR 控制<br>4321 端口：远程 Who Is 查询<br>4333 端口：微型 sql 服务器<br>4349 端口：文件系统端口记录<br>4350 端口：网络设备<br>4351 端口：PLCY 网络服务<br>4453 端口：NSS 警报管理<br>4454 端口：NSS 代理管理<br>4455 端口：PR 聊天用户<br>4456 端口：PR 聊天服务器<br>4457 端口：PR 注册<br>4480 端口：Proxy+ HTTP 代理端口<br>4500 端口：Lsass 开放端口，不能关闭<br>4547 端口：Lanner 许可管理<br>4555 端口：RSIP 端口<br>4590 端口：木马 ICQTrojan 开放此端口<br>4672 端口：远程文件访问服务器<br>4752 端口：简单网络音频服务器<br>4800 端口：Icona 快速消息系统<br>4801 端口：Icona 网络聊天<br>4802 端口：Icona 许可系统服务器<br>4848 端口：App 服务器-Admin HTTP<br>4849 端口：App 服务器-Admin HTTPS<br>4950 端口：木马 IcqTrojan 开放 5000 端口<br>5000 端口：木马 blazer5，Sockets de Troie 开放 5000 端口，一般应关闭<br>5001 端口：木马 Sockets de Troie 开放 5001 端口<br>5006 端口：wsm 服务器<br>5007 端口：wsm 服务器 ssl<br>5022 端口：mice 服务器<br>5050 端口：多媒体会议控制协议<br>5051 端口：ITA 代理<br>5052 端口：ITA 管理<br>5137 端口：MyCTS 服务器端口<br>5150 端口：Ascend 通道管理协议<br>5154 端口：BZFlag 游戏服务器<br>5190 端口：America-Online(美国在线)<br>5191 端口：AmericaOnline1(美国在线)<br>5192 端口：AmericaOnline2(美国在线)<br>5193 端口：AmericaOnline3(美国在线)<br>5222 端口：Jabber 客户端连接<br>5225 端口：HP(惠普公司)服务器<br>5226 端口：HP(惠普公司)<br>5232 端口：SGI 绘图软件端口<br>5250 端口：i 网关<br>5264 端口：3Com 网络端口 1<br>5265 端口：3Com 网络端口 2<br>5269 端口：Jabber 服务器连接<br>5306 端口：Sun MC 组<br>5321 端口：木马 Sockets de Troie 开放 5321 端口<br>5400 端口：木马 Blade Runner 开放此端口<br>5401 端口：木马 Blade Runner 开放此端口<br>5402 端口：木马 Blade Runner 开放此端口<br>5405 端口：网络支持<br>5409 端口：Salient 数据服务器<br>5410 端口：Salient 用户管理<br>5415 端口：NS 服务器<br>5416 端口：SNS 网关<br>5417 端口：SNS 代理<br>5421 端口：网络支持 2<br>5423 端口：虚拟用户<br>5427 端口：SCO-PEER-TTA(Unix 系统)<br>5432 端口：PostgreSQL 数据库<br>5550 端口：木马 xtcp 开放此端口<br>5569 端口：木马 Robo-Hack 开放此端口<br>5599 端口：公司远程安全安装<br>5600 端口：公司安全管理<br>5601 端口：公司安全代理<br>5631 端口：pcANYWHERE(软件)数据<br>5632 端口：pcANYWHERE(软件)数据<br>5673 端口：JACL 消息服务器<br>5675 端口：V5UA 应用端口<br>5676 端口：RA 管理<br>5678 端口：远程复制代理连接<br>5679 端口：直接电缆连接<br>5720 端口：MS-执照<br>5729 端口：Openmail 用户代理层<br>5730 端口：Steltor’s 日历访问<br>5731 端口：netscape(网景)suiteware<br>5732 端口：netscape(网景)suiteware<br>5742 端口：木马 WinCrash1.03 开放此端口<br>5745 端口：fcopy-服务器<br>5746 端口：fcopys-服务器<br>5755 端口：OpenMail(邮件服务器)桌面网关服务器<br>5757 端口：OpenMail(邮件服务器)X.500 目录服务器<br>5766 端口：OpenMail (邮件服务器)NewMail 服务器<br>5767 端口：OpenMail (邮件服务器)请求代理曾(安全)<br>5768 端口：OpenMail(邮件服务器) CMTS 服务器<br>5777 端口：DALI 端口<br>5800 端口：虚拟网络计算<br>5801 端口：虚拟网络计算<br>5802 端口：虚拟网络计算 HTTP 访问, d<br>5803 端口：虚拟网络计算 HTTP 访问, d<br>5900 端口：虚拟网络计算机显示 0<br>5901 端口：虚拟网络计算机显示 1<br>5902 端口：虚拟网络计算机显示 2<br>5903 端口：虚拟网络计算机显示 3<br>6000 端口：X Window 系统<br>6001 端口：X Window 服务器<br>6002 端口：X Window 服务器<br>6003 端口：X Window 服务器<br>6004 端口：X Window 服务器<br>6005 端口：X Window 服务器<br>6006 端口：X Window 服务器<br>6007 端口：X Window 服务器<br>6008 端口：X Window 服务器<br>6009 端口：X Window 服务器<br>6456 端口：SKIP 证书发送<br>6471 端口：LVision 许可管理器<br>6505 端口：BoKS 管理私人端口<br>6506 端口：BoKS 管理公共端口<br>6507 端口：BoKS Dir 服务器,私人端口<br>6508 端口：BoKS Dir 服务器,公共端口<br>6509 端口：MGCS-MFP 端口<br>6510 端口：MCER 端口<br>6566 端口：SANE 控制端口<br>6580 端口：Parsec 主服务器<br>6581 端口：Parsec 对等网络<br>6582 端口：Parsec 游戏服务器<br>6588 端口：AnalogX HTTP 代理端口<br>6631 端口：Mitchell 电信主机<br>6667 端口：Internet 多线交谈<br>6668 端口：Internet 多线交谈<br>6670 端口：木马 Deep Throat 开放此端口<br>6671 端口：木马 Deep Throat 3.0 开放此端口<br>6699 端口：Napster 文件(MP3)共享服务<br>6701 端口：KTI&#x2F;ICAD 名称服务器<br>6788 端口：SMC 软件-HTTP<br>6789 端口：SMC 软件-HTTPS<br>6841 端口：Netmo 软件默认开放端口<br>6842 端口：Netmo HTTP 服务<br>6883 端口：木马 DeltaSource 开放此端口<br>6939 端口：木马 Indoctrination 开放此端口<br>6969 端口：木马 Gatecrasher、Priority 开放此端口<br>6970 端口：real 音频开放此端口<br>7000 端口：木马 Remote Grab 开放此端口<br>7002 端口：使用者&amp; 组 数据库<br>7003 端口：音量定位数据库<br>7004 端口：AFS&#x2F;Kerberos 认证服务<br>7005 端口：音量管理服务<br>7006 端口：错误解释服务<br>7007 端口：Basic 监督进程<br>7008 端口：服务器-服务器更新程序<br>7009 端口：远程缓存管理服务<br>7011 端口：Talon 软件发现端口<br>7012 端口：Talon 软件引擎<br>7013 端口：Microtalon 发现<br>7014 端口：Microtalon 通信<br>7015 端口：Talon 网络服务器<br>7020 端口：DP 服务<br>7021 端口：DP 服务管理<br>7100 端口：X 字型服务<br>7121 端口：虚拟原型许可证管理<br>7300 端口：木马 NetMonitor 开放此端口<br>7301 端口：木马 NetMonitor 开放此端口<br>7306 端口：木马 NetMonitor，NetSpy1.0 开放此端口<br>7307 端口：木马 NetMonitor 开放此端口<br>7308 端口：木马 NetMonitor 开放此端口<br>7323 端口：Sygate 服务器端<br>7511 端口：木马聪明基因开放此端口<br>7588 端口：Sun 许可证管理<br>7597 端口：木马 Quaz 开放此端口<br>7626 端口：木马冰河开放此端口<br>7633 端口：PMDF 管理<br>7674 端口：iMQ SSL 通道<br>7675 端口：iMQ 通道<br>7676 端口：木马 Giscier 开放此端口<br>7720 端口：Med 图象入口<br>7743 端口：Sakura 脚本传递协议<br>7789 端口：木马 ICKiller 开放此端口<br>7797 端口：Propel 连接器端口<br>7798 端口：Propel 编码器端口<br>8000 端口：腾讯 QQ 服务器端开放此端口<br>8001 端口：VCOM 通道<br>8007 端口：Apache(类似 iis)jServ 协议 1.x<br>8008 端口：HTTP Alternate<br>8009 端口：Apache(类似 iis)JServ 协议 1.3<br>8010 端口：Wingate 代理开放此端口<br>8011 端口：木马 way2.4 开放此端口<br>8022 端口：OA-系统<br>8080 端口：WWW 代理开放此端口<br>8081 端口：ICECap 控制台<br>8082 端口：BlackIce(防止黑客软件)警报发送到此端口<br>8118 端口：Privoxy HTTP 代理<br>8121 端口：Apollo 数据端口<br>8122 端口：Apollo 软件管理端口<br>8181 端口：Imail<br>8225 端口：木马灰鸽子开放此端口<br>8311 端口：木马初恋情人开放此端口<br>8351 端口：服务器寻找<br>8416 端口：eSpeech Session 协议<br>8417 端口：eSpeech RTP 协议<br>8473 端口：虚拟点对点<br>8668 端口：网络地址转换<br>8786 端口：Message 客户端<br>8787 端口：Message 服务器<br>8954 端口：Cumulus 管理端口<br>9000 端口：CS 监听<br>9001 端口：ETL 服务管理<br>9002 端口：动态 id 验证<br>9021 端口：Pangolin 验证<br>9022 端口：PrivateArk 远程代理<br>9023 端口：安全网络登陆-1<br>9024 端口：安全网络登陆-2<br>9025 端口：安全网络登陆-3<br>9026 端口：安全网络登陆-4<br>9101 端口：Bacula 控制器<br>9102 端口：Bacula 文件后台<br>9103 端口：Bacula 存储邮件后台<br>9111 端口：DragonIDS 控制台<br>9217 端口：FSC 通讯端口<br>9281 端口：软件传送端口 1<br>9282 端口：软件传送端口 2<br>9346 端口：C 技术监听<br>9400 端口：木马 Incommand 1.0 开放此端口<br>9401 端口：木马 Incommand 1.0 开放此端口<br>9402 端口：木马 Incommand 1.0 开放此端口<br>9594 端口：信息系统<br>9595 端口：Ping Discovery 服务<br>9800 端口：WebDav 源端口<br>9801 端口：Sakura 脚本转移协议-2<br>9802 端口：WebDAV Source TLS&#x2F;SSL<br>9872 端口：木马 Portal of Doom 开放此端口<br>9873 端口：木马 Portal of Doom 开放此端口<br>9874 端口：木马 Portal of Doom 开放此端口<br>9875 端口：木马 Portal of Doom 开放此端口<br>9899 端口：木马 InIkiller 开放此端口<br>9909 端口：域名时间<br>9911 端口：SYPECom 传送协议<br>9989 端口：木马 iNi-Killer 开放此端口<br>9990 端口：OSM Applet 程序服务器<br>9991 端口：OSM 事件服务器<br>10000 端口：网络数据管理协议<br>10001 端口：SCP 构造端口<br>10005 端口：安全远程登陆<br>10008 端口：Octopus 多路器<br>10067 端口：木马 iNi-Killer 开放此端口<br>10113 端口：NetIQ 端点<br>10115 端口：NetIQ 端点<br>10116 端口：NetIQVoIP 鉴定器<br>10167 端口：木马 iNi-Killer 开放此端口<br>11000 端口：木马 SennaSpy 开放此端口<br>11113 端口：金山词霸开放此端口<br>11233 端口：木马 Progenic trojan 开放此端口<br>12076 端口：木马 Telecommando 开放此端口<br>12223 端口：木马 Hack’99 KeyLogger 开放此端口<br>12345 端口：木马 NetBus1.60&#x2F;1.70、GabanBus 开放此端口<br>12346 端口：木马 NetBus1.60&#x2F;1.70、GabanBus 开放此端口<br>12361 端口：木马 Whack-a-mole 开放此端口<br>13223 端口：PowWow 客户端，是 Tribal Voice 的聊天程序<br>13224 端口：PowWow 服务器，是 Tribal Voice 的聊天程序<br>16959 端口：木马 Subseven 开放此端口<br>16969 端口：木马 Priority 开放此端口<br>17027 端口：外向连接<br>19191 端口：木马蓝色火焰开放此端口<br>20000 端口：木马 Millennium 开放此端口<br>20001 端口：木马 Millennium 开放此端口<br>20034 端口：木马 NetBus Pro 开放此端口<br>21554 端口：木马 GirlFriend 开放此端口<br>22222 端口：木马 Prosiak 开放此端口<br>23444 端口：木马网络公牛开放此端口<br>23456 端口：木马 Evil FTP、Ugly FTP 开放此端口<br>25793 端口：Vocaltec 地址服务器<br>26262 端口：K3 软件-服务器<br>26263 端口：K3 软件客户端<br>26274 端口：木马 Delta 开放此端口<br>27374 端口：木马 Subseven 2.1 开放此端口<br>30100 端口：木马 NetSphere 开放此端口<br>30129 端口：木马 Masters Paradise 开放此端口<br>30303 端口：木马 Socket23 开放此端口<br>30999 端口：木马 Kuang 开放此端口<br>31337 端口：木马 BO(Back Orifice)开放此端口<br>31338 端口：木马 BO(Back Orifice)，DeepBO 开放此端口<br>31339 端口：木马 NetSpy DK 开放此端口<br>31666 端口：木马 BOWhack 开放此端口<br>31789 端口：Hack-a-tack<br>32770 端口：sun solaris RPC 服务开放此端口<br>33333 端口：木马 Prosiak 开放此端口<br>33434 端口：路由跟踪<br>34324 端口：木马 Tiny Telnet Server、BigGluck、TN 开放此端口<br>36865 端口：KastenX 软件端口<br>38201 端口：Galaxy7 软件数据通道<br>39681 端口：TurboNote 默认端口<br>40412 端口：木马 The Spy 开放此端口<br>40421 端口：木马 Masters Paradise 开放此端口<br>40422 端口：木马 Masters Paradise 开放此端口<br>40423 端口：木马 Masters Paradise 开放此端口<br>40426 端口：木马 Masters Paradise 开放此端口<br>40843 端口：CSCC 防火墙<br>43210 端口：木马 SchoolBus 1.0&#x2F;2.0 开放此端口<br>43190 端口：IP-PROVISION<br>44321 端口：PCP 服务器(pmcd)<br>44322 端口：PCP 服务器(pmcd)代理<br>44334 端口：微型个人防火墙端口<br>44442 端口：ColdFusion 软件端口<br>44443 端口：ColdFusion 软件端口<br>44445 端口：木马 Happypig 开放此端口<br>45576 端口：E 代时光专业代理开放此端口<br>47262 端口：木马 Delta 开放此端口<br>47624 端口：Direct Play 服务器<br>47806 端口：ALC 协议<br>48003 端口：Nimbus 网关<br>50505 端口：木马 Sockets de Troie 开放此端口<br>50766 端口：木马 Fore 开放此端口<br>53001 端口：木马 Remote Windows Shutdown 开放此端口<br>54320 端口：木马 bo2000 开放此端口<br>54321 端口：木马 SchoolBus 1.0&#x2F;2.0 开放此端口<br>61466 端口：木马 Telecommando 开放此端口<br>65000 端口：木马 Devil 1.03 开放此端口<br>65301 端口：PC Anywhere 软件开放端口</p><h3 id="复杂版"><a href="#复杂版" class="headerlink" title="复杂版"></a>复杂版</h3><p>端口：0<br>服务：Reserved<br>说明：通常用于分析操作系统。这一方法能够工作是因为在一些系统中“0”是无效端口，当你试图使用通常的闭合端口连接它时将产生不同的结果。一种典型的扫描，使用IP地址为0.0.0.0，设置ACK位并在以太网层广播。</p><p>端口：1<br>服务：tcpmux<br>说明：这显示有人在寻找SGI Irix机器。Irix是实现tcpmux的主要提供者，默认情况下tcpmux在这种系统中被打开。Irix机器在发布是含有几个默认的无密码的帐户，如：IP、GUEST UUCP、NUUCP、DEMOS 、TUTOR、DIAG、OUTOFBOX等。许多管理员在安装后忘记删除这些帐户。因此HACKER在INTERNET上搜索tcpmux并利用这些帐户。</p><p>端口：7<br>服务：Echo<br>说明：能看到许多人搜索Fraggle放大器时，发送到X.X.X.0和X.X.X.255的信息。</p><p>端口：19<br>服务：Character Generator<br>说明：这是一种仅仅发送字符的服务。UDP版本将会在收到UDP包后回应含有垃圾字符的包。TCP连接时会发送含有垃圾字符的数据流直到连接关闭。HACKER利用IP欺骗可以发动DoS攻击。伪造两个chargen服务器之间的UDP包。同样Fraggle DoS攻击向目标地址的这个端口广播一个带有伪造受害者IP的数据包，受害者为了回应这些数据而过载。</p><p>端口：21<br>服务：FTP<br>说明：FTP服务器所开放的端口，用于上传、下载。最常见的攻击者用于寻找打开anonymous的FTP服务器的方法。这些服务器带有可读写的目录。木马Doly Trojan、Fore、Invisible FTP、WebEx、WinCrash和Blade Runner所开放的端口。</p><p>端口：22<br>服务：Ssh<br>说明：PcAnywhere建立的TCP和这一端口的连接可能是为了寻找ssh。这一服务有许多弱点，如果配置成特定的模式，许多使用RSAREF库的版本就会有不少的漏洞存在。</p><p>端口：23<br>服务：Telnet<br>说明：远程登录，入侵者在搜索远程登录UNIX的服务。大多数情况下扫描这一端口是为了找到机器运行的操作系统。还有使用其他技术，入侵者也会找到密码。木马Tiny Telnet Server就开放这个端口。</p><p>端口：25<br>服务：SMTP<br>说明：SMTP服务器所开放的端口，用于发送邮件。入侵者寻找SMTP服务器是为了传递他们的SPAM。入侵者的帐户被关闭，他们需要连接到高带宽的E-MAIL服务器上，将简单的信息传递到不同的地址。木马Antigen、Email Password Sender、Haebu Coceda、Shtrilitz Stealth、WinPC、WinSpy都开放这个端口。</p><p>端口：31<br>服务：MSG Authentication<br>说明：木马Master Paradise、Hackers Paradise开放此端口。</p><p>端口：42<br>服务：WINS Replication<br>说明：WINS复制</p><p>端口：53<br>服务：Domain Name Server（DNS）<br>说明：DNS服务器所开放的端口，入侵者可能是试图进行区域传递（TCP），欺骗DNS（UDP）或隐藏其他的通信。因此防火墙常常过滤或记录此端口。</p><p>端口：67<br>服务：Bootstrap Protocol Server<br>说明：通过DSL和Cable modem的防火墙常会看见大量发送到广播地址255.255.255.255的数据。这些机器在向DHCP服务器请求一个地址。HACKER常进入它们，分配一个地址把自己作为局部路由器而发起大量中间人（man-in-middle）攻击。客户端向68端口广播请求配置，服务器向67端口广播回应请求。这种回应使用广播是因为客户端还不知道可以发送的IP地址。</p><p>端口：69<br>服务：Trival File Transfer<br>说明：许多服务器与bootp一起提供这项服务，便于从系统下载启动代码。但是它们常常由于错误配置而使入侵者能从系统中窃取任何文件。它们也可用于系统写入文件。</p><p>端口：79<br>服务：Finger Server<br>说明：入侵者用于获得用户信息，查询操作系统，探测已知的缓冲区溢出错误，回应从自己机器到其他机器Finger扫描。</p><p>端口：80<br>服务：HTTP<br>说明：用于网页浏览。木马Executor开放此端口。</p><p>端口：99<br>服务：gram Relay<br>说明：后门程序ncx99开放此端口。</p><p>端口：102<br>服务：Message transfer agent(MTA)-X.400 over TCP&#x2F;IP<br>说明：消息传输代理。</p><p>端口：109<br>服务：Post Office Protocol -Version3<br>说明：POP3服务器开放此端口，用于接收邮件，客户端访问服务器端的邮件服务。POP3服务有许多公认的弱点。关于用户名和密码交换缓冲区溢出的弱点至少有20个，这意味着入侵者可以在真正登陆前进入系统。成功登陆后还有其他缓冲区溢出错误。</p><p>端口：110<br>服务：SUN公司的RPC服务所有端口<br>说明：常见RPC服务有rpc.mountd、NFS、rpc.statd、rpc.csmd、rpc.ttybd、amd等</p><p>端口：113<br>服务：Authentication Service<br>说明：这是一个许多计算机上运行的协议，用于鉴别TCP连接的用户。使用标准的这种服务可以获得许多计算机的信息。但是它可作为许多服务的记录器，尤其是FTP、POP、IMAP、SMTP和IRC等服务。通常如果有许多客户通过防火墙访问这些服务，将会看到许多这个端口的连接请求。记住，如果阻断这个端口客户端会感觉到在防火墙另一边与E-MAIL服务器的缓慢连接。许多防火墙支持TCP连接的阻断过程中发回RST。这将会停止缓慢的连接。</p><p>端口：119<br>服务：Network News Transfer Protocol<br>说明：NEWS新闻组传输协议，承载USENET通信。这个端口的连接通常是人们在寻找USENET服务器。多数ISP限制，只有他们的客户才能访问他们的新闻组服务器。打开新闻组服务器将允许发&#x2F;读任何人的帖子，访问被限制的新闻组服务器，匿名发帖或发送SPAM。</p><p>端口：135<br>服务：Location Service<br>说明：Microsoft在这个端口运行DCE RPC end-point mapper为它的DCOM服务。这与UNIX 111端口的功能很相似。使用DCOM和RPC的服务利用计算机上的end-point mapper注册它们的位置。远端客户连接到计算机时，它们查找end-point mapper找到服务的位置。HACKER扫描计算机的这个端口是为了找到这个计算机上运行Exchange Server吗？什么版本？还有些DOS攻击直接针对这个端口。</p><p>端口：137、138、139<br>服务：NETBIOS Name Service<br>说明：其中137、138是UDP端口，当通过网上邻居传输文件时用这个端口。而139端口：通过这个端口进入的连接试图获得NetBIOS&#x2F;SMB服务。这个协议被用于windows文件和打印机共享和SAMBA。还有WINS Regisrtation也用它。</p><p>端口：143<br>服务：Interim Mail Access Protocol v2<br>说明：和POP3的安全问题一样，许多IMAP服务器存在有缓冲区溢出漏洞。记住：一种LINUX蠕虫（admv0rm）会通过这个端口繁殖，因此许多这个端口的扫描来自不知情的已经被感染的用户。当REDHAT在他们的LINUX发布版本中默认允许IMAP后，这些漏洞变的很流行。这一端口还被用于IMAP2，但并不流行。</p><p>端口：161<br>服务：SNMP<br>说明：SNMP允许远程管理设备。所有配置和运行信息的储存在数据库中，通过SNMP可获得这些信息。许多管理员的错误配置将被暴露在Internet。Cackers将试图使用默认的密码public、private访问系统。他们可能会试验所有可能的组合。SNMP包可能会被错误的指向用户的网络。</p><p>端口：177<br>服务：X Display Manager Control Protocol<br>说明：许多入侵者通过它访问X-windows操作台，它同时需要打开6000端口。</p><p>端口：389<br>服务：LDAP、ILS<br>说明：轻型目录访问协议和NetMeeting Internet Locator Server共用这一端口。</p><p>端口：443<br>服务：Https<br>说明：网页浏览端口，能提供加密和通过安全端口传输的另一种HTTP。</p><p>端口：456<br>服务：[NULL]<br>说明：木马HACKERS PARADISE开放此端口。</p><p>端口：513<br>服务：Login,remote login<br>说明：是从使用cable modem或DSL登陆到子网中的UNIX计算机发出的广播。这些人为入侵者进入他们的系统提供了信息。</p><p>端口：544<br>服务：[NULL]<br>说明：kerberos kshell</p><p>端口：548<br>服务：Macintosh,File Services(AFP&#x2F;IP)<br>说明：Macintosh,文件服务。</p><p>端口：553<br>服务：CORBA IIOP （UDP）<br>说明：使用cable modem、DSL或VLAN将会看到这个端口的广播。CORBA是一种面向对象的RPC系统。入侵者可以利用这些信息进入系统。</p><p>端口：555<br>服务：DSF<br>说明：木马PhAse1.0、Stealth Spy、IniKiller开放此端口。</p><p>端口：568<br>服务：Membership DPA<br>说明：成员资格 DPA。</p><p>端口：569<br>服务：Membership MSN<br>说明：成员资格 MSN。</p><p>端口：635<br>服务：mountd<br>说明：Linux的mountd Bug。这是扫描的一个流行BUG。大多数对这个端口的扫描是基于UDP的，但是基于TCP的mountd有所增加（mountd同时运行于两个端口）。记住mountd可运行于任何端口（到底是哪个端口，需要在端口111做portmap查询），只是Linux默认端口是635，就像NFS通常运行于2049端口。</p><p>端口：636<br>服务：LDAP<br>说明：SSL（Secure Sockets layer）</p><p>端口：666<br>服务：Doom Id Software<br>说明：木马Attack FTP、Satanz Backdoor开放此端口</p><p>端口：993<br>服务：IMAP<br>说明：SSL（Secure Sockets layer）</p><p>端口：1001、1011<br>服务：[NULL]<br>说明：木马Silencer、WebEx开放1001端口。木马Doly Trojan开放1011端口。</p><p>端口：1024<br>服务：Reserved<br>说明：它是动态端口的开始，许多程序并不在乎用哪个端口连接网络，它们请求系统为它们分配下一个闲置端口。基于这一点分配从端口1024开始。这就是说第一个向系统发出请求的会分配到1024端口。你可以重启机器，打开Telnet，再打开一个窗口运行natstat -a 将会看到Telnet被分配1024端口。还有SQL session也用此端口和5000端口。</p><p>端口：1025、1033<br>服务：1025：network blackjack 1033：[NULL]<br>说明：木马netspy开放这2个端口。</p><p>端口：1080<br>服务：SOCKS<br>说明：这一协议以通道方式穿过防火墙，允许防火墙后面的人通过一个IP地址访问INTERNET。理论上它应该只允许内部的通信向外到达INTERNET。但是由于错误的配置，它会允许位于防火墙外部的攻击穿过防火墙。WinGate常会发生这种错误，在加入IRC聊天室时常会看到这种情况。</p><p>端口：1170<br>服务：[NULL]<br>说明：木马Streaming Audio Trojan、Psyber Stream Server、Voice开放此端口。</p><p>端口：1234、1243、6711、6776<br>服务：[NULL]<br>说明：木马SubSeven2.0、Ultors Trojan开放1234、6776端口。木马SubSeven1.0&#x2F;1.9开放1243、6711、6776端口。</p><p>端口：1245<br>服务：[NULL]<br>说明：木马Vodoo开放此端口。</p><p>端口：1433<br>服务：SQL<br>说明：Microsoft的SQL服务开放的端口。</p><p>端口：1492<br>服务：stone-design-1<br>说明：木马FTP99CMP开放此端口。</p><p>端口：1500<br>服务：RPC client fixed port session queries<br>说明：RPC客户固定端口会话查询</p><p>端口：1503<br>服务：NetMeeting T.120<br>说明：NetMeeting T.120</p><p>端口：1524<br>服务：ingress<br>说明：许多攻击脚本将安装一个后门SHELL于这个端口，尤其是针对SUN系统中Sendmail和RPC服务漏洞的脚本。如果刚安装了防火墙就看到在这个端口上的连接企图，很可能是上述原因。可以试试Telnet到用户的计算机上的这个端口，看看它是否会给你一个SHELL。连接到600&#x2F;pcserver也存在这个问题。</p><p>端口：1600<br>服务：issd<br>说明：木马Shivka-Burka开放此端口。</p><p>端口：1720<br>服务：NetMeeting<br>说明：NetMeeting H.233 call Setup。</p><p>端口：1731<br>服务：NetMeeting Audio Call Control<br>说明：NetMeeting音频调用控制。</p><p>端口：1807<br>服务：[NULL]<br>说明：木马SpySender开放此端口。</p><p>端口：1981<br>服务：[NULL]<br>说明：木马ShockRave开放此端口。</p><p>端口：1999<br>服务：cisco identification port<br>说明：木马BackDoor开放此端口。</p><p>端口：2000<br>服务：[NULL]<br>说明：木马GirlFriend 1.3、Millenium 1.0开放此端口。</p><p>端口：2001<br>服务：[NULL]<br>说明：木马Millenium 1.0、Trojan Cow开放此端口。</p><p>端口：2023<br>服务：xinuexpansion 4<br>说明：木马Pass Ripper开放此端口。</p><p>端口：2049<br>服务：NFS<br>说明：NFS程序常运行于这个端口。通常需要访问Portmapper查询这个服务运行于哪个端口。</p><p>端口：2115<br>服务：[NULL]<br>说明：木马Bugs开放此端口。</p><p>端口：2140、3150<br>服务：[NULL]<br>说明：木马Deep Throat 1.0&#x2F;3.0开放此端口。</p><p>端口：2500<br>服务：RPC client using a fixed port session replication<br>说明：应用固定端口会话复制的RPC客户</p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 基础知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL开启远程连接</title>
      <link href="/2021/06/11/c18403ff18df/"/>
      <url>/2021/06/11/c18403ff18df/</url>
      
        <content type="html"><![CDATA[<h1 id="MySQL开启远程连接"><a href="#MySQL开启远程连接" class="headerlink" title="MySQL开启远程连接"></a>MySQL开启远程连接</h1><p>在Linux上面装完MySQL 或 MariaDB，远程登录报错 Host is not allowed to connect to this MySQL server,是因为没有开启远程登陆。解决方法如下：</p><p>1、在装有MySQL的机器上登录MySQL；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p你的密码</span><br></pre></td></tr></table></figure><p>2、执行下面命令；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br></pre></td></tr></table></figure><p>3、执行下面命令，执行完可能会报错，不用管它。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update user set host = &#x27;%&#x27; where user = &#x27;root&#x27;;</span><br></pre></td></tr></table></figure><p>4、继续执行命令，来刷新MySQL的权限相关表；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><p>经过上面4步，就可以解决这个问题了。</p>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET面试题</title>
      <link href="/2021/06/11/f22b941b630b/"/>
      <url>/2021/06/11/f22b941b630b/</url>
      
        <content type="html"><![CDATA[<h1 id="NET面试题"><a href="#NET面试题" class="headerlink" title=".NET面试题"></a>.NET面试题</h1><blockquote><p>这里总结收集.NET面试题。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210611235021.png" alt="image-20210611235007650"></p><h2 id="CSharp"><a href="#CSharp" class="headerlink" title="CSharp"></a>CSharp</h2><p>暂无</p><h2 id="SQL-Server"><a href="#SQL-Server" class="headerlink" title="SQL Server"></a>SQL Server</h2><p>1、写出一条 SQL 语句：取出文章表（article）中第 31 到第 40 记录（SQL Server，以自动增长的 id 作为主键，注意：id 可能不是连续的。）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM(</span><br><span class="line">    SELECT id, ROW_NUMBER() OVER(ORDER BY id ASC) AS rowid</span><br><span class="line">    FROM article</span><br><span class="line">) T</span><br><span class="line">WHERE T.rowid BETWEEN 31 and 40 </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 面试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
            <tag> .NET </tag>
            
            <tag> 面试题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决网页文字不能复制的方法</title>
      <link href="/2021/05/13/6374d63a8d8d/"/>
      <url>/2021/05/13/6374d63a8d8d/</url>
      
        <content type="html"><![CDATA[<h1 id="网页文字不能复制的方法"><a href="#网页文字不能复制的方法" class="headerlink" title="网页文字不能复制的方法"></a>网页文字不能复制的方法</h1><h2 id="解决网页文字不能复制的方法"><a href="#解决网页文字不能复制的方法" class="headerlink" title="解决网页文字不能复制的方法"></a>解决网页文字不能复制的方法</h2><blockquote><p>网页文字不能复制基本都是通过Javascript脚本来实现的，Chrome、Firefox浏览器都有禁用Javascript功能，所以我们只要禁用当前页面Javascript即可破解网页文字不能复制的问题。</p></blockquote><h3 id="1、禁用javascript"><a href="#1、禁用javascript" class="headerlink" title="1、禁用javascript"></a>1、禁用javascript</h3><p>浏览器按F12再按F1打开Settings界面，钩选”Disable Javascript”即可：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210513234145.png" alt="image-20210513184015431"></p><blockquote><p>上述方法在大部分情况下都适用的，但是，有时用了后页面内容会消失，提示”Please enable Javascript to continue”，此时就需要另一种方法了。</p></blockquote><h3 id="2、书签法"><a href="#2、书签法" class="headerlink" title="2、书签法"></a>2、书签法</h3><p>在浏览器新建书签，名称填写”解除网页限制”，网址填写下边代码:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:(function()&#123;var _0x6d08=[&quot;\x38\x20\x31\x3D\x66\x3B\x38\x20\x30\x3D\x31\x2E\x30\x3B\x30\x2E\x39\x3D\x30\x2E\x67\x3D\x30\x2E\x68\x3D\x30\x2E\x69\x3D\x30\x2E\x6A\x3D\x30\x2E\x6F\x3D\x30\x2E\x39\x3D\x30\x2E\x70\x3D\x31\x2E\x39\x3D\x31\x2E\x67\x3D\x31\x2E\x68\x3D\x31\x2E\x69\x3D\x31\x2E\x6A\x3D\x71\x3B\x72\x28\x73\x20\x33\x20\x74\x20\x66\x2E\x75\x28\x27\x2A\x27\x29\x29\x7B\x35\x28\x33\x2E\x36\x21\x3D\x37\x29\x7B\x38\x20\x32\x3D\x76\x2E\x77\x28\x33\x29\x3B\x35\x28\x37\x21\x3D\x3D\x32\x5B\x22\x6B\x22\x5D\x26\x26\x27\x34\x27\x21\x3D\x32\x5B\x22\x6B\x22\x5D\x29\x7B\x33\x2E\x61\x28\x27\x36\x27\x2C\x27\x62\x2D\x63\x3A\x34\x20\x21\x64\x27\x29\x3B\x65\x7D\x35\x28\x37\x21\x3D\x3D\x32\x5B\x22\x6C\x22\x5D\x26\x26\x27\x34\x27\x21\x3D\x32\x5B\x22\x6C\x22\x5D\x29\x7B\x33\x2E\x61\x28\x27\x36\x27\x2C\x27\x2D\x78\x2D\x62\x2D\x63\x3A\x34\x20\x21\x64\x27\x29\x3B\x65\x7D\x35\x28\x37\x21\x3D\x3D\x32\x5B\x22\x6D\x22\x5D\x26\x26\x27\x34\x27\x21\x3D\x32\x5B\x22\x6D\x22\x5D\x29\x7B\x33\x2E\x61\x28\x27\x36\x27\x2C\x27\x2D\x79\x2D\x62\x2D\x63\x3A\x34\x20\x21\x64\x27\x29\x3B\x65\x7D\x7D\x7D\x7A\x28\x27\u5df2\u89e3\u9664\u6587\u672c\u590d\u5236\u4e0e\u53f3\u952e\u9650\u5236\u3010\u6458\u7e41\u534e\u7248\u6743\u6240\u6709\u3011\x27\x29\x3B&quot;,&quot;\x7C&quot;,&quot;\x73\x70\x6C\x69\x74&quot;,&quot;\x62\x6F\x64\x79\x7C\x64\x6F\x63\x7C\x6F\x62\x6A\x63\x73\x73\x7C\x6E\x6F\x64\x65\x7C\x61\x75\x74\x6F\x7C\x69\x66\x7C\x73\x74\x79\x6C\x65\x7C\x75\x6E\x64\x65\x66\x69\x6E\x65\x64\x7C\x76\x61\x72\x7C\x6F\x6E\x73\x65\x6C\x65\x63\x74\x73\x74\x61\x72\x74\x7C\x73\x65\x74\x41\x74\x74\x72\x69\x62\x75\x74\x65\x7C\x75\x73\x65\x72\x7C\x73\x65\x6C\x65\x63\x74\x7C\x69\x6D\x70\x6F\x72\x74\x61\x6E\x74\x7C\x63\x6F\x6E\x74\x69\x6E\x75\x65\x7C\x64\x6F\x63\x75\x6D\x65\x6E\x74\x7C\x6F\x6E\x63\x6F\x70\x79\x7C\x6F\x6E\x70\x61\x73\x74\x65\x7C\x6F\x6E\x6B\x65\x79\x64\x6F\x77\x6E\x7C\x6F\x6E\x63\x6F\x6E\x74\x65\x78\x74\x6D\x65\x6E\x75\x7C\x75\x73\x65\x72\x53\x65\x6C\x65\x63\x74\x7C\x77\x65\x62\x6B\x69\x74\x55\x73\x65\x72\x53\x65\x6C\x65\x63\x74\x7C\x6D\x6F\x7A\x55\x73\x65\x72\x53\x65\x6C\x65\x63\x74\x7C\x7C\x6F\x6E\x6D\x6F\x75\x73\x65\x6D\x6F\x76\x65\x7C\x6F\x6E\x64\x72\x61\x67\x73\x74\x61\x72\x74\x7C\x6E\x75\x6C\x6C\x7C\x66\x6F\x72\x7C\x6C\x65\x74\x7C\x6F\x66\x7C\x71\x75\x65\x72\x79\x53\x65\x6C\x65\x63\x74\x6F\x72\x41\x6C\x6C\x7C\x77\x69\x6E\x64\x6F\x77\x7C\x67\x65\x74\x43\x6F\x6D\x70\x75\x74\x65\x64\x53\x74\x79\x6C\x65\x7C\x77\x65\x62\x6B\x69\x74\x7C\x6D\x6F\x7A\x7C\x61\x6C\x65\x72\x74\x7C\x6E\x77\x77\x77\x7C\x69\x70\x6C\x61\x79\x53\x6F\x66\x74\x7C\x63\x6F\x6D&quot;,&quot;&quot;,&quot;\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65&quot;,&quot;\x72\x65\x70\x6C\x61\x63\x65&quot;,&quot;\x5C\x77\x2B&quot;,&quot;\x5C\x62&quot;,&quot;\x67&quot;];eval(function(_0x66f0x1,_0x66f0x2,_0x66f0x3,_0x66f0x4,_0x66f0x5,_0x66f0x6)&#123;_0x66f0x5= function(_0x66f0x3)&#123;return (_0x66f0x3&lt; _0x66f0x2?_0x6d08[4]:_0x66f0x5(parseInt(_0x66f0x3/ _0x66f0x2)))+ ((_0x66f0x3= _0x66f0x3% _0x66f0x2)&gt; 35?String[_0x6d08[5]](_0x66f0x3+ 29):_0x66f0x3.toString(36))&#125;;if(!_0x6d08[4][_0x6d08[6]](/^/,String))&#123;while(_0x66f0x3--)&#123;_0x66f0x6[_0x66f0x5(_0x66f0x3)]= _0x66f0x4[_0x66f0x3]|| _0x66f0x5(_0x66f0x3)&#125;;_0x66f0x4= [function(_0x66f0x5)&#123;return _0x66f0x6[_0x66f0x5]&#125;];_0x66f0x5= function()&#123;return _0x6d08[7]&#125;;_0x66f0x3= 1&#125;;while(_0x66f0x3--)&#123;if(_0x66f0x4[_0x66f0x3])&#123;_0x66f0x1= _0x66f0x1[_0x6d08[6]]( new RegExp(_0x6d08[8]+ _0x66f0x5(_0x66f0x3)+ _0x6d08[8],_0x6d08[9]),_0x66f0x4[_0x66f0x3])&#125;&#125;;return _0x66f0x1&#125;(_0x6d08[0],39,39,_0x6d08[3][_0x6d08[2]](_0x6d08[1]),0,&#123;&#125;))&#125;)()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210513234151.png" alt="image-20210513183156944"></p><p>建完如图，在需要破解复制的页面点击下这个书签就可以了。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210513234153.png" alt="image-20210513182914258"></p><p>弹出提示关闭后，就可以随心复制和使用鼠标右键了。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210513234201.png" alt="image-20210513183412214"></p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用ZFile搭建公共在线网盘</title>
      <link href="/2021/05/11/b147934d616b/"/>
      <url>/2021/05/11/b147934d616b/</url>
      
        <content type="html"><![CDATA[<p>注：本文只用于个人使用教程，基本转载原作者文档配图以便后续更换服务器时配置，原文档地址: <a href="http://docs.zhaojun.im/zfile">http://docs.zhaojun.im/zfile</a> 。</p><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><blockquote><p>下载 java 环境。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS系统</span></span><br><span class="line">yum install -y java-1.8.0-openjdk unzip</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612042510.png" alt="image-20210612042503354"></p><h3 id="下载项目"><a href="#下载项目" class="headerlink" title="下载项目"></a>下载项目</h3><blockquote><p>这里我将文件下载到了 &#x2F;home&#x2F;www 下，并在该文件夹下创建了 pan 这个文件夹，并为此文件夹赋予操作权限</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">wget -P /home/www https://c.jun6.net/ZFILE/zfile-release.war</span><br><span class="line"><span class="built_in">cd</span> /home/www</span><br><span class="line"><span class="built_in">mkdir</span> pan &amp;&amp; unzip zfile-release.war -d pan &amp;&amp; <span class="built_in">rm</span> -rf zfile-release.war</span><br><span class="line"><span class="built_in">chmod</span> +x /home/www/pan/bin/*.sh</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612042624.png" alt="image-20210612042621776"></p><p>……</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612042708.png" alt="image-20210612042706352"></p><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/home/www/pan/bin/start.sh       <span class="comment"># 启动项目</span></span><br><span class="line">/home/www/pan/bin/stop.sh        <span class="comment"># 停止项目</span></span><br><span class="line">/home/www/pan/bin/restart.sh     <span class="comment"># 重启项目</span></span><br></pre></td></tr></table></figure><h3 id="更改端口"><a href="#更改端口" class="headerlink" title="更改端口"></a>更改端口</h3><blockquote><p>由于 zfile 的默认端口是8080端口，这里我的这个端口已占用，所以需要改一下。如果你的站点少或该端口没有被占用，可以忽略这一步，不用更改。</p></blockquote><p>1、用 xftp 打开 &#x2F;home&#x2F;www&#x2F;pan&#x2F;WEB-INF&#x2F;classes 文件夹。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612043406.png" alt="image-20210612043404047"></p><p>2、用任何编辑器打开 application.yml 文件，找到 server ，更改为你需要的端口。</p><blockquote><p>为什么呢？因为端口范围一般用到的是1到65535，其中0不使用。端口号可分为3大类：</p><p>1、公认端口（Well Known Ports）：从0到1023，它们紧密绑定（binding）于一些服务。通常这些端口的通讯明确表明了某种服务的协议。例如：80端口实际上总是HTTP通讯。</p><p>2、注册端口（Registered Ports）：从1024到49151。它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用于许多其它目的。例如：许多系统处理动态端口从1024左右开始。</p><p>3、动态和&#x2F;或私有端口（Dynamic and&#x2F;or Private Ports）：从49152到65535。理论上，不应为服务分配这些端口。实际上，机器通常从1024起分配动态端口。但也有例外：SUN的RPC端口从32768开始。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612044334.png" alt="image-20210612044332360"></p><p>为安全起见，这里我用 55555 。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612065127.png" alt="image-20210612053637243"></p><h3 id="修改-nginx-conf-文件"><a href="#修改-nginx-conf-文件" class="headerlink" title="修改 nginx.conf 文件"></a>修改 nginx.conf 文件</h3><p>由于我用的域名是 https 访问，所以需要代理到 55555 端口，如果不用域名，这一步省略。如我的配置如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#-------------摘繁华公共网盘------------------</span><br><span class="line">server &#123;</span><br><span class="line">    listen443 ssl;</span><br><span class="line">    server_namepan.zhaifanhua.com;</span><br><span class="line">    ssl_certificate/home/ssl/zhaifanhua.com/full_chain.pem;</span><br><span class="line">    ssl_certificate_key/home/ssl/zhaifanhua.com/private.key;</span><br><span class="line">    add_header Strict-Transport-Security &quot;max-age=63072000&quot; always;</span><br><span class="line">    ssl_stapling            on;</span><br><span class="line">    ssl_stapling_verify     on;</span><br><span class="line">    ssl_session_cacheshared:SSL:1m;</span><br><span class="line">    ssl_session_timeout5m;</span><br><span class="line">    ssl_protocolsTLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_ciphersECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">    proxy_pass          http://127.0.0.1:55555;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改完重启 nginx 即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure><h3 id="配置完成"><a href="#配置完成" class="headerlink" title="配置完成"></a>配置完成</h3><p>这时我们直接访问域名，即可进入安装页面。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612055127.png" alt="image-20210612055124775"></p><p>安装完成配置好驱动器就可以访问了。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612062128.png" alt="image-20210612062125708"></p><h2 id="前后端分离部署"><a href="#前后端分离部署" class="headerlink" title="前后端分离部署"></a>前后端分离部署</h2><p>下载 <code>https://github.com/zhaojun1998/zfile/tree/master/src/main/resources/static</code> 路径下的所有文件, 或在程序运行后的相对路径：<code>WEB-INF/classes/static</code>.</p><p>修改 <code>zfile.config.json</code> 内文件指向后端地址, 然后放到静态资源服务器, 或对象存储即可:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://xx.xxx.cn:8080&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210612062434.png" alt="image-20210612062432546"></p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网盘 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在CentOS上安装Nginx配置HTTPS并设置系统服务和开机启动（最全教程）</title>
      <link href="/2021/03/15/84da83f19eca/"/>
      <url>/2021/03/15/84da83f19eca/</url>
      
        <content type="html"><![CDATA[<blockquote><p>友情提示：全部配完大约需要20分钟，系统为腾讯云CentOS7.5，本教程配合 xshell 和 xftp 使用更佳。本教程 摘繁华 版权所有。</p></blockquote><h3 id="操作按键"><a href="#操作按键" class="headerlink" title="操作按键"></a>操作按键</h3><div class="tabs" id="操作按键"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="操作按键-1">常用按键</button><button type="button" class="tab " data-href="操作按键-2">编辑器vim按键</button></ul><div class="tab-contents"><div class="tab-item-content active" id="操作按键-1"><p>复制操作：<kbd>Shift</kbd>+<kbd>Ins</kbd> </p></div><div class="tab-item-content" id="操作按键-2"><p>开启编辑： <kbd> i </kbd> 或者 <kbd> Insert </kbd> </p><p>退出编辑： <kbd> Esc </kbd> </p><p>退出vim： <kbd>:</kbd> + <kbd>q </kbd> </p><p>保存vim： <kbd>:</kbd> + <kbd>w</kbd> </p><p>保存退出vim： <kbd>: </kbd> + <kbd>w </kbd> + <kbd>q </kbd> </p><p>不保存退出vim： <kbd>: </kbd> + <kbd>q</kbd> + <kbd>! </kbd> </p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="第一步：安装所需要的依赖"><a href="#第一步：安装所需要的依赖" class="headerlink" title="第一步：安装所需要的依赖"></a>第一步：安装所需要的依赖</h2><h4 id="1、所需要的依赖包括：gcc，pcre，zlib，openssl。"><a href="#1、所需要的依赖包括：gcc，pcre，zlib，openssl。" class="headerlink" title="1、所需要的依赖包括：gcc，pcre，zlib，openssl。"></a>1、所需要的依赖包括：gcc，pcre，zlib，openssl。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel</span><br></pre></td></tr></table></figure><div class="tabs" id="依赖"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="依赖-1">GCC库</button><button type="button" class="tab " data-href="依赖-2">PCRE库</button><button type="button" class="tab " data-href="依赖-3">ZLIB库</button><button type="button" class="tab " data-href="依赖-4">OpenSSL库</button></ul><div class="tab-contents"><div class="tab-item-content active" id="依赖-1"><p><strong>GCC库</strong>（用来编译下载下来的 nginx 源码）</p><p>GCC  是 Linux 下最主要的编译工具，GCC 不仅功能非常强大，结构也非常灵活。它可以通过不同的前端模块来支持各种语言，如 Java、Fortran、Pascal、Modula-3 和 Ada。</p></div><div class="tab-item-content" id="依赖-2"><p><strong>PCRE库</strong>（ rewrite 模块需要 pcre 库）</p><p>PCRE 支持正则表达式。如果我们在配置文件 nginx.conf 中使用了正则表达式，那么在编译 Nginx 时就必须把PCRE库编译进 Nginx，因为 Nginx 的 HTTP 模块需要靠它来解析正则表达式。另外，pcre-devel 是使用PCRE做二次开发时所需要的开发库，包括头文件等，这也是编译 Nginx 所必须使用的。</p></div><div class="tab-item-content" id="依赖-3"><p><strong>ZLIB库</strong>（ gzip 模块需要 zlib 库）<br>zlib 提供了很多压缩和解方式，用于对 HTTP 包的内容做 gzip 格式的压缩，如果我们在 nginx.conf 中配置了 gzip on，并指定对于某些类型（content-type）的HTTP响应使用 gzip 来进行压缩以减少网络传输量，则在编译时就必须把 zlib 编译进 Nginx。zlib-devel 是二次开发所需要的库。</p></div><div class="tab-item-content" id="依赖-4"><p><strong>OpenSSL库</strong>（SSL功能需要 openssl 库）<br>openssl 是一个安全套接字层密码库，如果服务器不只是要支持 HTTP，还需要在更安全的 SSL 协议上传输 HTTP，那么需要拥有 OpenSSL。另外，如果我们想使用 MD5、SHA1 等散列函数，那么也需要安装它。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>显示以下结果表示安装完成。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034336.png" alt="image-20210312142614045"></p><h2 id="第二步：升级-openssl-非必需"><a href="#第二步：升级-openssl-非必需" class="headerlink" title="第二步：升级 openssl 非必需"></a>第二步：升级 openssl 非必需</h2><blockquote><p>这个不是必需！不想升级可直接跳第三步，怕麻烦最好不升级，不升级也可以用，因为升级我踩过好多坑。</p></blockquote><p>yum安装的 openssl ，版本比较低，我们可以通过以下命令查看 openssl 的版本。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl version -a</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034355.png" alt="image-20210313215300685"></p><blockquote><p>openssl 的版本是 1.0.2k，这个是2017年发布的，已经有点老了，我们下载最新版本。</p></blockquote><h4 id="1、进入-openssl官网-查看版本，这里我下载的是-openssl-1-1-1j-tar-gz-。"><a href="#1、进入-openssl官网-查看版本，这里我下载的是-openssl-1-1-1j-tar-gz-。" class="headerlink" title="1、进入 openssl官网 查看版本，这里我下载的是 openssl-1.1.1j.tar.gz  。"></a>1、进入 <a href="http://www.openssl.org/source/">openssl官网</a> 查看版本，这里我下载的是 <a href="https://www.openssl.org/source/openssl-1.1.1j.tar.gz">openssl-1.1.1j.tar.gz</a>  。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">wget https://www.openssl.org/source/openssl-1.1.1j.tar.gz</span><br></pre></td></tr></table></figure><h4 id="2、解压-openssl-1-1-1j-tar-gz-并进入解压目录。"><a href="#2、解压-openssl-1-1-1j-tar-gz-并进入解压目录。" class="headerlink" title="2、解压 openssl-1.1.1j.tar.gz 并进入解压目录。"></a>2、解压 openssl-1.1.1j.tar.gz 并进入解压目录。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf openssl-1.1.1j.tar.gz</span><br><span class="line">cd openssl-1.1.1j</span><br></pre></td></tr></table></figure><h4 id="3、进行重新编译-openssl-。"><a href="#3、进行重新编译-openssl-。" class="headerlink" title="3、进行重新编译 openssl 。"></a>3、进行重新编译 openssl 。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./config shared zlib</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><blockquote><p>此过程需要 3 分钟左右……</p></blockquote><p>编译完成后以下图：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034420.png" alt="image-20210314003448904"></p><h4 id="4、备份当前openssl。"><a href="#4、备份当前openssl。" class="headerlink" title="4、备份当前openssl。"></a>4、备份当前openssl。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv /usr/bin/openssl /usr/bin/openssl.bak</span><br><span class="line">mv /usr/include/openssl /usr/include/openssl.bak</span><br></pre></td></tr></table></figure><h4 id="5、配置使用新版本："><a href="#5、配置使用新版本：" class="headerlink" title="5、配置使用新版本："></a>5、配置使用新版本：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/bin/openssl /usr/bin/openssl</span><br><span class="line">ln -s /usr/local/include/openssl /usr/include/openssl</span><br></pre></td></tr></table></figure><h4 id="6、更新动态链接库数据："><a href="#6、更新动态链接库数据：" class="headerlink" title="6、更新动态链接库数据："></a>6、更新动态链接库数据：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;/usr/local/lib64/&quot; &gt;&gt; /etc/ld.so.conf</span><br></pre></td></tr></table></figure><p>重新加载动态链接库。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldconfig -v</span><br></pre></td></tr></table></figure><h4 id="7、重新查看版本号进行验证："><a href="#7、重新查看版本号进行验证：" class="headerlink" title="7、重新查看版本号进行验证："></a>7、重新查看版本号进行验证：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl version -a</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034449.png" alt="image-20210314013041087"></p><h4 id="8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。"><a href="#8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。" class="headerlink" title="8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。"></a>8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd auto/lib/openssl</span><br><span class="line">cp conf /mnt/</span><br><span class="line">vim conf</span><br></pre></td></tr></table></figure><p>将</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CORE_INCS=&quot;$CORE_INCS $OPENSSL/.openssl/include&quot;</span><br><span class="line">CORE_DEPS=&quot;$CORE_DEPS $OPENSSL/.openssl/include/openssl/ssl.h&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/.openssl/lib/libssl.a&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/.openssl/lib/libcrypto.a&quot;</span><br></pre></td></tr></table></figure><p>修改为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CORE_INCS=&quot;$CORE_INCS $OPENSSL/include&quot;</span><br><span class="line">CORE_DEPS=&quot;$CORE_DEPS $OPENSSL/include/openssl/ssl.h&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/lib/libssl.a&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/lib/libcrypto.a&quot;</span><br></pre></td></tr></table></figure><h4 id="9、建立libssl-a和libcrypto-a的软连接。"><a href="#9、建立libssl-a和libcrypto-a的软连接。" class="headerlink" title="9、建立libssl.a和libcrypto.a的软连接。"></a>9、建立libssl.a和libcrypto.a的软连接。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/ssl/lib</span><br><span class="line">ln -s /usr/local/lib64/libssl.a /usr/local/ssl/lib/libssl.a</span><br><span class="line">ln -s /usr/local/lib64/libcrypto.a /usr/local/ssl/lib/libcrypto.a</span><br></pre></td></tr></table></figure><h4 id="10、建立软连接openssl后，-usr-local-ssl-下没有include路径，需重新指向。"><a href="#10、建立软连接openssl后，-usr-local-ssl-下没有include路径，需重新指向。" class="headerlink" title="10、建立软连接openssl后，&#x2F;usr&#x2F;local&#x2F;ssl&#x2F;下没有include路径，需重新指向。"></a>10、建立软连接openssl后，&#x2F;usr&#x2F;local&#x2F;ssl&#x2F;下没有include路径，需重新指向。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/include/ /usr/local/ssl/include</span><br><span class="line">ll</span><br></pre></td></tr></table></figure><h2 id="第三步：正式安装Nginx"><a href="#第三步：正式安装Nginx" class="headerlink" title="第三步：正式安装Nginx"></a>第三步：正式安装Nginx</h2><h4 id="1、先进入到-usr-local-目录，创建并进入-nginx-目录。"><a href="#1、先进入到-usr-local-目录，创建并进入-nginx-目录。" class="headerlink" title="1、先进入到 usr&#x2F;local 目录，创建并进入 nginx 目录。"></a>1、先进入到 usr&#x2F;local 目录，创建并进入 nginx 目录。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">mkdir nginx</span><br><span class="line">cd nginx</span><br></pre></td></tr></table></figure><h4 id="2、通过-wget-命令在线获取到-nginx-的安装包，这里我选择的是-nginx-1-17-7-这个版本，命令是："><a href="#2、通过-wget-命令在线获取到-nginx-的安装包，这里我选择的是-nginx-1-17-7-这个版本，命令是：" class="headerlink" title="2、通过 wget 命令在线获取到 nginx 的安装包，这里我选择的是 nginx-1.17.7 这个版本，命令是："></a>2、通过 wget 命令在线获取到 nginx 的安装包，这里我选择的是 nginx-1.17.7 这个版本，命令是：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://nginx.org/download/nginx-1.17.7.tar.gz</span><br></pre></td></tr></table></figure><blockquote><p>最新版本可以直接点直通车查看：<a href="https://nginx.org/download">nginx下载地址</a></p></blockquote><h4 id="3、解压-nginx-1-17-7-tar-gz。"><a href="#3、解压-nginx-1-17-7-tar-gz。" class="headerlink" title="3、解压 nginx-1.17.7.tar.gz。"></a>3、解压 nginx-1.17.7.tar.gz。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf nginx-1.17.7.tar.gz</span><br></pre></td></tr></table></figure><h4 id="4、进入刚刚解压的文件夹nginx-1-17-7进行安装。"><a href="#4、进入刚刚解压的文件夹nginx-1-17-7进行安装。" class="headerlink" title="4、进入刚刚解压的文件夹nginx-1.17.7进行安装。"></a>4、进入刚刚解压的文件夹nginx-1.17.7进行安装。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd nginx-1.17.7</span><br></pre></td></tr></table></figure><h4 id="5、使用–prefix参数指定nginx安装的目录。"><a href="#5、使用–prefix参数指定nginx安装的目录。" class="headerlink" title="5、使用–prefix参数指定nginx安装的目录。"></a>5、使用–prefix参数指定nginx安装的目录。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module</span><br></pre></td></tr></table></figure><h4 id="6、用make或make-install安装，安装命令。"><a href="#6、用make或make-install安装，安装命令。" class="headerlink" title="6、用make或make install安装，安装命令。"></a>6、用make或make install安装，安装命令。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make</span><br><span class="line"># 或 make install</span><br></pre></td></tr></table></figure><p>显示以下结果表示安装完成。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034517.png" alt="image-20210314050029293"></p><h4 id="7、查看nginx版本。"><a href="#7、查看nginx版本。" class="headerlink" title="7、查看nginx版本。"></a>7、查看nginx版本。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -V</span><br></pre></td></tr></table></figure><p>看到版本号为 1.17.7，各个模块也安装正常。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034540.png" alt="image-20210314050114769"></p><p>执行完成后看看Nginx安在什么地方了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whereis nginx</span><br></pre></td></tr></table></figure><p>可以看到，我的nginx是安装在了 &#x2F;usr&#x2F;local&#x2F;nginx。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034555.png" alt="image-20210314050157365"></p><h4 id="8、运行命令启动nginx。"><a href="#8、运行命令启动nginx。" class="headerlink" title="8、运行命令启动nginx。"></a>8、运行命令启动nginx。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure><h4 id="9、用ps命令看看nginx进程跑起来没有。"><a href="#9、用ps命令看看nginx进程跑起来没有。" class="headerlink" title="9、用ps命令看看nginx进程跑起来没有。"></a>9、用ps命令看看nginx进程跑起来没有。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep nginx</span><br></pre></td></tr></table></figure><p>跑起来了，说明安装没有问题。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034612.png" alt="image-20210314050237838"></p><h2 id="第四步：验证是否成功安装"><a href="#第四步：验证是否成功安装" class="headerlink" title="第四步：验证是否成功安装"></a>第四步：验证是否成功安装</h2><h4 id="1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。"><a href="#1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。" class="headerlink" title="1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。"></a>1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。</h4><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034636.png" alt="image-20210312152634185"></p><p>到此，Nginx成功完成安装！接下来就是配置nginx让别人能访问到你的网站。</p><h2 id="第五步：配置nginx"><a href="#第五步：配置nginx" class="headerlink" title="第五步：配置nginx"></a>第五步：配置nginx</h2><h4 id="1、打开文件夹-usr-local-nginx-conf-，查看目录结构。"><a href="#1、打开文件夹-usr-local-nginx-conf-，查看目录结构。" class="headerlink" title="1、打开文件夹 &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf ，查看目录结构。"></a>1、打开文件夹 &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf ，查看目录结构。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/conf</span><br><span class="line">ll</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034657.png" alt="image-20210312160909002"></p><p>可以看到里面有nginx.conf这个文件，使用命令 vim 打开时是这样的</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034711.png" alt="image-20210312161955404"></p><p><code>后面要用到的链接</code><span id="shuoming">说明文件</span></p><p>这里有必要对nginx.conf说明一下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1; # 工作进程：数目。根据硬件调整，通常等于cpu数量或者2倍cpu数量。</span><br><span class="line"></span><br><span class="line">#错误日志存放路径。</span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs/nginx.pid; # nginx进程pid存放路径。</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024; # 工作进程的最大连接数量。</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types; # 指定mime类型，由mime.type来定义。</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    # 日志格式设置</span><br><span class="line">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    # 用log_format指令设置日志格式后，需要用access_log来指定日志文件存放路径。</span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    # 指定nginx是否调用sendfile函数来输出文件，对于普通应用，必须设置on。如果用来进行下载等应用磁盘io重负载应用，可设着off，以平衡磁盘与网络io处理速度，降低系统uptime。</span><br><span class="line">    sendfile        on;</span><br><span class="line">    # 此选项允许或禁止使用socket的TCP_CORK的选项，此选项仅在sendfile的时候使用。</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">    </span><br><span class="line">    # keepalive超时时间。</span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    # 开启gzip压缩服务。</span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    # 虚拟主机。</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;  # 配置监听端口号。</span><br><span class="line">        server_name  localhost;  # 配置访问域名，域名可以有多个，用空格隔开。</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;  # 字符集设置。</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # 错误跳转页。</span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        # 请求的url过滤，正则匹配，~为区分大小写，~*为不区分大小写。</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        </span><br><span class="line">        #    root           html; # 根目录。</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000; # 请求转向定义的服务器列表。</span><br><span class="line">        #    fastcgi_index  index.php; # 如果请求的Fastcgi_index URI是以 / 结束的, 该指令设置的文件会被附加到URI的后面并保存在变量$fastcig_script_name中。</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">        # concurs with nginx&#x27;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ /\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl; # 监听端口。</span><br><span class="line">    #    server_name  localhost; # 域名。</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem; # 证书位置。</span><br><span class="line">    #    ssl_certificate_key  cert.key; # 私钥位置。</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5; # 密码加密方式。</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2、在这里建议将现有的nginx-conf文件复制一份出来并重命名为nginx-conf-bak文件，方便以后配置错了恢复。"><a href="#2、在这里建议将现有的nginx-conf文件复制一份出来并重命名为nginx-conf-bak文件，方便以后配置错了恢复。" class="headerlink" title="2、在这里建议将现有的nginx.conf文件复制一份出来并重命名为nginx.conf.bak文件，方便以后配置错了恢复。"></a>2、在这里建议将现有的nginx.conf文件复制一份出来并重命名为nginx.conf.bak文件，方便以后配置错了恢复。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -b /usr/local/nginx/conf/nginx.conf /usr/local/nginx/conf/nginx.conf.bak</span><br></pre></td></tr></table></figure><h4 id="3、然后打开-usr-local-nginx-conf-看看目录结构，发现已经复制好了"><a href="#3、然后打开-usr-local-nginx-conf-看看目录结构，发现已经复制好了" class="headerlink" title="3、然后打开 &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf 看看目录结构，发现已经复制好了"></a>3、然后打开 &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf 看看目录结构，发现已经复制好了</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/conf</span><br><span class="line">ll</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034734.png" alt="image-20210314050447427"></p><p>这时后就可以安心修改nginx.conf文件了！注：上面的说明文件和conf源文件一模一样，我只是加了注释，放心复制。</p><h4 id="4、直接在本地创建一个空-nginx-conf-文件，复制上面-说明文件的代码，按照我的注释配置你的网站："><a href="#4、直接在本地创建一个空-nginx-conf-文件，复制上面-说明文件的代码，按照我的注释配置你的网站：" class="headerlink" title="4、直接在本地创建一个空 nginx.conf 文件，复制上面 说明文件的代码，按照我的注释配置你的网站："></a>4、直接在本地创建一个空 nginx.conf 文件，复制上面 <a href="#shuoming">说明文件</a>的代码，按照我的注释配置你的网站：</h4><blockquote><p>一般情况下只需要在最后一个}之前添加server配置就可以了</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034755.png" alt="image-20210313170838307"></p><p>比如我的个人主页网站配置如下：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034807.png" alt="image-20210315063102695"></p><p>下面说说我为什么这么配置（如果你的网站不需要https访问，这一步可以忽略）。</p><blockquote><p>现在网站 https 已经是标配，这个配置还是很重要的。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># -------------------http-----------------------</span><br><span class="line">    # -------------配置跳转https-------------</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name *.zhaifanhua.cn;</span><br><span class="line">        return 301 https://$http_host$request_uri;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>上面的配置是为了 http 跳转为 https ，当访问 80 端口时 nginx 自动转发为已经存在配置网址的 443 端口。比如别人访问网站 <a href="http://zhaifanhua.cn/">http://zhaifanhua.cn</a> 会自动跳转为 <a href="https://zhaifanhua.cn/">https://zhaifanhua.cn</a> 。</p><p>这里我设置为 *.zhaifanhua.cn 是因为我有很多站点都需要跳转为 https 协议访问，并且我的证书是泛域名解析，干脆用通配符 * 来配置一劳永逸。这样访问任何前缀的域名都可以跳转为 https 协议了。</p></blockquote><p>下面就是正式配置网站目录和证书了，一下内容将参数 server_name、ssl_certificate、ssl_certificate_key、location 下的 root 修改你自己的域名和路径即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># -------------------https-----------------------</span><br><span class="line">    # -------------摘繁华主页------------------</span><br><span class="line">    server &#123;</span><br><span class="line">        listen443 ssl;</span><br><span class="line">        server_namezhaifanhua.cn www.zhaifanhua.cn;</span><br><span class="line">        # 证书位置</span><br><span class="line">        ssl_certificate/home/ssl/zhaifanhua.cn/full_chain.pem;</span><br><span class="line">        # 私钥位置</span><br><span class="line">        ssl_certificate_key/home/ssl/zhaifanhua.cn/private.key;</span><br><span class="line">        # 开启HSTS</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=63072000&quot; always;</span><br><span class="line">        # 装订在线证书状态协议</span><br><span class="line">        ssl_stapling            on;</span><br><span class="line">        ssl_stapling_verify     on;</span><br><span class="line">        # 配置会话缓存</span><br><span class="line">        ssl_session_cacheshared:SSL:1m;</span><br><span class="line">        ssl_session_timeout5m;</span><br><span class="line">        # 配置协议</span><br><span class="line">        ssl_protocolsTLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        # 配置加密套件</span><br><span class="line">        ssl_ciphersECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class="line"></span><br><span class="line">        # 根目录</span><br><span class="line">        root                    /home/www/www;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="5、修改完成后保存，然后用xftp上传到-usr-local-nginx-conf-目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。"><a href="#5、修改完成后保存，然后用xftp上传到-usr-local-nginx-conf-目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。" class="headerlink" title="5、修改完成后保存，然后用xftp上传到 &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf 目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。"></a>5、修改完成后保存，然后用xftp上传到 &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf 目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -t</span><br></pre></td></tr></table></figure><h4 id="6、配置正确后，重启-nginx-重新加载配置文件使配置生效："><a href="#6、配置正确后，重启-nginx-重新加载配置文件使配置生效：" class="headerlink" title="6、配置正确后，重启 nginx 重新加载配置文件使配置生效："></a>6、配置正确后，重启 nginx 重新加载配置文件使配置生效：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure><h4 id="7、这时候访问网站已经出现了锁，说明-https-开启成功。"><a href="#7、这时候访问网站已经出现了锁，说明-https-开启成功。" class="headerlink" title="7、这时候访问网站已经出现了锁，说明 https 开启成功。"></a>7、这时候访问网站已经出现了锁，说明 https 开启成功。</h4><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034829.png" alt="image-20210315005057299"></p><h2 id="第六步：配置为系统服务"><a href="#第六步：配置为系统服务" class="headerlink" title="第六步：配置为系统服务"></a>第六步：配置为系统服务</h2><h4 id="1、在系统服务目录里创建-nginx-service-文件。"><a href="#1、在系统服务目录里创建-nginx-service-文件。" class="headerlink" title="1、在系统服务目录里创建 nginx.service 文件。"></a>1、在系统服务目录里创建 nginx.service 文件。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /lib/systemd/system/nginx.service</span><br></pre></td></tr></table></figure><p>写入内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx</span><br><span class="line">After=network.target</span><br><span class="line">  </span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx</span><br><span class="line">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/local/nginx/sbin/nginx -s quit</span><br><span class="line">PrivateTmp=true</span><br><span class="line">  </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><blockquote><p>[Unit] 服务的说明<br>Description 描述服务<br>After 描述服务类别<br>[Service] 服务运行参数的设置<br>Type&#x3D;forking 是后台运行的形式<br>ExecStart 为服务的具体运行命令<br>ExecReload 为重启命令<br>ExecStop 为停止命令<br>PrivateTmp&#x3D;True 表示给服务分配独立的临时空间<br>[Install] 运行级别下服务安装的相关设置，可设置为多用户，即系统运行级别为3</p></blockquote><p>注意：[Service]的启动、重启、停止命令全部要求使用绝对路径，保存退出。</p><h4 id="2、设置用户的权限，重新加载-nginx-service-文件"><a href="#2、设置用户的权限，重新加载-nginx-service-文件" class="headerlink" title="2、设置用户的权限，重新加载 nginx.service 文件"></a>2、设置用户的权限，重新加载 nginx.service 文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 755 ./nginx.service</span><br><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure><h4 id="3、杀死-nginx-重启nginx"><a href="#3、杀死-nginx-重启nginx" class="headerlink" title="3、杀死 nginx 重启nginx"></a>3、杀死 nginx 重启nginx</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pkill -9 nginx</span><br><span class="line">systemctl restart nginx</span><br><span class="line">ps aux | grep nginx</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034852.png" alt="image-20210315025038577"></p><p>说明配置系统服务成功！</p><h4 id="4、设置开机自启动"><a href="#4、设置开机自启动" class="headerlink" title="4、设置开机自启动"></a>4、设置开机自启动</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable nginx.service</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034904.png" alt="image-20210315025338229"></p><p>说明开机自启动设置成功！</p><h3 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 启动nginx服务</span><br><span class="line">service nginx start</span><br><span class="line">systemctl start nginx</span><br><span class="line"># 查看nginx状态</span><br><span class="line">service nginx status</span><br><span class="line">systemctl status nginx</span><br><span class="line"># 重启nginx服务</span><br><span class="line">service nginx reload</span><br><span class="line">systemctl restart nginx</span><br><span class="line"># 停止nginx服务</span><br><span class="line">service nginx stop</span><br><span class="line">systemctl stop nginx</span><br><span class="line"></span><br><span class="line"># 设置开机自启动</span><br><span class="line">systemctl enable nginx.service</span><br><span class="line"># 停止开机自启动</span><br><span class="line">systemctl disable nginx.service</span><br><span class="line"></span><br><span class="line"># 查看所有已启动的服务</span><br><span class="line">systemctl list-units --type=service</span><br></pre></td></tr></table></figure><h2 id="致谢及彩蛋"><a href="#致谢及彩蛋" class="headerlink" title="致谢及彩蛋"></a>致谢及彩蛋</h2><ul><li>这篇文章写了整整两天，希望能为你带来帮助。由于知识水平有限，本文难免有不足之处，诚请各位同行提出批评和指正。</li><li>配置功能可能需要没多长时间，但为了能让读者尽可能一次配置成功，查了无数的资料，也实验了好几遍……还是蛮累的，不要忘了一件三连哦！</li></ul><p>彩蛋 ：写这篇文章之前，我的域名开了CDN加速，原本我的nginx是配置好的，我更新了我的网站程序后，怎么刷新内容都不变，我还以为我的nginx出错了，而且考虑到我的服务器好长时间没有清理了，直接TMD把服务器重装了，结果忘了备份一个重要的数据库，导致所有资料都没了，你能想到我当时的心情了吧！！！！不过要是没有重装，我也不会写这篇文章了，哈哈哈哈……欲知后文，请关注我或者任何搜索引擎搜索“摘繁华”就能找到我，嘻嘻。</p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐​​ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> CentOS </tag>
            
            <tag> Linux </tag>
            
            <tag> Nginx </tag>
            
            <tag> HTTPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python(Jupyter)实现餐饮企业订单数据分析</title>
      <link href="/2020/11/17/88bfc4a0bb76/"/>
      <url>/2020/11/17/88bfc4a0bb76/</url>
      
        <content type="html"><![CDATA[<h3 id="1-导入所需要的包"><a href="#1-导入所需要的包" class="headerlink" title="1.导入所需要的包"></a>1.导入所需要的包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> NaN</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> DataFrame,Series</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> wordcloud <span class="keyword">import</span> WordCloud</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">#正常显示中文标签</span></span><br><span class="line"><span class="comment"># 绘图魔术命令</span></span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure><h3 id="2-定义后面用到的函数"><a href="#2-定义后面用到的函数" class="headerlink" title="2.定义后面用到的函数"></a>2.定义后面用到的函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数组中元素大写转小写(返回list)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">arrayToLower</span>(<span class="params">array:<span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [a.lower() <span class="keyword">for</span> a <span class="keyword">in</span> array <span class="keyword">if</span> <span class="built_in">isinstance</span>(a,<span class="built_in">str</span>)==<span class="literal">True</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据源(返回DataFrame)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dataOpen</span>(<span class="params">filepath:<span class="built_in">str</span>,sheetindex:<span class="built_in">int</span>,isData:<span class="built_in">bool</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">         <span class="comment"># 截取路径字符串</span></span><br><span class="line">        filetype=filepath.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 判断文件类型</span></span><br><span class="line">        rdata:DataFrame</span><br><span class="line">        <span class="keyword">if</span> filetype==<span class="string">&#x27;csv&#x27;</span>:</span><br><span class="line">            data=pd.read_csv(<span class="built_in">open</span>(filepath))<span class="comment"># 读取数据源</span></span><br><span class="line">            rdata=pd.DataFrame.copy(data)<span class="comment"># 复制数据源</span></span><br><span class="line">        <span class="keyword">if</span> filetype==<span class="string">&#x27;xlsx&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> sheetindex&lt;<span class="number">0</span>:</span><br><span class="line">                data=pd.read_excel(filepath,<span class="number">0</span>)</span><br><span class="line">                rdata=pd.DataFrame.copy(data)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data=pd.read_excel(filepath,sheetindex)</span><br><span class="line">                rdata=pd.DataFrame.copy(data)</span><br><span class="line">        <span class="comment"># 判断是否数据文件</span></span><br><span class="line">        <span class="keyword">if</span> isData:</span><br><span class="line">            <span class="comment"># 重命名</span></span><br><span class="line">            rdata.columns=arrayToLower(rdata.columns)<span class="comment"># 列转小写</span></span><br><span class="line">            <span class="comment"># 转换中文列名称</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(all_tz)):</span><br><span class="line">                <span class="keyword">if</span> rdata.columns.values.tolist()==all_tz[i]:</span><br><span class="line">                    rdata.columns=all_sm[i]</span><br><span class="line">            <span class="comment">#数据源处理</span></span><br><span class="line">            rdata=rdata.dropna(axis=<span class="number">1</span>,how=<span class="string">&#x27;all&#x27;</span>,thresh=<span class="number">1</span>,inplace=<span class="literal">False</span>)<span class="comment"># 删除无意义的空列</span></span><br><span class="line">        <span class="keyword">return</span> rdata</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="built_in">print</span>(ex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建文件夹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mkDirectory</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="comment"># 去除首位空格</span></span><br><span class="line">    path=path.strip()</span><br><span class="line">    <span class="comment"># 去除尾部 \ 符号</span></span><br><span class="line">    path=path.rstrip(<span class="string">r&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="comment"># 判断路径是否存在</span></span><br><span class="line">    isExists=os.path.exists(path) <span class="comment"># 存在True，不存在False</span></span><br><span class="line">    <span class="comment"># 判断结果</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isExists:<span class="comment"># 如果不存在则创建文件夹</span></span><br><span class="line">        os.makedirs(path)</span><br><span class="line">        <span class="built_in">print</span>(path+<span class="string">&#x27;  文件夹创建成功&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:<span class="comment"># 如果目录存在则不创建，并提示目录已存在</span></span><br><span class="line">        <span class="built_in">print</span>(path+<span class="string">&#x27;  文件夹已存在&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义函数来显示柱状上的数值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">autoBarLabel</span>(<span class="params">rects</span>):</span><br><span class="line">    <span class="keyword">for</span> rect <span class="keyword">in</span> rects:</span><br><span class="line">        height = rect.get_height()</span><br><span class="line">        plt.text(rect.get_x(),height+<span class="number">.1</span>,height,fontsize=<span class="number">30</span>)</span><br></pre></td></tr></table></figure><h3 id="3-数据源地址"><a href="#3-数据源地址" class="headerlink" title="3.数据源地址"></a>3.数据源地址</h3><p><a href="https://zhaifanhua.lanzous.com/iMnXHkpryof">源数据下载</a> ，下载完解压在D盘即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取数据源或数据源地址</span></span><br><span class="line">file_users=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/users.xlsx&#x27;</span></span><br><span class="line">file_meal_order_info=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/meal_order_info.csv&#x27;</span></span><br><span class="line">file_meal_order_detail=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/meal_order_detail.xlsx&#x27;</span>s</span><br><span class="line">file_state=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/数据特征说明.xlsx&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-打开数据源"><a href="#4-打开数据源" class="headerlink" title="4.打开数据源"></a>4.打开数据源</h3><h4 id="4-1-打开数据特征说明表"><a href="#4-1-打开数据特征说明表" class="headerlink" title="4.1.打开数据特征说明表"></a>4.1.打开数据特征说明表</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始数据</span></span><br><span class="line">data_state_sourse=dataOpen(file_state,<span class="number">0</span>,<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 填充NaN的数据</span></span><br><span class="line">data_state_sourse=data_state_sourse.ffill()</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_state=data_state_sourse</span><br><span class="line"><span class="comment"># ---------------表特征说明字段-------------------</span></span><br><span class="line"><span class="comment"># 所有列名称</span></span><br><span class="line">data_state_col=[column <span class="keyword">for</span> column <span class="keyword">in</span> data_state]</span><br><span class="line">data_state_col_bm=data_state_col[<span class="number">0</span>]<span class="comment"># 表名</span></span><br><span class="line">data_state_col_bz=data_state_col[<span class="number">1</span>]<span class="comment"># 备注</span></span><br><span class="line">data_state_col_tz=data_state_col[<span class="number">2</span>]<span class="comment"># 特征</span></span><br><span class="line">data_state_col_sm=data_state_col[<span class="number">3</span>]<span class="comment"># 说明</span></span><br><span class="line"><span class="comment"># 数据分组</span></span><br><span class="line">data_group=data_state.groupby(by=data_state_col_bm)</span><br><span class="line">data_group_all=[x <span class="keyword">for</span> x <span class="keyword">in</span> data_group]<span class="comment"># 所有表分组</span></span><br><span class="line">data_group_users=data_group_all[<span class="number">2</span>]<span class="comment"># 用户信息表</span></span><br><span class="line">data_group_meal_order_info=data_group_all[<span class="number">1</span>]<span class="comment"># 订单表</span></span><br><span class="line">data_group_meal_order_detail=data_group_all[<span class="number">0</span>]<span class="comment"># 订单详情表</span></span><br><span class="line"><span class="comment"># ---------用户信息表------------</span></span><br><span class="line">users_tz=arrayToLower(data_group_users[<span class="number">1</span>][data_state_col_tz])<span class="comment"># 特征列数据</span></span><br><span class="line">users_sm=data_group_users[<span class="number">1</span>][data_state_col_sm].values.tolist()<span class="comment"># 说明列数据</span></span><br><span class="line"><span class="comment"># -----------订单表--------------</span></span><br><span class="line">info_tz=arrayToLower(data_group_meal_order_info[<span class="number">1</span>][data_state_col_tz])<span class="comment"># 特征列数据</span></span><br><span class="line">info_sm=data_group_meal_order_info[<span class="number">1</span>][data_state_col_sm].values.tolist()<span class="comment"># 说明列数据</span></span><br><span class="line"><span class="comment"># ----------订单详情表-------------</span></span><br><span class="line">detail_tz=arrayToLower(data_group_meal_order_detail[<span class="number">1</span>][data_state_col_tz])<span class="comment"># 特征列数据</span></span><br><span class="line">detail_sm=data_group_meal_order_detail[<span class="number">1</span>][data_state_col_sm].values.tolist()<span class="comment"># 说明列数据</span></span><br><span class="line"><span class="comment"># 封装</span></span><br><span class="line">all_tz=[users_tz,info_tz,detail_tz]<span class="comment"># 特征</span></span><br><span class="line">all_sm=[users_sm,info_sm,detail_sm]<span class="comment"># 说明</span></span><br></pre></td></tr></table></figure><h4 id="4-2-打开用户信息表（返回data-users）"><a href="#4-2-打开用户信息表（返回data-users）" class="headerlink" title="4.2.打开用户信息表（返回data_users）"></a>4.2.打开用户信息表（返回data_users）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始数据</span></span><br><span class="line">data_users_sourse=dataOpen(file_users,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 重命名指定列</span></span><br><span class="line">data_users_sourse=data_users_sourse.rename(columns = &#123;<span class="string">&quot;用户ID&quot;</span>: <span class="string">&quot;会员ID&quot;</span>&#125;)</span><br><span class="line"><span class="comment"># 删除无用列</span></span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;用户自编码&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;组织代码&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;密码&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;QQ&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;微信&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;电子邮箱&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;备注&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;创建人&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;修改人&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;修改日期&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;姓名&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;算法ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;算法名称&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;创造日期&#x27;</span>]</span><br><span class="line"><span class="comment"># 删除管理员,老师无用行</span></span><br><span class="line"><span class="comment">#data_users_sourse.drop([0,1],axis = 0,inplace = True)</span></span><br><span class="line"><span class="comment"># 通过~取反，选取不含管理员,老师的行</span></span><br><span class="line">data_users_sourse=data_users_sourse[~data_users_sourse[<span class="string">&#x27;账号&#x27;</span>].isin([<span class="string">&#x27;超级管理员&#x27;</span>,<span class="string">&#x27;老师&#x27;</span>])]</span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_users_sourse.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_users=data_users_sourse</span><br></pre></td></tr></table></figure><h4 id="4-3-打开订单表（返回data-info）"><a href="#4-3-打开订单表（返回data-info）" class="headerlink" title="4.3.打开订单表（返回data_info）"></a>4.3.打开订单表（返回data_info）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始数据</span></span><br><span class="line">data_info_sourse=dataOpen(file_meal_order_info,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 重命名指定列</span></span><br><span class="line">data_info_sourse=data_info_sourse.rename(columns = &#123;<span class="string">&quot;订单状态：0:未结算；1:结算；2：已锁单&quot;</span>: <span class="string">&quot;订单状态&quot;</span>&#125;)</span><br><span class="line">data_info_sourse=data_info_sourse.rename(columns = &#123;<span class="string">&quot;门店ID(org_info.id)&quot;</span>: <span class="string">&quot;门店ID&quot;</span>&#125;)</span><br><span class="line"><span class="comment"># 删除无用列</span></span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;订单状态&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;门店ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;桌子ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;电话&#x27;</span>]</span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_info_sourse.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_info=data_info_sourse</span><br></pre></td></tr></table></figure><h4 id="4-4-打开订单详情表（返回data-detail）"><a href="#4-4-打开订单详情表（返回data-detail）" class="headerlink" title="4.4.打开订单详情表（返回data_detail）"></a>4.4.打开订单详情表（返回data_detail）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择读第几页</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dataSheet</span>(<span class="params">sheetindex:<span class="built_in">int</span></span>):</span><br><span class="line">    <span class="comment"># 原始数据</span></span><br><span class="line">    data_detail_sourse=dataOpen(file_meal_order_detail,sheetindex,<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 清除菜品名称列的\n\r和空格</span></span><br><span class="line">    col_dishes_name=data_detail_sourse[detail_sm[<span class="number">5</span>]]</span><br><span class="line">    data_detail_sourse[detail_sm[<span class="number">5</span>]]=[col.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> col <span class="keyword">in</span> col_dishes_name]</span><br><span class="line">    <span class="comment"># 删除无用列</span></span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;订单详情ID&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;会员ID&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;菜品ID&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;是否为添加菜&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;添加价格&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;图片&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> data_detail_sourse</span><br><span class="line"><span class="comment"># 读所有页</span></span><br><span class="line">df0=dataSheet(<span class="number">0</span>)</span><br><span class="line">df1=dataSheet(<span class="number">1</span>)</span><br><span class="line">df2=dataSheet(<span class="number">2</span>)</span><br><span class="line">data_detail_sourse_all=pd.concat([df0,df1,df2],axis=<span class="number">0</span>,ignore_index=<span class="literal">True</span>)<span class="comment"># 纵向合并</span></span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_detail_sourse_all.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_detail=data_detail_sourse_all</span><br></pre></td></tr></table></figure><h4 id="4-5-所有表合并（返回data-all）"><a href="#4-5-所有表合并（返回data-all）" class="headerlink" title="4.5.所有表合并（返回data_all）"></a>4.5.所有表合并（返回data_all）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据订单ID合并订单表和订单详情表</span></span><br><span class="line">data_all1=pd.merge(data_info,data_detail,how=<span class="string">&#x27;outer&#x27;</span>,on=[<span class="string">&#x27;订单ID&#x27;</span>])</span><br><span class="line"><span class="comment"># 根据订会员ID合并用户信息表</span></span><br><span class="line">data_all=pd.merge(data_all1,data_users,how=<span class="string">&#x27;inner&#x27;</span>,on=[<span class="string">&#x27;会员ID&#x27;</span>])</span><br><span class="line"><span class="comment"># 删除无用列</span></span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;订单ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;会员ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;学号&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;桌子名称&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;账号&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;电话&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;第一次登录&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;最后一次登录&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;付费金额&#x27;</span>]</span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_all.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 打印</span></span><br><span class="line">file_data_all=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/data_all.csv&#x27;</span></span><br><span class="line">data_all.to_csv(file_data_all,index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h3 id="5-表分析"><a href="#5-表分析" class="headerlink" title="5.表分析"></a>5.表分析</h3><h4 id="5-1-用户信息表分析"><a href="#5-1-用户信息表分析" class="headerlink" title="5.1.用户信息表分析"></a>5.1.用户信息表分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_users</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033159.png"></p><h5 id="5-1-1-注册用户的籍贯分析"><a href="#5-1-1-注册用户的籍贯分析" class="headerlink" title="5.1.1.注册用户的籍贯分析"></a>5.1.1.注册用户的籍贯分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">users_jg=data_users.groupby(by=<span class="string">&#x27;籍贯&#x27;</span>).count()</span><br><span class="line">users_jg_df1=pd.DataFrame(&#123;<span class="string">&#x27;籍贯&#x27;</span>:data_users[<span class="string">&#x27;籍贯&#x27;</span>].unique()&#125;)</span><br><span class="line">users_jg_df2=pd.DataFrame(&#123;<span class="string">&#x27;数量&#x27;</span>:[<span class="number">0</span>]*<span class="built_in">len</span>(users_jg.values)&#125;)</span><br><span class="line"><span class="comment"># 合并</span></span><br><span class="line">users_jg_df=pd.concat([users_jg_df1,users_jg_df2],axis=<span class="number">1</span>,ignore_index=<span class="literal">False</span>)</span><br><span class="line">users_jg_df[<span class="string">&#x27;数量&#x27;</span>]=users_jg.values</span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">plt_x=users_jg_df[<span class="string">&#x27;籍贯&#x27;</span>].values</span><br><span class="line">plt_y=users_jg_df[<span class="string">&#x27;数量&#x27;</span>].values</span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">50</span>,<span class="number">20</span>),dpi=<span class="number">100</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">x=plt.bar(plt_x,plt_y,color=<span class="string">&#x27;red&#x27;</span>,width=<span class="number">.8</span>,label=<span class="string">&#x27;籍贯&#x27;</span>)<span class="comment"># 设置条形图</span></span><br><span class="line">plt.xticks(users_jg_df[<span class="string">&#x27;籍贯&#x27;</span>],rotation=<span class="number">90</span>,fontsize=<span class="number">30</span>)<span class="comment"># 设置X轴的数目与取值</span></span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)<span class="comment"># 设置Y轴标签的数目与取值</span></span><br><span class="line"><span class="comment"># 画图设置</span></span><br><span class="line">plt.title(<span class="string">&#x27;注册用户的籍贯分析条形图&#x27;</span>,fontsize=<span class="number">60</span>)<span class="comment"># 设置标题</span></span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置图例</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;籍贯&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置X轴标签</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;数量&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置Y轴标签</span></span><br><span class="line">plt.margins(<span class="number">0</span>,<span class="number">.2</span>)<span class="comment"># 调节左右上下留白</span></span><br><span class="line">autoBarLabel(x)<span class="comment"># 显示数值</span></span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/用户信息表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;注册用户的籍贯分析条形图.png&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop&#x2F;摘繁华数据分析文件&#x2F;用户信息表分析  文件夹创建成功</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033248.png"></p><blockquote><p>图片保存成功！请在文件夹  Desktop&#x2F;摘繁华数据分析文件&#x2F;用户信息表分析&#x2F;  下查看</p></blockquote><h4 id="5-2-订单表分析"><a href="#5-2-订单表分析" class="headerlink" title="5.2.订单表分析"></a>5.2.订单表分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_info</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033310.png"></p><h5 id="5-2-1-订单消费金额分析"><a href="#5-2-1-订单消费金额分析" class="headerlink" title="5.2.1.订单消费金额分析"></a>5.2.1.订单消费金额分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">data_info_qj=[<span class="number">0</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">500</span>,<span class="number">600</span>,<span class="number">700</span>,<span class="number">800</span>,<span class="number">900</span>,<span class="number">1000</span>]</span><br><span class="line">data_info_qj_cut=pd.cut(<span class="built_in">list</span>(data_info[<span class="string">&#x27;消费金额&#x27;</span>]),data_info_qj)</span><br><span class="line">data_info_qj_cut_data=data_info_qj_cut.describe()</span><br><span class="line">data_info_qj_percentage=(data_info_qj_cut_data[<span class="string">&#x27;freqs&#x27;</span>].values)*<span class="number">100</span></span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">10</span>),dpi=<span class="number">80</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">plt.title(<span class="string">&quot;消费金额分析饼状图&quot;</span>,loc=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">labels=[<span class="string">&#x27;100元以下&#x27;</span>,<span class="string">&#x27;100-200元&#x27;</span>,<span class="string">&#x27;200-300元&#x27;</span>,<span class="string">&#x27;300-400元&#x27;</span>,<span class="string">&#x27;400-500元&#x27;</span>,<span class="string">&#x27;500-600元&#x27;</span>,<span class="string">&#x27;600-700元&#x27;</span>,<span class="string">&#x27;700-800元&#x27;</span>,<span class="string">&#x27;800-900元&#x27;</span>,<span class="string">&#x27;900-1000元&#x27;</span>,<span class="string">&#x27;1000元以上&#x27;</span>]</span><br><span class="line">plt.pie(x=data_info_qj_percentage,labels=labels,autopct=<span class="string">&#x27;%.2f%%&#x27;</span>,pctdistance=<span class="number">0.6</span>,labeldistance=<span class="number">1.1</span>,startangle=<span class="number">180</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/订单表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;消费金额分析饼状图.png&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop&#x2F;摘繁华数据分析文件&#x2F;订单表分析  文件夹创建成功</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033456.png"></p><blockquote><p>图片保存成功！请在文件夹  Desktop&#x2F;摘繁华数据分析文件&#x2F;订单表分析&#x2F;  下查看</p></blockquote><h4 id="5-3-订单详情表分析"><a href="#5-3-订单详情表分析" class="headerlink" title="5.3.订单详情表分析"></a>5.3.订单详情表分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_detail</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033518.png"></p><h5 id="5-3-1-菜品点单次数分析"><a href="#5-3-1-菜品点单次数分析" class="headerlink" title="5.3.1.菜品点单次数分析"></a>5.3.1.菜品点单次数分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">detail_cp=data_detail.groupby(by=<span class="string">&#x27;菜品名称&#x27;</span>).count()</span><br><span class="line">cpdd_df1=pd.DataFrame(&#123;<span class="string">&#x27;菜品名称&#x27;</span>:data_detail[<span class="string">&#x27;菜品名称&#x27;</span>].unique()&#125;)</span><br><span class="line">cpdd_df2=pd.DataFrame(&#123;<span class="string">&#x27;数量&#x27;</span>:[<span class="number">0</span>]*<span class="built_in">len</span>(detail_cp.values)&#125;)</span><br><span class="line"><span class="comment"># 合并</span></span><br><span class="line">cpdd_df=pd.concat([cpdd_df1,cpdd_df2],axis=<span class="number">1</span>,ignore_index=<span class="literal">False</span>)</span><br><span class="line">cpdd_df[<span class="string">&#x27;数量&#x27;</span>]=detail_cp.values</span><br></pre></td></tr></table></figure><h6 id="5-3-1-1-菜品点单次数饼状图"><a href="#5-3-1-1-菜品点单次数饼状图" class="headerlink" title="5.3.1.1.菜品点单次数饼状图"></a>5.3.1.1.菜品点单次数饼状图</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">cpdd_df_qj=[<span class="number">1</span>,<span class="number">40</span>,<span class="number">80</span>,<span class="number">120</span>,<span class="number">160</span>,<span class="number">200</span>,<span class="number">240</span>,<span class="number">280</span>,<span class="number">350</span>]</span><br><span class="line">cpdd_df_qj_cut=pd.cut(<span class="built_in">list</span>(cpdd_df[<span class="string">&#x27;数量&#x27;</span>]),cpdd_df_qj)</span><br><span class="line">cpdd_df_qj_cut_data=cpdd_df_qj_cut.describe()</span><br><span class="line">cpdd_df_qj_percentage=(cpdd_df_qj_cut_data[<span class="string">&#x27;freqs&#x27;</span>].values)*<span class="number">100</span></span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">10</span>),dpi=<span class="number">80</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">plt.title(<span class="string">&quot;菜品点单次数饼状图&quot;</span>,loc=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">labels=[<span class="string">&#x27;40次以下&#x27;</span>,<span class="string">&#x27;40-80次&#x27;</span>,<span class="string">&#x27;80-120次&#x27;</span>,<span class="string">&#x27;120-160次&#x27;</span>,<span class="string">&#x27;160-200次&#x27;</span>,<span class="string">&#x27;200-240次&#x27;</span>,<span class="string">&#x27;240-280次&#x27;</span>,<span class="string">&#x27;280-350次&#x27;</span>]</span><br><span class="line">plt.pie(x=cpdd_df_qj_percentage,labels=labels,autopct=<span class="string">&#x27;%.2f%%&#x27;</span>,pctdistance=<span class="number">0.6</span>,labeldistance=<span class="number">1.1</span>,startangle=<span class="number">180</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/订单详情表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;菜品点单次数饼状图.png&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop&#x2F;摘繁华数据分析文件&#x2F;订单详情表分析  文件夹创建成功</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033618.png"></p><blockquote><p>图片保存成功！请在文件夹  Desktop&#x2F;摘繁华数据分析文件&#x2F;订单详情表分析&#x2F;  下查看</p></blockquote><h6 id="5-3-1-2-菜品点单次数条形图"><a href="#5-3-1-2-菜品点单次数条形图" class="headerlink" title="5.3.1.2.菜品点单次数条形图"></a>5.3.1.2.菜品点单次数条形图</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">plt_x=cpdd_df[<span class="string">&#x27;菜品名称&#x27;</span>].values</span><br><span class="line">plt_y=cpdd_df[<span class="string">&#x27;数量&#x27;</span>].values</span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">100</span>,<span class="number">52</span>),dpi=<span class="number">100</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">x=plt.bar(plt_x,plt_y,color=<span class="string">&#x27;red&#x27;</span>,width=<span class="number">.8</span>,label=<span class="string">&#x27;菜品&#x27;</span>)<span class="comment"># 设置条形图</span></span><br><span class="line">plt.xticks(cpdd_df[<span class="string">&#x27;菜品名称&#x27;</span>],rotation=<span class="number">90</span>,fontsize=<span class="number">30</span>)<span class="comment"># 设置X轴的数目与取值</span></span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)<span class="comment"># 设置Y轴标签的数目与取值</span></span><br><span class="line"><span class="comment"># 画图设置</span></span><br><span class="line">plt.title(<span class="string">&#x27;菜品点单次数条形图&#x27;</span>,fontsize=<span class="number">60</span>)<span class="comment"># 设置标题</span></span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置图例</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;菜品名称&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置X轴标签</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;数量&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置Y轴标签</span></span><br><span class="line">plt.margins(<span class="number">0</span>,<span class="number">.2</span>)<span class="comment"># 调节左右上下留白</span></span><br><span class="line">autoBarLabel(x)<span class="comment"># 显示数值</span></span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/订单详情表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;菜品点单次数条形图.png&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop&#x2F;摘繁华数据分析文件&#x2F;订单详情表分析  文件夹已存在</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033747.png"></p><blockquote><p>图片保存成功！请在文件夹  Desktop&#x2F;摘繁华数据分析文件&#x2F;订单详情表分析&#x2F;  下查看</p></blockquote><h4 id="5-4-总表综合分析"><a href="#5-4-总表综合分析" class="headerlink" title="5.4.总表综合分析"></a>5.4.总表综合分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_all</span><br></pre></td></tr></table></figure><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033816.png"></p><h5 id="5-4-1-重点客户分析"><a href="#5-4-1-重点客户分析" class="headerlink" title="5.4.1.重点客户分析"></a>5.4.1.重点客户分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">textname=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data_all[<span class="string">&#x27;名字&#x27;</span>].tolist():</span><br><span class="line">    textname+=i+<span class="string">&quot; &quot;</span></span><br><span class="line">textname</span><br><span class="line">wordcloud = WordCloud(font_path=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/font.ttf&#x27;</span>,background_color=<span class="string">&#x27;white&#x27;</span>).generate(<span class="string">&quot;&quot;</span>.join(textname))</span><br><span class="line">plt.figure(<span class="string">&quot;&quot;</span>,figsize=(<span class="number">50</span>,<span class="number">20</span>),dpi=<span class="number">200</span>)</span><br><span class="line">plt.imshow(wordcloud)</span><br><span class="line">plt.axis(<span class="string">&quot;off&quot;</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/总表综合分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;重点客户姓名词云图.png&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop&#x2F;摘繁华数据分析文件&#x2F;总表综合分析  文件夹创建成功</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413033920.png"></p><blockquote><p>图片保存成功！请在文件夹  Desktop&#x2F;摘繁华数据分析文件&#x2F;总表综合分析&#x2F;  下查看</p></blockquote><h5 id="5-4-2-菜品点单种类分析"><a href="#5-4-2-菜品点单种类分析" class="headerlink" title="5.4.2.菜品点单种类分析"></a>5.4.2.菜品点单种类分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">textname=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data_all[<span class="string">&#x27;菜品名称&#x27;</span>].tolist():</span><br><span class="line">    textname+=i+<span class="string">&quot; &quot;</span></span><br><span class="line">textname</span><br><span class="line">wordcloud = WordCloud(font_path=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/font.ttf&#x27;</span>,background_color=<span class="string">&#x27;white&#x27;</span>).generate(<span class="string">&quot;&quot;</span>.join(textname))</span><br><span class="line">plt.figure(<span class="string">&quot;&quot;</span>,figsize=(<span class="number">50</span>,<span class="number">20</span>),dpi=<span class="number">200</span>)</span><br><span class="line">plt.imshow(wordcloud)</span><br><span class="line">plt.axis(<span class="string">&quot;off&quot;</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/总表综合分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;重点菜品词云图.png&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop&#x2F;摘繁华数据分析文件&#x2F;总表综合分析  文件夹已存在</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413034003.png"></p><blockquote><p>图片保存成功！请在文件夹  Desktop&#x2F;摘繁华数据分析文件&#x2F;总表综合分析&#x2F;  下查看</p></blockquote><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Jupyter </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python实现域名注册查询</title>
      <link href="/2020/11/08/3cad0a42bee5/"/>
      <url>/2020/11/08/3cad0a42bee5/</url>
      
        <content type="html"><![CDATA[<h1 id="Python实现域名注册查询"><a href="#Python实现域名注册查询" class="headerlink" title="Python实现域名注册查询"></a>Python实现域名注册查询</h1><p>本程序由 <a href="https://blog.zhaifanhua.com/">摘繁华</a> 和好友 <a href="https://blog.bglb.work/">蓝白社区</a> 联合出品；</p><p>本程序使用第三方接口提供服务，不保证持续稳定性，若失效，请留言反馈；</p><p>本程序仅供学习交流，请勿在于商业；</p><h2 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h2><p>摘繁华私有云盘分享：<a href="https://yun.zhaifanhua.com/s/ydFW">文件下载</a></p><h2 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明"></a>文件说明</h2><p><img src="https://cdn.zhaifanhua.com/blog/img/20210615230646.png" alt="image-20210615230641656"></p><blockquote><p>source，源码文件夹；run，运行程序文件夹；readme，文档及截图。</p></blockquote><h2 id="运行说明"><a href="#运行说明" class="headerlink" title="运行说明"></a>运行说明</h2><ol><li>修改 run 文件夹下 config.json 配置文件为您需要的查询条件；</li><li>点击执行程序运行即可；</li></ol><blockquote><p>config.json配置说明：</p></blockquote><table><thead><tr><th>配置项</th><th>配置详解</th><th>配置类型</th><th>可否为空</th><th>示例</th></tr></thead><tbody><tr><td>domain_list</td><td>域名可选字典</td><td>list</td><td>是</td><td>[“a”,”b”,”c”] 或 []</td></tr><tr><td>count</td><td>域名生成数量</td><td>int</td><td>否</td><td>10（注意不能为0）</td></tr><tr><td>bits</td><td>域名长度</td><td>int</td><td>否</td><td>5（注意不能为0）</td></tr><tr><td>ext</td><td>域名后缀</td><td>list</td><td>是</td><td>[“.com”,”.cn”,”.net”] 或 []</td></tr></tbody></table><h2 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h2><p><img src="https://cdn.zhaifanhua.com/blog/img/20210615232152.png" alt="exe运行截图"></p><h2 id="源码分享"><a href="#源码分享" class="headerlink" title="源码分享"></a>源码分享</h2><p>1、main.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">--*-- conding:utf-8 --*--</span></span><br><span class="line"><span class="string">Author:zhaifanhua</span></span><br><span class="line"><span class="string">Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="string">Time:2020.11.08 上午 02:27</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> past.builtins <span class="keyword">import</span> raw_input</span><br><span class="line"><span class="keyword">from</span> domain <span class="keyword">import</span> domain_create</span><br><span class="line"><span class="keyword">import</span> xmltodict</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getxml</span>(<span class="params">domain: <span class="built_in">str</span></span>):</span><br><span class="line">    url = <span class="string">&quot;http://panda.www.net.cn/cgi-bin/check.cgi&quot;</span></span><br><span class="line">    res = requests.post(url, &#123;<span class="string">&quot;area_domain&quot;</span>: domain&#125;)</span><br><span class="line">    <span class="keyword">return</span> res.content.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xml_to_json</span>(<span class="params">xmldoc</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tmp = json.loads(json.dumps(xmltodict.parse(xmldoc, encoding=<span class="string">&#x27;&#x27;</span>)))</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        tmp = &#123;</span><br><span class="line">            <span class="string">&#x27;property&#x27;</span>:&#123;</span><br><span class="line">                <span class="string">&#x27;returncode&#x27;</span>: -<span class="number">1</span>,</span><br><span class="line">                <span class="string">&#x27;original&#x27;</span>: <span class="string">&#x27;000&#x27;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> tmp[<span class="string">&quot;property&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_out</span>(<span class="params">domain: <span class="built_in">list</span></span>):</span><br><span class="line">    path = <span class="string">&quot;./result&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">        os.makedirs(path)</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> domain:</span><br><span class="line">        res_dict = xml_to_json(getxml(key))</span><br><span class="line">        <span class="keyword">if</span> res_dict[<span class="string">&quot;returncode&quot;</span>] == <span class="string">&quot;200&quot;</span>:</span><br><span class="line">            statu = <span class="string">&quot;请求成功&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            statu = <span class="string">&quot;请求失败&quot;</span></span><br><span class="line">        <span class="keyword">if</span> res_dict[<span class="string">&quot;original&quot;</span>][:<span class="number">3</span>] == <span class="string">&quot;210&quot;</span>:</span><br><span class="line">            original = <span class="string">&quot;-------域名可以注册--------&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./result/result_true.txt&quot;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> result_true:</span><br><span class="line">                result_true.write(key + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> res_dict[<span class="string">&quot;original&quot;</span>][:<span class="number">3</span>] == <span class="string">&quot;211&quot;</span>:</span><br><span class="line">            original = <span class="string">&quot;域名已经被注册&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> res_dict[<span class="string">&quot;original&quot;</span>][:<span class="number">3</span>] == <span class="string">&quot;212&quot;</span>:</span><br><span class="line">            original = <span class="string">&quot;域名参数传输错误&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            original = <span class="string">&quot;查询超时&quot;</span></span><br><span class="line">        out_str = <span class="string">&quot;域名：&#123;0&#125;\t请求状态：&#123;1&#125;\t注册状态：&#123;2&#125;&quot;</span>.<span class="built_in">format</span>(key, statu, original)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./result/result.txt&quot;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> result:</span><br><span class="line">            result.write(out_str + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(out_str)</span><br><span class="line">    raw_input(<span class="string">&quot;查询完毕！请在result文件夹下的result_true.txt中查看可购买的域名！感谢您的使用，请按任意键退出此窗口！&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_json</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./config.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> c:</span><br><span class="line">            config_json = json.load(c)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;配置文件出错！请检查config.json文件！按任意键退出此窗口&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">8</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> config_json[<span class="string">&quot;count&quot;</span>] <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> config_json[<span class="string">&quot;bits&quot;</span>] <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        raw_input(<span class="string">&quot;配置文件出错！请检查config.json文件！ 按任意键退出此窗口&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> config_json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    config = read_json()</span><br><span class="line">    domain_list = domain_create(domain_list=<span class="built_in">list</span>(config[<span class="string">&quot;domain_list&quot;</span>]), count=<span class="built_in">int</span>(config[<span class="string">&quot;count&quot;</span>]),</span><br><span class="line">                                bits=<span class="built_in">int</span>(config[<span class="string">&quot;bits&quot;</span>]), ext=<span class="built_in">list</span>(config[<span class="string">&quot;exts&quot;</span>]))</span><br><span class="line">    parse_out(domain_list)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、domain.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">--*-- conding:utf-8 --*--</span></span><br><span class="line"><span class="string">Author:zhaifanhua</span></span><br><span class="line"><span class="string">Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="string">Time:2020.11.08 上午 02:27</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">domain_create</span>(<span class="params">domain_list, count=<span class="number">50</span>, bits=<span class="number">5</span>, ext: <span class="built_in">list</span> = [<span class="string">&quot;.com&quot;</span>, <span class="string">&quot;.cn&quot;</span>, <span class="string">&quot;.net&quot;</span>]</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            域名生成方法</span></span><br><span class="line"><span class="string">    :param domain_list:域名可选字典</span></span><br><span class="line"><span class="string">    :param count:域名生成数量</span></span><br><span class="line"><span class="string">    :param bits:域名长度</span></span><br><span class="line"><span class="string">    :param ext:域名后缀</span></span><br><span class="line"><span class="string">    :return: domain_list</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(domain_list) == <span class="number">0</span>:</span><br><span class="line">        domain_list = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>, <span class="number">123</span>)]  <span class="comment"># 默认为a到z全字典</span></span><br><span class="line">    input_str = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    input_list = []</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> <span class="built_in">range</span>(bits):</span><br><span class="line">            i = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(domain_list) - <span class="number">1</span>)</span><br><span class="line">            input_str += domain_list[i]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(ext) == <span class="number">0</span>:</span><br><span class="line">            ext = [<span class="string">&quot;.com&quot;</span>]</span><br><span class="line">        <span class="keyword">for</span> e <span class="keyword">in</span> ext:</span><br><span class="line">            input_list.append(input_str + e)</span><br><span class="line">        input_str = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    num_list = [<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;q&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(domain_create(num_list, <span class="number">500</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure><p>3、config.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;domain_list&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;count&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;bits&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;.com&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><h3 id="v1-0-0"><a href="#v1-0-0" class="headerlink" title="v1.0.0"></a>v1.0.0</h3><h4 id="感谢："><a href="#感谢：" class="headerlink" title="感谢："></a>感谢：</h4><p>1、感谢接口提供者；</p><h4 id="新增："><a href="#新增：" class="headerlink" title="新增："></a>新增：</h4><p>1、域名自定义，具体为字典自定义和后缀自定义；</p><p>2、域名状态查询；</p><h4 id="优化："><a href="#优化：" class="headerlink" title="优化："></a>优化：</h4><p>1、查询记录保存为文本，方便后续查看，使用者不再需要关注实时信息；</p><p>2、可注册域名保存为文本，方便后续查看；</p><h3 id="v1-0-1"><a href="#v1-0-1" class="headerlink" title="v1.0.1"></a>v1.0.1</h3><h4 id="感谢：-1"><a href="#感谢：-1" class="headerlink" title="感谢："></a>感谢：</h4><p>感谢粉丝 @星星 提出此 bug；</p><h4 id="修复："><a href="#修复：" class="headerlink" title="修复："></a>修复：</h4><p>1、因接口访问规则变化而产生程序异常闪退的问题，已优化为错误提示，不会闪退；</p><p>2、因接口爬虫机制变化导致一直请求失败的问题；</p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 域名 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PowerDesigner安装教程（含下载+汉化+去试用）</title>
      <link href="/2020/06/01/b1111dcefa3f/"/>
      <url>/2020/06/01/b1111dcefa3f/</url>
      
        <content type="html"><![CDATA[<h1 id="PowerDesigner安装教程（含下载-汉化-去试用）"><a href="#PowerDesigner安装教程（含下载-汉化-去试用）" class="headerlink" title="PowerDesigner安装教程（含下载+汉化+去试用）"></a>PowerDesigner安装教程（含下载+汉化+去试用）</h1><h2 id="1、什么是PowerDesigner"><a href="#1、什么是PowerDesigner" class="headerlink" title="1、什么是PowerDesigner"></a>1、什么是PowerDesigner</h2><blockquote><p>PowerDesigner是一款能进行数据库设计的软件，是一款开发人员常用的数据库建模工具。使用它可以分别从概念数据模型和物理数据模型两个层次对数据库进行设计。概念数据模型描述的是独立于数据库管理系统的实体定义和实体关系定义；物理数据模型是在概念数据模型的基础上对目标数据库管理系统的具体化。而且PowerDesigner还可以和NET、Eclipse等主流平台进行关联，从而优化整个项目的设计方案，达到大大缩短开发时间的效果。</p></blockquote><p>PowerDesigner是Sybase公司的CASE工具集，使用它可以方便地对管理信息系统进行分析设计，它几乎包括了数据库模型设计的全过程。利用PowerDesigner可以制作数据流程图、概念数据模型（ConceptualDataModel）、物理数据模型（PhysicalDataModel），还可以为数据仓库制作结构模型，也能对团队设计模型进行控制。</p><p>在数据库建模的过程中，需要运用PowerDesigner进行数据库设计，这个不但可以让人直观地理解模型，而且可以充分地利用数据库技术，优化数据库的设计。使用PowerDesigner并不感到很陌生，主要就是建立E−R图，在数据库系统概论中有涉及。实体关系E−R图中，一个实体对一个表，实体、属性与联系是进行系统设计时要考虑的三个要素，也是一个好的数据库设计的核心。</p><p>PowerDesigner创始人是一个名字叫王晓昀的中国人。1978年，王晓昀在北京大学就读了三个月，1979年去了法国留学，1986年大学毕业后在巴黎的SDP软件公司工作，当时从事软件的开发和设计，在工作中，他就一直想找到一个很好的建模设计工具，可是当时没有。他就想能不能自己开发一个这样的软件呢，于是在1988年开始开发，1989年开发出了第一个版本，叫作AMC<em>Designor，在法国销售，而且卖得很好。当时王晓昀所在公司的所有软件都用他开发的这个工具，直到现在一直都在用。后来继续开发和完善这个产品，并把市场拓展到了美国，1991年开始在美国销售，产品名字叫作S−Designor。1995年Powersoft买下了SDP公司，同年，Sybase又买下了Powersoft，于是把S−Designor和AMC</em>Designor的名字改为PowerDesigner和PowerAMC。</p><h2 id="2、准备工作，下载安装包及其他文件"><a href="#2、准备工作，下载安装包及其他文件" class="headerlink" title="2、准备工作，下载安装包及其他文件"></a>2、准备工作，下载安装包及其他文件</h2><p>需要下载以下3个文件，我直接把所有文件压缩在了一起放到了我的私有网盘（之所以不用百度网盘，那个速度大家都懂的），方便下载。如果网盘链接有失效，请评论区留言联系我。</p><p>1、PowerDesigner.exe：安装文件（Sybase PowerDesigner 16.5）</p><p>2、pdflm16.dll：破解文件</p><p>3、PowerDesigner汉化文件</p><p>下载地址：<a href="https://yun.zhaifanhua.com/s/Ldca">安装包及其他文件</a></p><h2 id="3、PowerDesigner安装图文教程："><a href="#3、PowerDesigner安装图文教程：" class="headerlink" title="3、PowerDesigner安装图文教程："></a>3、PowerDesigner安装图文教程：</h2><p>1、解压下载的压缩文件，进入解压文件夹，并双击PowerDesigner.exe；</p><p>2、欢迎来到PowerDesigner安装界面，点击 Next；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011729.png" alt="image-20210601003737372"></p><p>3、选择Trial，点击Next。不要选择其它，这一步如果选择错，后面破解是不行的。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011733.png" alt="image-20210601003817645"></p><p>4、选择Hong Kong，点击I AGREE，再点击Next；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011736.png" alt="image-20210601004005847"></p><p>5、选择一个安装目录，默认是安装在C盘。再点击Next；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011836.png" alt="image-20210601004056951"></p><p>6、这一步直接Next；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011739.png" alt="image-20210601004331739"></p><p>7、点击General和Notaion，再点击Next；</p><blockquote><p>这里很多人可能不懂，不懂你全选就不会出错了。具体什么意思，我就不在这里详细说明了。</p></blockquote><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011741.png" alt="image-20210601004454564"></p><blockquote><p>注意：<br>走到这一 步，如果你电脑上已经安装了“Eclipse”软件，请不要打勾此插件选项。否则，就会出现让你选择“Eclipse”软件的安装路径。</p></blockquote><p>8、直接点击Next；进入正在安装界面：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011847.png" alt="image-20210601004713081"></p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011743.png" alt="image-20210601004825583"></p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011856.png" alt="image-20210601004848999"></p><p>9、点击Finish，安装完成。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011745.png" alt="image-20210601004917490"></p><p>10、打开界面是这样的：</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011747.png" alt="image-20210601005258921"></p><p>11、这时，我们点击菜单 Help &#x3D;》About Power Designer 可以看到是15天的试用。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011906.png" alt="image-20210601005457885"></p><h2 id="4、PowerDesigner破解步骤："><a href="#4、PowerDesigner破解步骤：" class="headerlink" title="4、PowerDesigner破解步骤："></a>4、PowerDesigner破解步骤：</h2><p>1、先关闭软件，进入刚才的解压文件夹，将“PowerDesigner破解文件”文件夹下的“pdflm16.dll”复制；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011749.png" alt="image-20210601010147695"></p><p>2、粘贴并覆盖到你软件安装的目录中，可能需要管理员权限，同意即可；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011751.png" alt="image-20210601010355594"></p><p>3、这时我们再打开软件发现已经没有了试用期限；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011759.png" alt="image-20210601010657058"></p><h2 id="5、PowerDesigner汉化步骤："><a href="#5、PowerDesigner汉化步骤：" class="headerlink" title="5、PowerDesigner汉化步骤："></a>5、PowerDesigner汉化步骤：</h2><p>1、先关闭软件，进入刚才的解压文件夹，将PowerDesigner汉化文件”文件夹下的所有文件全选复制；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011807.png" alt="image-20210601011146191"></p><p>2、粘贴并覆盖到你软件安装的目录中，可能需要管理员权限，同意即可；</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011812.png" alt="image-20210601011327069"></p><p>3、如果点击PdShell16.exe不能正常启动，请点击pdlegacyshell16.exe启动；显示以下页面，汉化成功。</p><p><img src="https://cdn.zhaifanhua.com/blog/img/20210601011819.png" alt="image-20210601011448929"></p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐 ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 汉化 </tag>
            
            <tag> PowerDesigner </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>夜半思盈</title>
      <link href="/2019/07/19/3df4552ede54/"/>
      <url>/2019/07/19/3df4552ede54/</url>
      
        <content type="html"><![CDATA[<p>《夜半思盈》（2019.7.19）<br>粉面姣容引梦佳，独着丝袗欲掩纱。<br>芙蓉跃幻羞涩处，岂知何月一遇她？</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>无题</title>
      <link href="/2019/04/04/70922b2597eb/"/>
      <url>/2019/04/04/70922b2597eb/</url>
      
        <content type="html"><![CDATA[<p>《无题》（2019.4.4）</p><p>感友殷勤照艳肌，慨惜落圭何记时？</p><p>万痛掩被低声泣，千金难买劬劳矣！ </p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>望惜</title>
      <link href="/2019/03/30/fdad2535faa7/"/>
      <url>/2019/03/30/fdad2535faa7/</url>
      
        <content type="html"><![CDATA[<p>《望惜》（2019.3.30）</p><p>春芽既生心难枯，儒念粉妆善思芙。</p><p>悠悠日月形非孤，痴痴龙荪影常独。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爱遇暮春花亦知秋（二）</title>
      <link href="/2018/10/08/63ca7ecdbc1b/"/>
      <url>/2018/10/08/63ca7ecdbc1b/</url>
      
        <content type="html"><![CDATA[<p>爱遇暮春 花亦知秋（二）</p><p>——赠会宁一中相遇的你<br>执笔：摘繁华<br>丁酉年的深秋，在追求知识的路上，感谢时光让我们相知相遇。<br>秋，是个收获的季节，也是一个感怀的季节，她不像春一样有着万般柔情，也没有冬夏的严寒酷暑，却有着让人感到静谧释然的意境，总是被感叹光阴的文人墨客所留恋。正如唐张谔《九日》诗：“秋天林下不知春，一种佳游事也均。”秋天人人共适，而与自然山水雅居的心境，却诠释着一种独特的季节。我不是文人墨客，不能像苏东坡那样写出秋“纵一苇之所如，凌万顷之茫然”的气象万千，以诗借景抒情。又备战高考，于是只能闲步于校园，稍作放松。<br>静立在博雅楼前孔子像旁，景色自是美到了极致：阳光下金色的叶趁着湛蓝的天空于风中婆娑起舞，那种强烈反差、鲜明影调和亮丽色彩，足以惊艳世间。每一个叶片都将太阳托起，每一根叶脉都注满了能量，光在叶间闪烁，年轮在枝干上凝结。肥厚的叶片，一阵风吹过，仿佛有千万个风铃响起，清脆悦耳，炽烈的阳光穿透厚厚的叶片，投下一地细碎的光影，感觉整个校园都在光波里摇曳。<br>漫过后院长廊，花园的秋同样不吝啬：绯红的藤蔓间依稀夹杂着几片时光遗忘了的绿，与枝间凉亭红柱交相呼应，浑然一体。园中有几颗柏树，叶子已落的剩下不多，秋天迟迟没有降霜，似乎在延长这些生命最后的期限。<br>这是久久不能忘怀的那个秋。<br>田径场上没有秋，课外活动嬉戏玩闹的同学中，我看到的只有慢步的你。<br>今又逢秋非故地，过往离愁落江城。<br>武汉，又称江城，作为楚文华的重要发祥地、国家历史文化名城，原想移步于枫多山“霜叶亭”，可泛舟湖上，欣赏满山一片红叶的秋景，感受“霜叶红于二月花”的意境。怎奈现未入深秋，无长风落叶，湖也略显小气，远风平浪静，近波光粼粼，又没有鱼虾玩乐之趣，也就无观赏之情了。而会宁一中又被透红的叶儿点缀的色彩斑斓了吧。于是愈加怀念此时节母校的秋了。<br>前两天，母亲通电话那边已然落了雪，雪踏红叶的安静可能优胜于喧嚣的繁华吧？或许是因为我本就不圆滑的社会价值观：看到纯粹，朴实的季节更让我神往。<br>而秋天里的偶遇：那份我即便努力等待也不会随时间打磨隔阂的背影，那个温文尔雅，气质如霜的你，也像我跟母校一样被江河山川阻挡，远在津师，恐难以再次相视，相识。<br>禅意歌者刘珂矣《风誓》歌词中有“最短暂的相逢，最动人 、是刹那、是缘分，茫茫的人海里，又是谁静静数黄昏。秋天在等微雨，我等风也在等你”。而我，也在这没有秋的武汉，静静地敲击出这些文字，等那不会拂面的风、和不再相见的你。<br>2018.10.8 感怀</p>]]></content>
      
      
      <categories>
          
          <category> 散文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 散文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>秋殇别恋</title>
      <link href="/2018/08/22/c111f0dcd09f/"/>
      <url>/2018/08/22/c111f0dcd09f/</url>
      
        <content type="html"><![CDATA[<p>《秋殇别恋》（2018.8.22）</p><p>秋风渐劲草木黄，独留一树着红裳。</p><p>落意反顾萧瑟处，朦胧俏笑贞情郎。</p><p>十书玉言微雨凉，陌路天涯痛自尝。</p><p>终生难视佳人袂，身老不愧桃花伤。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微雨更寄叶之秋</title>
      <link href="/2018/02/18/d379452e9bdc/"/>
      <url>/2018/02/18/d379452e9bdc/</url>
      
        <content type="html"><![CDATA[<p>《微雨更寄叶之秋》（2018.2.18）</p><p>去年同窗共写意，忽生对诗点笔情。</p><p>寂夜孤灯留独影，弱姿频梦印我心。</p><p>那堪更事无相告，暗落清泪染白裙。</p><p>踏韵揉墨贞情刻，何惜终得残月魂！</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>九张机之繁华世鉴</title>
      <link href="/2017/09/15/21a5c20e03c7/"/>
      <url>/2017/09/15/21a5c20e03c7/</url>
      
        <content type="html"><![CDATA[<p>《九张机之繁华世鉴》（2017.9.15）</p><p>一张机。半城烟沙走天涯，金戈铁马赢天下。一生君王，盛世繁华。牵起了风沙？</p><p>两张机。范院兰衫忧思深，广询山水浮华真。昆仑少林，武当峨嵋。其道源于他？</p><p>三张机。幸遇红颜嫣然俏，运转清酒百盏杯。一点清香，十里芬芳。只因一席话？</p><p>四张机。花田文字鉴真心，一点朱墨玉簟青。万古长安，千滴苍泪。把相思放下？</p><p>五张机。轻卷珠帘雁双飞，直泻瀑布孤单行。白菊奇艳，辉洒满遍。竟染白红霞？</p><p>六张机。投箸忽闻泼茶香，微转巧得佳人厢。又感馨芳，流连茶香。今缘已挥洒？</p><p>七张机。芳龄尚小倾天下，青城楼兰何谓她。回眸一笑，百媚娇艳。倾动依丹砂？</p><p>八张机。语话桑麻古河畔，缘定三生今昙花。同门云集，对弹琵琶。弦传埋自夸？</p><p>九张机。人生常梦画中话，槐花飘香风流他。始于脚下，意气风发。终生不负她？</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爱遇暮春花亦知秋（一）</title>
      <link href="/2017/06/06/7d7306bd73f4/"/>
      <url>/2017/06/06/7d7306bd73f4/</url>
      
        <content type="html"><![CDATA[<p>爱遇暮春花亦知秋（一）</p><p>—— 赠生病的爱花开心果<br>执笔：摘繁华<br>生命每天在开玩笑，如曾经许诺憧憬的似水年华。<br>余生我只剩下梦了。除了窗前汲取阳光与温暖的你，谁也没有看见我眼角落下的泪。你两叶的边缘正渐渐泛黄，也许，恰需要这种溶解着感伤的咸液用痛着的爱来滋养一颗干涸寂寞的心。<br>人无逢适处，却惹粉翠怜。<br>知，亦或不知，等待命运对自身的如是真许，经风雨几番辗转，随意漂浮流散的愉悦，任时光中的浊尘与辛甘抚孕着你几乎无力支撑的叶脉，归于初识的纯贞。<br>雨，仍旧冲洗着你突刺的枝干，同岁月不断刷新着我束缚灵魂的骨肉一样，悄然无声。这是不挥手的告别，还是世间苍老的深叹？留给你和我最原始的回忆。<br>夜静栏栅凉，行人甚匆匆。<br>此刻，你正吸吮着我与你共同蕴存的峥嵘岁月，在昏明的灯光下，私自贮藏只属于你的悲与乐。但对我，你又那么傻，触破你的心把你的幸福如数给我，用以换我久违的笑。你将爱给了一个普通的平凡人，而我因为有你，才觉得这世上仅只我们两个：最不平凡。<br>许是梦久了，人自然会醒。可我并不想醒，那便喝酒吧。现在的酒不同古时，少了单纯的清冽，却倍增浓烈的浮华，这其中还夹杂着喧嚣与污浊，很容易将人吃醉。很多人就沉恋于此种酒色迷离的生活里，听从这些浊液的摆布。醉便醉吧！我不愿醒，不愿让这垂暮的模糊映入我的双眸，不愿让这寒冷的轻浮传入我的两耳。<br>昨日已经过去。<br>朦胧中慵懒的睁开一只眼，今天的阳光真好，斜照着反射出飘于空中的埃尘，异常斑斓。你倚在金属窗框上，仍然使劲地争取着自然的能量，仿佛要窥探多彩光晕的秘密一样。你深知我不能够再去消受这些淳朴的爱，可你是否知道，我也不想让你受伤的身子去承受我的痛苦。<br>曾经无话不说的玩伴，现在抬头仰望的五官。接近社会的体验让我感到大城市里对于沉稳安静的追求几近消失，也让我莫名地有了一种天涯相逢无知己的孤独的悲痛。<br>于是我变得不敢再面对你，继续用愈烈的酒消磨在我自己理想的天真里，继续梦我的梦吧，梦中有新的宇宙……<br>2017.6.6 感怀</p>]]></content>
      
      
      <categories>
          
          <category> 散文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 散文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>九世劫之笔墨纸砚书风花雪月</title>
      <link href="/2017/06/05/685841b9551e/"/>
      <url>/2017/06/05/685841b9551e/</url>
      
        <content type="html"><![CDATA[<p>《九世劫之笔墨纸砚书风花雪月》（2017.6.5）</p><p>你为笔时，潜题雅词启腕成诗千世灵戬。</p><p>你为墨时，轻斟一韵点点陈情愁思难迁。</p><p>你为纸时，黄昏倩影倚风倦尺泪落榴莲。</p><p>你为砚时，拦尘入画生死白话沉殣当年。</p><p>你为书时，寒窗苦读聚圣汇贤风度翩翩。</p><p>你为风时，尘漠万丈浩势当空毫不示娴。</p><p>你为花时，绽放娇艳终落归根栖地长眠。</p><p>你为雪时，漫天飞舞停歇竹竿却压枝甸。</p><p>你为月时，夜明晨息待缘相续中秋话甜。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三叠奏 挚尘无诲</title>
      <link href="/2017/01/06/780d4686c779/"/>
      <url>/2017/01/06/780d4686c779/</url>
      
        <content type="html"><![CDATA[<p>《三叠奏 挚尘无诲》（2017.1.6）</p><p>夜静月闲，人不寐，时过境迁化觉最。</p><p>伏顷祈荡诗已碎，却拦故人战袍翠。</p><p>着试逸茵便沉对，陌上扑泪哭满慧。</p><p>是不知寐，可知寐？</p><p>笔破寒眉换淑媚，汝既知悦吾不寐。</p><p>青瓶梅颂，书落纵，寂谷幽空剑持讼。</p><p>迫饮荼醇且自恭，然看花魂醉眼聪。</p><p>铮筝念动武墨鸿，孤背依阳仇聚瞳。</p><p>是不知颂，可知颂？</p><p>丹田气涌天欲颂，破镜重圆实可颂？</p><p>梦里痴愁，人不愁，心潮散廓病千秋。</p><p>晌池已过否他眸，斜日诉归变了楼。</p><p>银戟威扬征颤手，寇还未境玉兰勾。</p><p>是不知愁，可知愁？</p><p>峰潭必过湮没愁，筱琴穿空说无愁。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>金缕曲 冬月廿五日思英囡闲读性德词有感</title>
      <link href="/2016/12/23/be89c435309b/"/>
      <url>/2016/12/23/be89c435309b/</url>
      
        <content type="html"><![CDATA[<p>《金缕曲 冬月廿五日思英囡闲读性德词有感》〔1〕（2016.12.23）</p><p> 同窗夜鼾宿。弎〔2〕辗转，信语成谶〔3〕，昶〔4〕思倾绪。莫道人生如初见〔5〕，迨庠序〔6〕逐期满。顾圞月〔7〕，浮生若梦〔8〕。过往皎洁〔9〕不成睆〔10〕，此间累、与何人快觞？途生隶〔11〕，无休矣。</p><p> 遥幻黛沫〔12〕时已寐。心交织，川峘〔13〕相缪〔14〕，几载悱言〔15〕。独着丝袗〔16〕鬟〔17〕溢黁〔18〕，思忆终成情诺。掷流光，上元有六〔19〕。隔日闲淡甚駪〔20〕念，可曾有，琼枝〔21〕现馨昪〔22〕？高考毕，芳心依。</p><p>【注释】：</p><p>〔1〕金缕曲：词牌名；英囡:友人。拜读纳兰容若词集，有感而发，即兴之作。</p><p>〔2〕弎（sān）：同“三”，这里表概数，几次，数次。</p><p>〔3〕谶（chèn）：谶语，迷信的人指事后应验的话。</p><p>〔4〕昶（chǎng）：舒畅，畅通。</p><p>〔5〕莫道人生如初见：引用纳兰容若《木兰花令•拟古决绝词》首句“人生若只如初见，何事秋风悲画扇”。意为人生如果就像最初相识那样（这里包含了对繁华苑的感慨）。</p><p>〔6〕迨（dài）：等到；庠序：学校。这里指在学校的日子。</p><p>〔7〕圞（luán）月：圆月。</p><p>〔8〕浮生若梦：慨叹人生苦短。</p><p>〔9〕皎洁：借指月亮。</p><p>〔10〕睆（huǎn）：明亮。</p><p>〔11〕途生隶：倒装，生隶途，生活在像奴隶一样没有自由的时代。</p><p>〔12〕黛沫：英囡繁华苑圈名。</p><p>〔13〕峘（huán）：大山。</p><p>〔14〕相缪：相互交错。</p><p>〔15〕悱（fěi）言：想说却又不知道怎么说的话。</p><p>〔16〕丝袗（zhěn）：有丝带的单衣。</p><p>〔17〕鬟（huán）：女子梳妆的发束，成环状。这里泛指秀发。</p><p>〔18〕黁（nún）：香气。</p><p>〔19〕上元有六：上元，上元节，即元宵节，这里借指每月十五日月圆之夜。距高考还有六个月圆之夜，即有六个月。</p><p>〔20〕駪（shēn）：众多。</p><p>〔21〕琼枝：带冰雪的树枝。晶莹剔透的枝头。</p><p>〔22〕昪（biàn）：欢乐。 </p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>百字令之剑士离情</title>
      <link href="/2016/09/08/ee26b241395b/"/>
      <url>/2016/09/08/ee26b241395b/</url>
      
        <content type="html"><![CDATA[<p>《百字令之剑士离情》（2016.9.8）</p><p>凌</p><p>腾空</p><p>织缎扬</p><p>执念彷徨</p><p>溅血落成洑</p><p>心禅旧时潋足</p><p>寒刃流影指眉间</p><p>谷峡久荡豪声空笑</p><p>风云武林花叶已成末</p><p>剑之故事定将以血为墨</p><p>沿途黄泉情寄彼岸花</p><p>一笑倾城如若鸩吻</p><p>生死相离梅枝恋</p><p>泪淌笑忆梁祝</p><p>饮她酿酴醾</p><p>一世羁绊</p><p>蓝衫落</p><p>宗师</p><p>亡</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>御街行 边城临绝</title>
      <link href="/2016/05/27/4b27c2d63fa4/"/>
      <url>/2016/05/27/4b27c2d63fa4/</url>
      
        <content type="html"><![CDATA[<p>《御街行 边城临绝》（2016.5.27）</p><p>卯时鸡鸣晨露睡。相思碎、青城泪。雨落埋头心萍迈，初月嶦陌静寐。言语无悔，云愁昧昧，谱一曲安泰。</p><p>夜夜梦樱伊人会。懿窭费、半生累。红尘已醉楼兰坠，碑文苍颜憔悴。烛光媚媚，泪流不洄，素笺丢烟台。</p><p>【注释】：</p><p>①在早五六点钟鸡鸣之时，叶上所沾的露水还是静静的，似在沉睡。想起丈夫临行前对自己所说的话，便不由自主流下了眼泪。心中的思念就像大雨滂沱淹过了心头，而山中小路则像傍晚刚刚升起月亮的时候一样静。虽然不悔当初答应他的不会独自饮酒默默流泪思念他的誓言，但也愁上阵杀敌的他的安危，那我就弹一首他最爱的曲子愿他平平安安吧。</p><p>②在边疆的每一个夜晚都无不梦到和她相见，但是现在再美好的想象也都不可能实现，只能感叹自己生活的太累。自己的妻子因思念自己而独自饮酒发醉，国家边疆又失了一座城池，突然间想起为国捐躯的自己的父亲，如今他的墓碑上已是尘土沾满、杂草丛生了吧？军帐里的烛光闪闪跳动，眼中落下的泪水不会流回，妻子从家乡寄来的信笺中包含的思念让像我这样的千千万万的将士无心御敌，导致又丢掉了一座风烟台。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>西江月 遥谊</title>
      <link href="/2016/03/02/aa66fb4b3aa5/"/>
      <url>/2016/03/02/aa66fb4b3aa5/</url>
      
        <content type="html"><![CDATA[<p>《西江月 遥谊》（2016.3.2）</p><p>拂晓梦魇筝弦，诗词残杯苦心。</p><p>玉砚笔墨讽古今，墙外冰雪时劲。</p><p>乌云冬风难断，昔日枯枝情愁。</p><p>小楼欲坠融珠漏，笑如初识春游。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2016/02/26/9dcf3840ada1/"/>
      <url>/2016/02/26/9dcf3840ada1/</url>
      
        <content type="html"><![CDATA[<h1 id="即鹿比虞，唯入于林中，君子几，不如舍，往吝。"><a href="#即鹿比虞，唯入于林中，君子几，不如舍，往吝。" class="headerlink" title="即鹿比虞，唯入于林中，君子几，不如舍，往吝。"></a>即鹿比虞，唯入于林中，君子几，不如舍，往吝。</h1><p><img src="https://cdn.zhaifanhua.com/blog/img/20210413031401.jpeg" alt="HelloWorld"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Hello World </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>愚之自鉴，喜逢同道中人。</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>白衣无尘，亦如初见。感恩臻遇，有幸得识。<br>The white clothes are dust- free,as if we first met.Thanks for all the factors that brought us together and it’s a great honor to talk to each other as friends.</p></blockquote><p>摘繁华<br>97year，178cm，62kg，CSharp和Python程序员，祖籍陇右目前杭州工作。<br>喜欢古风汉服和文学书法，喜欢纯音乐或轻音乐多于流行，喜欢传统乐器，喜欢纪录片和2014年以前的电视剧，喜欢做饭，喜欢编程，喜欢捣鼓电子设备。<br>喜欢有一位温文尔雅的江南姑娘称我一声先生。<br>如果我们成为朋友，且你乐意分享快乐与知识，我会成为你忠实的倾听者。<br>因为比起说，我更喜欢倾听……</p><p>欲了解更多，请移步摘繁华官方主页：<a href="https://www.zhaifanhua.com/">https://www.zhaifanhua.com</a></p><blockquote><p>为什么叫摘繁华？这是我从2008年开始一直用的网名和古风圈圈名，取自我的一首词中句：繁华扑尘，有谁堪摘</p></blockquote><div class="tabs" id="喜欢与不喜欢"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="喜欢与不喜欢-1">喜欢的</button><button type="button" class="tab " data-href="喜欢与不喜欢-2">不喜欢的</button></ul><div class="tab-contents"><div class="tab-item-content active" id="喜欢与不喜欢-1"><h2 id="喜欢的"><a href="#喜欢的" class="headerlink" title="喜欢的"></a>喜欢的</h2><h3 id="大佬"><a href="#大佬" class="headerlink" title="大佬"></a>大佬</h3><blockquote><p>尤雨溪（独立开源开发者，前端框架Vue.js的作者）、Anders Hejlsberg（CSharp之父）</p></blockquote><h3 id="演员"><a href="#演员" class="headerlink" title="演员"></a>演员</h3><blockquote><p>六小龄童、靳东、赵丽颖、王宝强、李幼斌、游本昌、谢孟伟、张一山、毛晓彤、乔振宇、焦恩俊、钟汉良、黄渤、王志文、陈道明</p></blockquote><h3 id="歌手"><a href="#歌手" class="headerlink" title="歌手"></a>歌手</h3><blockquote><p>刘珂矣（禅意歌者）、李健、费玉清、李玉刚、邓紫棋、胡彦斌、萨顶顶、华晨宇、毛不易、刀郎、叶里、周深、腾格尔、许嵩、龚琳娜</p></blockquote><h3 id="书籍"><a href="#书籍" class="headerlink" title="书籍"></a>书籍</h3><blockquote><p>《花田半亩》、《周易》、《断舍离》、《狼道》、《人性的弱点》、《羊皮卷》、《墨菲定律》、《鬼谷子》、《人间失格》</p></blockquote><h3 id="小说"><a href="#小说" class="headerlink" title="小说"></a>小说</h3><blockquote><p>《遥远的救世主》、《天幕红尘》、《背叛》、《平凡的世界》</p></blockquote><h3 id="电影"><a href="#电影" class="headerlink" title="电影"></a>电影</h3><blockquote><p>情怀：<br>《一个人的武林》、《中国机长》、《凤梧桐战斗》<br>觉悟：<br>《Hello！树先生》、《天空之眼》、《海上钢琴师》、《霸王别姬》、《一出好戏》、《功夫》、《天下无贼》、《武状元苏乞儿》、《隐入尘烟》、《我们俩》<br>其他：<br>《大鱼海棠》、《让子弹飞》、《唐伯虎点秋香》、《极乐空间》</p></blockquote><h3 id="电视剧"><a href="#电视剧" class="headerlink" title="电视剧"></a>电视剧</h3><blockquote><p>四大名著：<br>《西游记》（杨洁导演86版）、《水浒传》（1998李雪健版）、《红楼梦》（王扶林导演87版）、《三国演义》（1994唐国强版）<br>情怀：<br>《亮剑》（李幼斌版）、《铁道游击队》<br>觉悟：<br>《天道》、《暖春》、《济公》、《余罪》、《阳光之下》、《楚乔传》、《神探狄仁杰》、《长安十二时辰》、《平凡的世界》<br>其他：<br>《最好的我们》、《天涯明月刀》、《宝莲灯》、《天龙八部》、《一代枭雄》</p></blockquote><h3 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h3><blockquote><p>《秦时明月》系列、《墓王之王》系列、《天行九歌》、《斗罗大陆》、《武庚纪》、《西行纪》、《魔道祖师》、《灵笼》、《吞噬星空》</p></blockquote><h3 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a>音乐</h3><blockquote><p>《十一年》、《半壶纱》、《山水之间》、《贝加尔湖畔》、《天堂》、《少年不识愁滋味》、《提诗侧畔》、《万疆》、《Faded》、《忐忑》（唱功第一的神曲）、《卷珠帘》</p></blockquote><h3 id="艺术家"><a href="#艺术家" class="headerlink" title="艺术家"></a>艺术家</h3><blockquote><p>方锦龙</p></blockquote><h3 id="纯音乐"><a href="#纯音乐" class="headerlink" title="纯音乐"></a>纯音乐</h3><blockquote><p>《淡淡的忧伤》(长安十二时辰)</p></blockquote><h3 id="纪录片"><a href="#纪录片" class="headerlink" title="纪录片"></a>纪录片</h3><blockquote><p>《航拍中国》、《舌尖上的中国》、《海昏侯》</p></blockquote><h3 id="企业家"><a href="#企业家" class="headerlink" title="企业家"></a>企业家</h3><blockquote><p>任正非、曹德旺、刘强东、雷军、罗永浩</p></blockquote><h3 id="好用的软件"><a href="#好用的软件" class="headerlink" title="好用的软件"></a>好用的软件</h3><h4 id="常用"><a href="#常用" class="headerlink" title="常用"></a>常用</h4><blockquote><p>Adobe 2020系列；<br>Typora（超级好用的MarkDown编辑器）；<br>PicGo（图床工具，结合Typora写博文轻松又舒服）；<br>PotPlayer（一款继暴风影音后的最强播放器）；<br>Snipaste（一款让截图变得更简单的工具）；<br>SpaceSniffer（磁盘分析工具）；<br>ScreenToGif（录制动图的工具，支持编辑）；<br>Geek Unіnstaller（软件卸载工具，卸载后附带删除注册表及残余文件）；<br>Everything（快速文件检索工具）、Wox（快速搜索，配合Everything有奇效）；<br>FSCapture（绿色截屏录屏工具，比国内一些收费的傻逼录屏工具好用不知道多少倍，支持长截屏，编辑等）；<br>火绒安全（我最开始用的腾讯安全管家，遇到火绒，爱不释手）；<br>IDMAN（多线程下载工具，用过都说好）；</p></blockquote><h4 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h4><blockquote><p>MariaDB（继MySQL后的开源数据库）；<br>HBulider（让代码飞起来）；<br>Xshell+Xftp（链接服务器的一把好手）；<br>Visual Studio code（前端开发变得简单方便）；<br>Visual Studio 2019（宇宙最强IDE）；<br>DnSpy（C#反编译工具）；<br>Navicat（一款很强大的数据库管理工具，收费）；<br>DBeaver（一款强大的开源免费数据库管理工具）；</p></blockquote><h3 id="一句话"><a href="#一句话" class="headerlink" title="一句话"></a>一句话</h3><blockquote><ul><li>生命是跌撞的曲折，死亡是宁静的星，归于尘土，归于雨露，这世界上不再有我，却又无处不是我。</li><li>不吃辣椒的人非要贬低吃辣椒的人，其心可诛。吃辣椒的非要天下都一起无辣不欢，既顽且鲁。</li><li>不是年少守不住旧情，而是深情一往都是人走茶凉。</li><li>以金刚石猪牙还牙，以钛合金狗眼还眼。</li><li>矛与盾本身就是共生体，就如我明知道你的卑微和肮脏，还是愿意沉沦，永远的，往复的，祈雨又盼晴。</li><li>仅一夜之间，我的心判若两人，她自人山人海中来，原来只为我一场空欢喜，你来时携风带雨，我无处可避，你走时乱了四季，我久病难医。</li></ul></blockquote></div><div class="tab-item-content" id="喜欢与不喜欢-2"><h2 id="不喜欢"><a href="#不喜欢" class="headerlink" title="不喜欢"></a>不喜欢</h2><h3 id="这些人"><a href="#这些人" class="headerlink" title="这些人"></a>这些人</h3><blockquote><p>外貌：纹身，除耳钉外的所有人体穿孔，欧美风重化妆，劣质香水，染绿红色非人类发色。<br>信仰：相信星座和卡牌，其他具有不符合自然规律的宗教。<br>其他：没多大本事爱装逼的、喜欢背后议论别人的、多说少做的、无脑追星的。</p></blockquote><p>不用问为什么，要么不喜欢，要么有代沟，要么被伤害过。</p><h3 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h3><blockquote><p>360系列（无可厚非，大毒瘤）；<br>2345系列（和360一样的流氓软件）；<br>金山毒霸（慢热型流氓）；</p></blockquote><h3 id="一句话"><a href="#一句话" class="headerlink" title="一句话"></a>一句话</h3><blockquote><p>你喜欢就好！<br>还好吧，也就……<br>你干嘛非要……</p></blockquote></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>道不同不相为谋，亦各从其志也。</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>既遇桃园，处处志之。</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>居必择乡，游必择士。</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[<div class="tabs" id="友链信息"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="友链信息-1">友链要求</button><button type="button" class="tab " data-href="友链信息-2">本站信息</button><button type="button" class="tab " data-href="友链信息-3">申请格式</button></ul><div class="tab-contents"><div class="tab-item-content active" id="友链信息-1"><p>1、使用独立域名且全站 SSL 加密，站点稳定运行，在百度、谷歌等各大搜索引擎中能够正常收录；<br>2、站点性质为非商业性的个人博客或古风文学类网站，凡内容污秽、暴力、广告、盗版、破解、网页植入脚本、极低质量内容、违背道德概不添加；<br>3、博友能长期互访，尊重创作版权，参考内容写清来源；<br>4、请移步本站关于页面，若兴趣相投，优先添加并置顶；<br>5、申请友链前请先添加本站为友链，且贵站友链没有 nofollow；<br>6、喜欢古风文学、诗词散文、汉服（非cosplay）者，无视以上直接添加；</p><blockquote><p>长期未更新或无法访问、单方面移除本站链接等，将直接移除，恕不另行通知，敬请谅解。</p></blockquote></div><div class="tab-item-content" id="友链信息-2"><p>站点名称：摘繁华个人博客<br>站点描述：白衣无尘，亦如初见。<br>站点链接：<a href="https://blog.zhaifanhua.com/">https://blog.zhaifanhua.com</a><br>图标链接：<a href="https://cdn.zhaifanhua.com/www/img/avatar/zhaifanhua.png">https://cdn.zhaifanhua.com/www/img/avatar/zhaifanhua.png</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---国内CDN链接（推荐）---</span><br><span class="line">jpg：https://cdn.zhaifanhua.com/www/img/avatar/zhaifanhua.png</span><br><span class="line">png：https://cdn.zhaifanhua.com/www/img/avatar/zhaifanhua.png</span><br><span class="line">webp：https://cdn.zhaifanhua.com/www/img/avatar/zhaifanhua.webp</span><br><span class="line">---全球通用头像（不推荐）---</span><br><span class="line">gravatar：</span><br><span class="line">https://sdn.geekzu.org/avatar/bcd6dd5e3a4bfade22b7ec6dcad556a9?s=200</span><br><span class="line">https://gravatar.loli.net/avatar/bcd6dd5e3a4bfade22b7ec6dcad556a9?s=200</span><br></pre></td></tr></table></figure><blockquote><p>请优先使用国内链接，以优化您网站的访问速度。受不可抗力因素，全球通用头像gravatar链接会经常性失效，这里不再推荐使用。</p></blockquote></div><div class="tab-item-content" id="友链信息-3"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">站点名称：您的站点名称；</span><br><span class="line">站点描述：您网站的简短描述；</span><br><span class="line">站点链接：您网站的地址；</span><br><span class="line">图标链接：您网站的图标，请优先提供国内链接。</span><br></pre></td></tr></table></figure><blockquote><p>确认您满足友链要求后，在添加本站链接后按照以上格式在留言申请友链，我会第一时间添加您的站点。</p></blockquote></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/static/css/modify.css"/>
      <url>/static/css/modify.css</url>
      
        <content type="html"><![CDATA[#toggle-sidebar {  bottom: 80px;}@media screen and (max-width: 700px) {  .aplayer {    display: none;  }}]]></content>
      
    </entry>
    
    
  
</search>
